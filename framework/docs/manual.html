<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <title>Dokumentacja projektu Coyote Framework 1.1</title>
      <meta name="generator" content="DocBook XSL Stylesheets V1.66.1">
   </head>
   <body bgcolor="white" text="black" link="" vlink="" alink="" style="font-family: Arial;">
      <div class="book" lang="pl">
         <div class="titlepage">
            <div>
               <div>
                  <h1 class="title"><a name="d0e1"></a>Dokumentacja projektu Coyote Framework 1.1
                  </h1>
               </div>
               <div>
                  <p class="copyright">Copyright &copy; 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010 Adam Boduch, Qyon</p>
               </div>
            </div>
            <hr>
         </div>
         <div class="toc">
            <p><b>Spis tre&#347;ci</b></p>
            <dl>
               <dt><span class="preface"><a href="#d0e24">Wprowadzenie</a></span></dt>
               <dt><span class="part"><a href="#d0e37">I. Dokumentacja techniczna</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="chapter"><a href="#d0e44">1. Podstawowe informacje</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e47">Wymagania sprz&#281;towe</a></span></dt>
                           <dt><span class="section"><a href="#d0e57">Licencja</a></span></dt>
                           <dt><span class="section"><a href="#d0e67">Autorzy</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e72">2. Instalacja</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e91">Pasek debug</a></span></dt>
                           <dt><span class="section"><a href="#d0e125">Konfiguracja</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e133">3. Wprowadzenie</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e138">MVC</a></span></dt>
                           <dt><span class="section"><a href="#d0e165">Pierwsze kroki</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e176">Hello World</a></span></dt>
                                 <dt><span class="section"><a href="#d0e212">URL w Coyote</a></span></dt>
                                 <dt><span class="section"><a href="#d0e273">Umieszczanie kontroler&oacute;w w podkatalogach</a></span></dt>
                                 <dt><span class="section"><a href="#d0e292">Parametry</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e374">Kontrolery</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e408">Akcje prywatne</a></span></dt>
                                 <dt><span class="section"><a href="#d0e421">Konstruktor klas</a></span></dt>
                                 <dt><span class="section"><a href="#d0e431">Informacje o module, kontrolerze i akcji</a></span></dt>
                                 <dt><span class="section"><a href="#d0e450">Metoda __start()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e458">Metoda __call()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e472">Tworzenie folderu aplikacji</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e522">Tworzenie pliku konfiguracji</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e544">Struktura katalog&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e632">Kolejno&#347;&#263; odczytywanych plik&oacute;w</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e637">4. Plik front controllera</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e661">Utworzenie pliku .htaccess</a></span></dt>
                           <dt><span class="section"><a href="#d0e680">Zawarto&#347;&#263; pliku front controllera</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e723">5. Klasa Core</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e740">Przep&#322;yw danych</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e870">Metoda getInstance()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e903">Korzystanie ze sk&#322;adowych aplikacji</a></span></dt>
                           <dt><span class="section"><a href="#d0e1004">Elementy j&#261;dra</a></span></dt>
                           <dt><span class="section"><a href="#d0e1055">Metoda dispatch()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e1117">6. Klasa Controller</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1146">Tworzenie w&#322;asnych kontroler&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e1197">Metoda getContext()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1244">Metoda getLibrary()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1274">Metoda getModel()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1285">Metoda getModule()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1290">Metoda getFolder()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1295">Metoda getController()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1306">Metoda getAction()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1320">Metoda getFolder()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1337">Metoda redirect()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1354">Metoda forward()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1387">Metoda getArguments()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1407">Metoda getArgument()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e1423">7. Biblioteki</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1490">Metoda statyczne loadera</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e1520">Przekazywanie parametr&oacute;w do konstruktora</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e1528">Konwencje w nazewnictwie</a></span></dt>
                           <dt><span class="section"><a href="#d0e1545">Dziedziczenie</a></span></dt>
                           <dt><span class="section"><a href="#d0e1567">Zast&#281;powanie bibliotek j&#261;dra</a></span></dt>
                           <dt><span class="section"><a href="#d0e1578">Metoda initialize()</a></span></dt>
                           <dt><span class="section"><a href="#d0e1583">Dziedziczenie po klasie Context</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e1588">8. Helpery</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1692">Pisanie w&#322;asnych helper&oacute;w</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e1722">9. Modele</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1781">Pobieranie danych z modelu, w widoku</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e1790">10. Konfiguracja projektu</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1803">&#321;adowanie pliku konfiguracji do projektu</a></span></dt>
                           <dt><span class="section"><a href="#d0e1837">Automatyczne &#322;adowanie pliku konfiguracji</a></span></dt>
                           <dt><span class="section"><a href="#d0e1869">Wy&#347;wietlanie zawarto&#347;ci konfiguracji</a></span></dt>
                           <dt><span class="section"><a href="#d0e1892">Ustawianie warto&#347;ci konfiguracyjnych</a></span></dt>
                           <dt><span class="section"><a href="#d0e1937">Przestrzenie nazw</a></span></dt>
                           <dt><span class="section"><a href="#d0e1971">Podzia&#322; pliku konfiguracji</a></span></dt>
                           <dt><span class="section"><a href="#d0e1989">Adaptery</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e1994">Adapter XML</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2014">Adapter PHP</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2026">Adapter INI</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2050">W&#322;asny adapter</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e2105">Cache konfiguracji</a></span></dt>
                           <dt><span class="section"><a href="#d0e2125">Automatyczne &#322;adowanie zasob&oacute;w</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e2140">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e2153">11. Loader</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2175">Metoda autoload()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2214">Metoda loadFile()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2244">Metoda setIncludePath()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2263">Metoda loadClass()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2281">Metoda loadModule()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2295">Metoda fileExists()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2309">Konstruktor klasy</a></span></dt>
                           <dt><span class="section"><a href="#d0e2341">Metoda directory()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2361">Metoda library()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2386">Metoda lang()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2391">Metoda helper()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2410">Metoda database()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2435">Metoda model()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2451">Metoda module()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2462">Metoda view()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2473">W&#322;asna klasa loadera</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e2499">12. Dispatcher</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e2561">13. Obs&#322;uga baz danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2570">&#321;&#261;czenie z baz&#261; danych</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e2596">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e2609">Zamykanie po&#322;&#261;czenia z baz&#261;</a></span></dt>
                           <dt><span class="section"><a href="#d0e2620">Wysy&#322;anie zapyta&#324; SQL</a></span></dt>
                           <dt><span class="section"><a href="#d0e2645">Dodawanie rekord&oacute;w w tabeli</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e2667">Metoda multiInsert()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e2677">Uaktualnianie rekord&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e2698">Usuwanie rekord&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e2721">Pobieranie danych</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e2758">Metoda select()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2775">Metoda from()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2789">Metoda where()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2818">Metody order() oraz limit()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2831">Instrukcje JOIN</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2851">Instrukcja GROUP BY</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2861">Instrukcja IN</a></span></dt>
                                 <dt><span class="section"><a href="#d0e2876">Metoda like()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e2886">Klasa Db_Result</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e2925">Pobieranie danych</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3068">Pobieranie pola z tablicy wynik&oacute;w</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3094">Informacja o ilo&#347;ci zwr&oacute;conych rekord&oacute;w i p&oacute;l</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e3116">Bezpiecze&#324;stwo</a></span></dt>
                           <dt><span class="section"><a href="#d0e3166">Mechanizm transakcji</a></span></dt>
                           <dt><span class="section"><a href="#d0e3185">Blokowanie tabel</a></span></dt>
                           <dt><span class="section"><a href="#d0e3198">Metoda nextId()</a></span></dt>
                           <dt><span class="section"><a href="#d0e3203">Pobranie wersji systemu bazodanowego</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e3217">14. Widoki</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3222">Tworzenie szablonu</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e3256">Konfiguracja katalogu z szablonami</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e3278">Zwracanie wyniku w akcji</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e3318">Sta&#322;e klasy View</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3360">U&#380;ycie &#322;a&#324;cucha</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e3375">Przekazywanie danych do widoku</a></span></dt>
                           <dt><span class="section"><a href="#d0e3395">U&#380;ywanie kodu PHP w szablonach</a></span></dt>
                           <dt><span class="section"><a href="#d0e3441">Klasa View</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e3466">Wy&#347;wietlanie zawarto&#347;ci widoku</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3482">Przekazywanie danych do widoku</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3563">Statyczna metoda getView()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e3587">Klasa widoku</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e3598">W&#322;asna klasa widoku</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3647">Wywo&#322;ywanie widoku</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e3697">&#321;adowanie klasy View przy pomocy loadera</a></span></dt>
                           <dt><span class="section"><a href="#d0e3715">Konfiguracja widoku</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e3720">Layouty</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3761">Okre&#347;lanie nazwy pliku konfiguracji widok&oacute;w</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3815">Budowa plik&oacute;w konfiguracji</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3858">Ustawianie tytu&#322;u dla strony</a></span></dt>
                                 <dt><span class="section"><a href="#d0e3898">Ustawianie szablon&oacute;w CSS</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4000">Przypisanie skrypt&oacute;w JavaScript</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4027">Ustawianie znacznik&oacute;w META</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4045">Ustawianie atrybut&oacute;w</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4067">U&#380;ywanie warto&#347;ci konfiguracyjnych klasy Config</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4089">Formaty konfiguracji</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e4096">15. Mechanizm routingu</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4137">Zmienne</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e4189">Wyra&#380;enia regularne</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e4207">Operator *</a></span></dt>
                           <dt><span class="section"><a href="#d0e4239">Subdomeny</a></span></dt>
                           <dt><span class="section"><a href="#d0e4258">Generowanie URL</a></span></dt>
                           <dt><span class="section"><a href="#d0e4289">Przechwytywanie wszystkich adres&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e4294">Sortowanie regu&#322;</a></span></dt>
                           <dt><span class="section"><a href="#d0e4310">Grupowanie kontroler&oacute;w w podkatalogach</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e4349">16. Klasa Input</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4394">Odbieranie formularza metod&#261; HTTP POST</a></span></dt>
                           <dt><span class="section"><a href="#d0e4422">Metoda getMethod()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4436">Metoda getHost()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4446">Metoda getPage()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4453">Metoda getScriptPath()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4467">Metoda getBaseUrl()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4474">Metoda getCurrentUrl()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4479">Metoda getPath()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4484">Metoda getIp()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4489">Metoda getUserAgent()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4497">Metoda getReferer()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4507">Metoda post()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4527">Metoda get()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4547">Metoda cookie()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4572">Metoda server()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e4592">17. Klasa GPC</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4615">Dost&#281;p do tablic globalnych</a></span></dt>
                           <dt><span class="section"><a href="#d0e4710">Referencja do tablicy</a></span></dt>
                           <dt><span class="section"><a href="#d0e4735">Filtrowanie danych</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e4777">Metoda setFilters()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4790">Metoda addFilter()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e4804">Dezaktywacja filtr&oacute;w</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e4822">Odczyt oryginalnych danych</a></span></dt>
                           <dt><span class="section"><a href="#d0e4846">Implementacja interfejsu Countable</a></span></dt>
                           <dt><span class="section"><a href="#d0e4862">Implementacja interfejsu ArrayAccess</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e4886">18. Klasa Model</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4913">Pobieranie danych z tabeli</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e4946">&#321;&#261;czenie tabel</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e4975">Metoda locate()</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e4999">Okre&#347;lanie prefiksu</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e5035">Okre&#347;lanie klucza g&#322;&oacute;wnego</a></span></dt>
                           <dt><span class="section"><a href="#d0e5052">Skr&oacute;cone operacje na bazie</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e5077">19. Triggery</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5093">W&#322;&#261;czanie trigger&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e5102">Pisanie zdarze&#324;</a></span></dt>
                           <dt><span class="section"><a href="#d0e5165">Przypisywanie zdarze&#324; w pliku konfiguracyjnym</a></span></dt>
                           <dt><span class="section"><a href="#d0e5179">Triggery dost&#281;pne w systemie</a></span></dt>
                           <dt><span class="section"><a href="#d0e5253">Przekazywanie parametr&oacute;w do zdarzenia</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e5278">Przekazywanie parametr&oacute;w przez referencj&#281;</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e5316">20. Cache</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5324">Inicjalizacja klasy</a></span></dt>
                           <dt><span class="section"><a href="#d0e5383">Metody put() oraz get()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5446">Niszczenie danych</a></span></dt>
                           <dt><span class="section"><a href="#d0e5456">Adaptery cache</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e5529">21. ACL</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e5592">22. Walidacja danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5600">Inicjalizacja klasy</a></span></dt>
                           <dt><span class="section"><a href="#d0e5621">Odczyt b&#322;&#281;d&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e5631">Walidatory</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e5658">Walidatory wykonywane samodzielnie</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5667">Klasa Validate_String</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5685">Klasa Validate_Int</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5693">Klasa Validate_Email</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5702">Klasa Validate_Url</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5713">Klasa Validate_Match</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5725">Klasa Validate_Equal</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e5740">Ustawienie komunikat&oacute;w b&#322;&#281;d&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e5759">Metoda setOptions()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5789">Metoda setValidators()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5832">Metoda reset()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5839">Statyczna metoda call()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e5855">23. Filtrowanie danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5868">Filtry</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e5922">Pisanie w&#322;asnego filtra</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5954">Filtr XSS</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5968">Filtr stripNewLines()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5976">Filtr int()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5984">Filtr string()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e5992">Filtr float()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e6000">Metoda setFilters()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6019">Statyczna metoda call()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6029">Klasa Filter_Input</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6100">Metoda setRules()</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e6120">24. Wysy&#322;anie plik&oacute;w na serwer</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6127">Tworzenie formularza HTML</a></span></dt>
                           <dt><span class="section"><a href="#d0e6144">Odczytywanie informacji o odebranym pliku</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6165">Metoda setOverwrite()</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e6175">Walidacja plik&oacute;w</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6202">Metoda setOptional()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6212">Metoda setSuffix()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6219">Metoda setMime()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6232">Metoda setFileSize()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6239">Metoda setWidth()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6246">Metoda setHeight()</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6251">U&#380;ycie metody setOptions()</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e6265">25. Klasa Output</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6275">Metoda setTitle()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6282">Metoda setMeta()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6299">Ustalanie szablon&oacute;w CSS</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d0e6351">26. Klasa FTP</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e6356">27. Klasa Email</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e6361">28. Klasa Forms</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e6366">29. Klasa Image</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e6371">30. Klasa Pagination</a></span></dt>
                     <dt><span class="chapter"><a href="#d0e6377">31. Budowa modu&#322;owa</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6387">Lokalizacja modu&#322;&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e6397">&#321;adowanie modu&#322;&oacute;w do aplikacji</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6405">Jawne za&#322;adowanie modu&#322;u</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6428">Automatyczne &#322;adowanie modu&#322;u</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e6459">Konfiguracja modu&#322;&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e6489">Zasoby modu&#322;&oacute;w</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="appendix"><a href="#d0e6560">A. Standard kodowania</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6565">Formatowanie plik&oacute;w PHP</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6568">Znaczniki PHP</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6583">Wci&#281;cia</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6590">Maksymalna d&#322;ugo&#347;&#263; linii</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6595">Kodowanie plik&oacute;w PHP</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e6600">Konwencja nazewnictwa</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6611">Nazewnictwo plik&oacute;w</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6651">Nazewnictwo klas</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6677">Nazewnictwo interfejs&oacute;w</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6688">Nazewnictwo metod</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6707">Nazewnictwo funkcji</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6718">Nazewnictwo zmiennych</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6723">Nazewnictwo sta&#322;ych</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d0e6728">Formatowanie kodu</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d0e6731">&#321;a&#324;cuchy</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6749">Klasy</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6759">Pola klasy</a></span></dt>
                                 <dt><span class="section"><a href="#d0e6776">Metody klasy</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                  </dl>
               </dd>
            </dl>
         </div>
         <div class="list-of-tables">
            <p><b>Spis tabel</b></p>
            <dl>
               <dt>3.1. <a href="#d0e304">Parametry URL</a></dt>
               <dt>3.2. <a href="#d0e578">Katalogi aplikacji korzystaj&#261;cej z Coyote</a></dt>
               <dt>8.1. <a href="#d0e1593">Helpery w Coyote</a></dt>
               <dt>19.1. <a href="#d0e5129">Opcje konfiguracji dla zdarzenia</a></dt>
               <dt>19.2. <a href="#d0e5184">Triggery dost&#281;pne w systemie</a></dt>
            </dl>
         </div>
         <div class="preface" lang="pl">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="d0e24"></a>Wprowadzenie
                     </h2>
                  </div>
               </div>
            </div>
            <p>
               Zim&#261; 2003 roku pojaw&#322; si&#281; pomys&#322; na rozpocz&#281;cie projektu, kt&oacute;rego celem mia&#322;o by&#263;
               zaprojektowanie systemu obs&#322;uguj&#261;cego serwis 4programmers.net. Tak narodzi&#322; si&#281; Coyote,
               kt&oacute;rego pierwsza wersja nosi&#322;a numer 0.9. Tak powsta&#322;y kolejne wersje 0.9.1, 0.9.2 oraz 0.9.3.
               W 2007 roku system zosta&#322; przekszta&#322;cony w projekt framework'a, kt&oacute;ry zosta&#322; napisany od nowa.
               Na jego podstawie zbudowany jest ca&#322;y serwis 4programmers.net. 
               
            </p>
            <p>
               Niniejsza dokumentacja opisuje zasady pracy nad projektem oraz jego mo&#380;liwo&#347;ci i
               zastosowania. Dokumentacja nie opisuje bibliotek czy modu&#322;&oacute;w charakterystycznych jedynie dla
               serwisu 4programmers.net. Jezeli szukasz dokumentacji po&#347;wi&#281;conej serwisowi 4programmers.net,
               wejd&#378; na stron&#281; <a href="http://4programmers.net/trac/coyote" target="_top">naszego
                  traca</a>
               
               
            </p>
            <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Ostrze&#380;enie</h3>Poni&#380;sza dokumentacja dotyczy wersji 1.1 frameworka. 
            </div>
            <p>
               
            </p>
         </div>
         <div class="part" lang="pl">
            <div class="titlepage">
               <div>
                  <div>
                     <h1 class="title"><a name="d0e37"></a>Dokumentacja techniczna
                     </h1>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Spis tre&#347;ci</b></p>
               <dl>
                  <dt><span class="chapter"><a href="#d0e44">1. Podstawowe informacje</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e47">Wymagania sprz&#281;towe</a></span></dt>
                        <dt><span class="section"><a href="#d0e57">Licencja</a></span></dt>
                        <dt><span class="section"><a href="#d0e67">Autorzy</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e72">2. Instalacja</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e91">Pasek debug</a></span></dt>
                        <dt><span class="section"><a href="#d0e125">Konfiguracja</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e133">3. Wprowadzenie</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e138">MVC</a></span></dt>
                        <dt><span class="section"><a href="#d0e165">Pierwsze kroki</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e176">Hello World</a></span></dt>
                              <dt><span class="section"><a href="#d0e212">URL w Coyote</a></span></dt>
                              <dt><span class="section"><a href="#d0e273">Umieszczanie kontroler&oacute;w w podkatalogach</a></span></dt>
                              <dt><span class="section"><a href="#d0e292">Parametry</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e374">Kontrolery</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e408">Akcje prywatne</a></span></dt>
                              <dt><span class="section"><a href="#d0e421">Konstruktor klas</a></span></dt>
                              <dt><span class="section"><a href="#d0e431">Informacje o module, kontrolerze i akcji</a></span></dt>
                              <dt><span class="section"><a href="#d0e450">Metoda __start()</a></span></dt>
                              <dt><span class="section"><a href="#d0e458">Metoda __call()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e472">Tworzenie folderu aplikacji</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e522">Tworzenie pliku konfiguracji</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e544">Struktura katalog&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e632">Kolejno&#347;&#263; odczytywanych plik&oacute;w</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e637">4. Plik front controllera</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e661">Utworzenie pliku .htaccess</a></span></dt>
                        <dt><span class="section"><a href="#d0e680">Zawarto&#347;&#263; pliku front controllera</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e723">5. Klasa Core</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e740">Przep&#322;yw danych</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e870">Metoda getInstance()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e903">Korzystanie ze sk&#322;adowych aplikacji</a></span></dt>
                        <dt><span class="section"><a href="#d0e1004">Elementy j&#261;dra</a></span></dt>
                        <dt><span class="section"><a href="#d0e1055">Metoda dispatch()</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e1117">6. Klasa Controller</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e1146">Tworzenie w&#322;asnych kontroler&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e1197">Metoda getContext()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1244">Metoda getLibrary()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1274">Metoda getModel()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1285">Metoda getModule()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1290">Metoda getFolder()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1295">Metoda getController()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1306">Metoda getAction()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1320">Metoda getFolder()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1337">Metoda redirect()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1354">Metoda forward()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1387">Metoda getArguments()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1407">Metoda getArgument()</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e1423">7. Biblioteki</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e1490">Metoda statyczne loadera</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e1520">Przekazywanie parametr&oacute;w do konstruktora</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e1528">Konwencje w nazewnictwie</a></span></dt>
                        <dt><span class="section"><a href="#d0e1545">Dziedziczenie</a></span></dt>
                        <dt><span class="section"><a href="#d0e1567">Zast&#281;powanie bibliotek j&#261;dra</a></span></dt>
                        <dt><span class="section"><a href="#d0e1578">Metoda initialize()</a></span></dt>
                        <dt><span class="section"><a href="#d0e1583">Dziedziczenie po klasie Context</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e1588">8. Helpery</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e1692">Pisanie w&#322;asnych helper&oacute;w</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e1722">9. Modele</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e1781">Pobieranie danych z modelu, w widoku</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e1790">10. Konfiguracja projektu</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e1803">&#321;adowanie pliku konfiguracji do projektu</a></span></dt>
                        <dt><span class="section"><a href="#d0e1837">Automatyczne &#322;adowanie pliku konfiguracji</a></span></dt>
                        <dt><span class="section"><a href="#d0e1869">Wy&#347;wietlanie zawarto&#347;ci konfiguracji</a></span></dt>
                        <dt><span class="section"><a href="#d0e1892">Ustawianie warto&#347;ci konfiguracyjnych</a></span></dt>
                        <dt><span class="section"><a href="#d0e1937">Przestrzenie nazw</a></span></dt>
                        <dt><span class="section"><a href="#d0e1971">Podzia&#322; pliku konfiguracji</a></span></dt>
                        <dt><span class="section"><a href="#d0e1989">Adaptery</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e1994">Adapter XML</a></span></dt>
                              <dt><span class="section"><a href="#d0e2014">Adapter PHP</a></span></dt>
                              <dt><span class="section"><a href="#d0e2026">Adapter INI</a></span></dt>
                              <dt><span class="section"><a href="#d0e2050">W&#322;asny adapter</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e2105">Cache konfiguracji</a></span></dt>
                        <dt><span class="section"><a href="#d0e2125">Automatyczne &#322;adowanie zasob&oacute;w</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e2140">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e2153">11. Loader</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e2175">Metoda autoload()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2214">Metoda loadFile()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2244">Metoda setIncludePath()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2263">Metoda loadClass()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2281">Metoda loadModule()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2295">Metoda fileExists()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2309">Konstruktor klasy</a></span></dt>
                        <dt><span class="section"><a href="#d0e2341">Metoda directory()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2361">Metoda library()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2386">Metoda lang()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2391">Metoda helper()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2410">Metoda database()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2435">Metoda model()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2451">Metoda module()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2462">Metoda view()</a></span></dt>
                        <dt><span class="section"><a href="#d0e2473">W&#322;asna klasa loadera</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e2499">12. Dispatcher</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e2561">13. Obs&#322;uga baz danych</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e2570">&#321;&#261;czenie z baz&#261; danych</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e2596">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e2609">Zamykanie po&#322;&#261;czenia z baz&#261;</a></span></dt>
                        <dt><span class="section"><a href="#d0e2620">Wysy&#322;anie zapyta&#324; SQL</a></span></dt>
                        <dt><span class="section"><a href="#d0e2645">Dodawanie rekord&oacute;w w tabeli</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e2667">Metoda multiInsert()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e2677">Uaktualnianie rekord&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e2698">Usuwanie rekord&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e2721">Pobieranie danych</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e2758">Metoda select()</a></span></dt>
                              <dt><span class="section"><a href="#d0e2775">Metoda from()</a></span></dt>
                              <dt><span class="section"><a href="#d0e2789">Metoda where()</a></span></dt>
                              <dt><span class="section"><a href="#d0e2818">Metody order() oraz limit()</a></span></dt>
                              <dt><span class="section"><a href="#d0e2831">Instrukcje JOIN</a></span></dt>
                              <dt><span class="section"><a href="#d0e2851">Instrukcja GROUP BY</a></span></dt>
                              <dt><span class="section"><a href="#d0e2861">Instrukcja IN</a></span></dt>
                              <dt><span class="section"><a href="#d0e2876">Metoda like()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e2886">Klasa Db_Result</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e2925">Pobieranie danych</a></span></dt>
                              <dt><span class="section"><a href="#d0e3068">Pobieranie pola z tablicy wynik&oacute;w</a></span></dt>
                              <dt><span class="section"><a href="#d0e3094">Informacja o ilo&#347;ci zwr&oacute;conych rekord&oacute;w i p&oacute;l</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e3116">Bezpiecze&#324;stwo</a></span></dt>
                        <dt><span class="section"><a href="#d0e3166">Mechanizm transakcji</a></span></dt>
                        <dt><span class="section"><a href="#d0e3185">Blokowanie tabel</a></span></dt>
                        <dt><span class="section"><a href="#d0e3198">Metoda nextId()</a></span></dt>
                        <dt><span class="section"><a href="#d0e3203">Pobranie wersji systemu bazodanowego</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e3217">14. Widoki</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e3222">Tworzenie szablonu</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e3256">Konfiguracja katalogu z szablonami</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e3278">Zwracanie wyniku w akcji</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e3318">Sta&#322;e klasy View</a></span></dt>
                              <dt><span class="section"><a href="#d0e3360">U&#380;ycie &#322;a&#324;cucha</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e3375">Przekazywanie danych do widoku</a></span></dt>
                        <dt><span class="section"><a href="#d0e3395">U&#380;ywanie kodu PHP w szablonach</a></span></dt>
                        <dt><span class="section"><a href="#d0e3441">Klasa View</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e3466">Wy&#347;wietlanie zawarto&#347;ci widoku</a></span></dt>
                              <dt><span class="section"><a href="#d0e3482">Przekazywanie danych do widoku</a></span></dt>
                              <dt><span class="section"><a href="#d0e3563">Statyczna metoda getView()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e3587">Klasa widoku</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e3598">W&#322;asna klasa widoku</a></span></dt>
                              <dt><span class="section"><a href="#d0e3647">Wywo&#322;ywanie widoku</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e3697">&#321;adowanie klasy View przy pomocy loadera</a></span></dt>
                        <dt><span class="section"><a href="#d0e3715">Konfiguracja widoku</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e3720">Layouty</a></span></dt>
                              <dt><span class="section"><a href="#d0e3761">Okre&#347;lanie nazwy pliku konfiguracji widok&oacute;w</a></span></dt>
                              <dt><span class="section"><a href="#d0e3815">Budowa plik&oacute;w konfiguracji</a></span></dt>
                              <dt><span class="section"><a href="#d0e3858">Ustawianie tytu&#322;u dla strony</a></span></dt>
                              <dt><span class="section"><a href="#d0e3898">Ustawianie szablon&oacute;w CSS</a></span></dt>
                              <dt><span class="section"><a href="#d0e4000">Przypisanie skrypt&oacute;w JavaScript</a></span></dt>
                              <dt><span class="section"><a href="#d0e4027">Ustawianie znacznik&oacute;w META</a></span></dt>
                              <dt><span class="section"><a href="#d0e4045">Ustawianie atrybut&oacute;w</a></span></dt>
                              <dt><span class="section"><a href="#d0e4067">U&#380;ywanie warto&#347;ci konfiguracyjnych klasy Config</a></span></dt>
                              <dt><span class="section"><a href="#d0e4089">Formaty konfiguracji</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e4096">15. Mechanizm routingu</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e4137">Zmienne</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e4189">Wyra&#380;enia regularne</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e4207">Operator *</a></span></dt>
                        <dt><span class="section"><a href="#d0e4239">Subdomeny</a></span></dt>
                        <dt><span class="section"><a href="#d0e4258">Generowanie URL</a></span></dt>
                        <dt><span class="section"><a href="#d0e4289">Przechwytywanie wszystkich adres&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e4294">Sortowanie regu&#322;</a></span></dt>
                        <dt><span class="section"><a href="#d0e4310">Grupowanie kontroler&oacute;w w podkatalogach</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e4349">16. Klasa Input</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e4394">Odbieranie formularza metod&#261; HTTP POST</a></span></dt>
                        <dt><span class="section"><a href="#d0e4422">Metoda getMethod()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4436">Metoda getHost()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4446">Metoda getPage()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4453">Metoda getScriptPath()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4467">Metoda getBaseUrl()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4474">Metoda getCurrentUrl()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4479">Metoda getPath()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4484">Metoda getIp()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4489">Metoda getUserAgent()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4497">Metoda getReferer()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4507">Metoda post()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4527">Metoda get()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4547">Metoda cookie()</a></span></dt>
                        <dt><span class="section"><a href="#d0e4572">Metoda server()</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e4592">17. Klasa GPC</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e4615">Dost&#281;p do tablic globalnych</a></span></dt>
                        <dt><span class="section"><a href="#d0e4710">Referencja do tablicy</a></span></dt>
                        <dt><span class="section"><a href="#d0e4735">Filtrowanie danych</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e4777">Metoda setFilters()</a></span></dt>
                              <dt><span class="section"><a href="#d0e4790">Metoda addFilter()</a></span></dt>
                              <dt><span class="section"><a href="#d0e4804">Dezaktywacja filtr&oacute;w</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e4822">Odczyt oryginalnych danych</a></span></dt>
                        <dt><span class="section"><a href="#d0e4846">Implementacja interfejsu Countable</a></span></dt>
                        <dt><span class="section"><a href="#d0e4862">Implementacja interfejsu ArrayAccess</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e4886">18. Klasa Model</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e4913">Pobieranie danych z tabeli</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e4946">&#321;&#261;czenie tabel</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e4975">Metoda locate()</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e4999">Okre&#347;lanie prefiksu</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e5035">Okre&#347;lanie klucza g&#322;&oacute;wnego</a></span></dt>
                        <dt><span class="section"><a href="#d0e5052">Skr&oacute;cone operacje na bazie</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e5077">19. Triggery</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e5093">W&#322;&#261;czanie trigger&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e5102">Pisanie zdarze&#324;</a></span></dt>
                        <dt><span class="section"><a href="#d0e5165">Przypisywanie zdarze&#324; w pliku konfiguracyjnym</a></span></dt>
                        <dt><span class="section"><a href="#d0e5179">Triggery dost&#281;pne w systemie</a></span></dt>
                        <dt><span class="section"><a href="#d0e5253">Przekazywanie parametr&oacute;w do zdarzenia</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e5278">Przekazywanie parametr&oacute;w przez referencj&#281;</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e5316">20. Cache</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e5324">Inicjalizacja klasy</a></span></dt>
                        <dt><span class="section"><a href="#d0e5383">Metody put() oraz get()</a></span></dt>
                        <dt><span class="section"><a href="#d0e5446">Niszczenie danych</a></span></dt>
                        <dt><span class="section"><a href="#d0e5456">Adaptery cache</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e5529">21. ACL</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e5592">22. Walidacja danych</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e5600">Inicjalizacja klasy</a></span></dt>
                        <dt><span class="section"><a href="#d0e5621">Odczyt b&#322;&#281;d&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e5631">Walidatory</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e5658">Walidatory wykonywane samodzielnie</a></span></dt>
                              <dt><span class="section"><a href="#d0e5667">Klasa Validate_String</a></span></dt>
                              <dt><span class="section"><a href="#d0e5685">Klasa Validate_Int</a></span></dt>
                              <dt><span class="section"><a href="#d0e5693">Klasa Validate_Email</a></span></dt>
                              <dt><span class="section"><a href="#d0e5702">Klasa Validate_Url</a></span></dt>
                              <dt><span class="section"><a href="#d0e5713">Klasa Validate_Match</a></span></dt>
                              <dt><span class="section"><a href="#d0e5725">Klasa Validate_Equal</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e5740">Ustawienie komunikat&oacute;w b&#322;&#281;d&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e5759">Metoda setOptions()</a></span></dt>
                        <dt><span class="section"><a href="#d0e5789">Metoda setValidators()</a></span></dt>
                        <dt><span class="section"><a href="#d0e5832">Metoda reset()</a></span></dt>
                        <dt><span class="section"><a href="#d0e5839">Statyczna metoda call()</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e5855">23. Filtrowanie danych</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e5868">Filtry</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e5922">Pisanie w&#322;asnego filtra</a></span></dt>
                              <dt><span class="section"><a href="#d0e5954">Filtr XSS</a></span></dt>
                              <dt><span class="section"><a href="#d0e5968">Filtr stripNewLines()</a></span></dt>
                              <dt><span class="section"><a href="#d0e5976">Filtr int()</a></span></dt>
                              <dt><span class="section"><a href="#d0e5984">Filtr string()</a></span></dt>
                              <dt><span class="section"><a href="#d0e5992">Filtr float()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e6000">Metoda setFilters()</a></span></dt>
                        <dt><span class="section"><a href="#d0e6019">Statyczna metoda call()</a></span></dt>
                        <dt><span class="section"><a href="#d0e6029">Klasa Filter_Input</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6100">Metoda setRules()</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e6120">24. Wysy&#322;anie plik&oacute;w na serwer</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e6127">Tworzenie formularza HTML</a></span></dt>
                        <dt><span class="section"><a href="#d0e6144">Odczytywanie informacji o odebranym pliku</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6165">Metoda setOverwrite()</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e6175">Walidacja plik&oacute;w</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6202">Metoda setOptional()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6212">Metoda setSuffix()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6219">Metoda setMime()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6232">Metoda setFileSize()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6239">Metoda setWidth()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6246">Metoda setHeight()</a></span></dt>
                              <dt><span class="section"><a href="#d0e6251">U&#380;ycie metody setOptions()</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e6265">25. Klasa Output</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e6275">Metoda setTitle()</a></span></dt>
                        <dt><span class="section"><a href="#d0e6282">Metoda setMeta()</a></span></dt>
                        <dt><span class="section"><a href="#d0e6299">Ustalanie szablon&oacute;w CSS</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d0e6351">26. Klasa FTP</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e6356">27. Klasa Email</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e6361">28. Klasa Forms</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e6366">29. Klasa Image</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e6371">30. Klasa Pagination</a></span></dt>
                  <dt><span class="chapter"><a href="#d0e6377">31. Budowa modu&#322;owa</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e6387">Lokalizacja modu&#322;&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e6397">&#321;adowanie modu&#322;&oacute;w do aplikacji</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6405">Jawne za&#322;adowanie modu&#322;u</a></span></dt>
                              <dt><span class="section"><a href="#d0e6428">Automatyczne &#322;adowanie modu&#322;u</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e6459">Konfiguracja modu&#322;&oacute;w</a></span></dt>
                        <dt><span class="section"><a href="#d0e6489">Zasoby modu&#322;&oacute;w</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="appendix"><a href="#d0e6560">A. Standard kodowania</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d0e6565">Formatowanie plik&oacute;w PHP</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6568">Znaczniki PHP</a></span></dt>
                              <dt><span class="section"><a href="#d0e6583">Wci&#281;cia</a></span></dt>
                              <dt><span class="section"><a href="#d0e6590">Maksymalna d&#322;ugo&#347;&#263; linii</a></span></dt>
                              <dt><span class="section"><a href="#d0e6595">Kodowanie plik&oacute;w PHP</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e6600">Konwencja nazewnictwa</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6611">Nazewnictwo plik&oacute;w</a></span></dt>
                              <dt><span class="section"><a href="#d0e6651">Nazewnictwo klas</a></span></dt>
                              <dt><span class="section"><a href="#d0e6677">Nazewnictwo interfejs&oacute;w</a></span></dt>
                              <dt><span class="section"><a href="#d0e6688">Nazewnictwo metod</a></span></dt>
                              <dt><span class="section"><a href="#d0e6707">Nazewnictwo funkcji</a></span></dt>
                              <dt><span class="section"><a href="#d0e6718">Nazewnictwo zmiennych</a></span></dt>
                              <dt><span class="section"><a href="#d0e6723">Nazewnictwo sta&#322;ych</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d0e6728">Formatowanie kodu</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d0e6731">&#321;a&#324;cuchy</a></span></dt>
                              <dt><span class="section"><a href="#d0e6749">Klasy</a></span></dt>
                              <dt><span class="section"><a href="#d0e6759">Pola klasy</a></span></dt>
                              <dt><span class="section"><a href="#d0e6776">Metody klasy</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
               </dl>
            </div><span class="emphasis"><em> 
                  Framework (rama projektowa, szkielet) to w programowaniu struktura wspomagaj&#261;ca
                  tworzenie, rozw&oacute;j i testowanie powstaj&#261;cej aplikacji. Z regu&#322;y na framework sk&#322;adaj&#261; si&#281;
                  programy wspomagaj&#261;ce, biblioteki kodu &#378;r&oacute;d&#322;owego i inne podobne narz&#281;dzia. To szkielet
                  dzia&#322;ania aplikacji, kt&oacute;ry zapewnia podstawowe mechanizmy i mo&#380;e by&#263; wype&#322;niany w&#322;a&#347;ciw&#261;
                  tre&#347;ci&#261; programu. Np. w programowaniu gier na szkielet mo&#380;e sk&#322;ada&#263; si&#281; utworzenie pustego
                  okna, kod inicjalizacji i finalizacji biblioteki graficznej (jak DirectX czy OpenGL), a tak&#380;e
                  dodatkowe modu&#322;y wspomagaj&#261;ce, jak wczytywanie tekstur z r&oacute;&#380;nych format&oacute;w plik&oacute;w, funkcje
                  rysuj&#261;ce podstawowe figury geometryczne, tekst itp. 
                  </em></span><p>
               &#378;r&oacute;d&#322;o: Wikipedia.Coyote Framework powsta&#322; specjalnie z my&#347;l&#261; o serwisie
               4programmers.net, ale oczywi&#347;cie mo&#380;e by&#263; r&oacute;wnie&#380; z powodzeniem wykorzystywany w innych
               aplikacjach PHP.
               
            </p>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e44"></a>Rozdzia&#322; 1. Podstawowe informacje
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e47">Wymagania sprz&#281;towe</a></span></dt>
                     <dt><span class="section"><a href="#d0e57">Licencja</a></span></dt>
                     <dt><span class="section"><a href="#d0e67">Autorzy</a></span></dt>
                  </dl>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e47"></a>Wymagania sprz&#281;towe
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Jak ka&#380;da aplikacja PHP, Coyote do dzia&#322;ania potrzebuje interpretera PHP, w wersji 5.1
                     (zalecana wersja 5.2). Przydatny mo&#380;e okaza&#263; si&#281; r&oacute;wnie&#380; serwer ;) Polecamy popularny
                     serwer Apache 2.0.X (aczkolwiek projekt testowany by&#322; r&oacute;wnie&#380; w wersji 2.2.X). 
                     Je&#380;eli Twoja aplikacja w domy&#347;le ma korzysta&#263; z bazy danych, musisz
                     zainstalowa&#263; oraz skonfigurowa&#263; odpowiedni system bazodanowy.
                     
                  </p>
                  <p>
                     
                  </p>
                  <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">WA&#379;NE</h3>Do wersji 1.1, Coyote Framework obs&#322;uguje jedynie baz&#281; MySQL oraz PostgreSQL.
                     Je&#380;eli chcesz obs&#322;ugiwa&#263; w swojej aplikacji inn&#261; baz&#281;, musisz napisa&#263; odpowiedni&#261; klas&#281;
                     obs&#322;ugi danych (adapter). Wi&#281;cej szczego&#322;&oacute;w znajdziesz w dalszej cz&#281;&#347;ci
                     podr&#281;cznika.
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e57"></a>Licencja
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Projekt oparty jest o licencj&#281; BSD-new, kt&oacute;rej tre&#347;&#263; znajduje si&#281; poni&#380;ej.
                     
                  </p>
                  <p>
                     
                  </p><pre class="programlisting">
Copyright (c) 2003-2010, Adam Boduch
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

* Neither the name of Adam Boduch. nor the names of its
contributors may be used to endorse or promote products derived from this
software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.            
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e67"></a>Autorzy
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Autorem wersji 1.x jest Adam Boduch. Jednak&#380;e wcze&#347;niej wiele os&oacute;b mia&#322;o wk&#322;ad w
                     powstawanie projektu.
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e72"></a>Rozdzia&#322; 2. Instalacja
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e91">Pasek debug</a></span></dt>
                     <dt><span class="section"><a href="#d0e125">Konfiguracja</a></span></dt>
                  </dl>
               </div>
               <p>
                  Od samego pocz&#261;tku autorom projektu przy&#347;wieca&#322;a my&#347;l, aby framework nie wymaga&#322;
                  instalacji oraz konfiguracji. Wystarczy &#347;ci&#261;gn&#261;&#263; spakowane pliki projektu ze strony: <a href="http://boduch.net/coyote" target="_top">http://boduch.net/coyote/</a> i rozpakowa&#263; w
                  odopwiednim katalogu serwera. Nast&#281;pnie wystarczy wej&#347;&#263; w odpowiedni katalog projektu - np.:
                  <span><b class="command">http://127.0.0.1/coyote</b></span>
                  
               </p>
               <p>
                  Je&#380;eli wszystko posz&#322;o dobrze, Twoim oczom uka&#380;e si&#281; powitalna strona projektu. Od tej
                  chwili mo&#380;esz zacz&#261;&#263; programowa&#263; przy u&#380;yciu Coyote'a. 
                  
                  
               </p>
               <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Uwaga!</h3>
                  Strona powitalna nie stanowi integralnej cz&#281;&#347;ci frameworka. 
                  S&#322;u&#380;y ona jedynie do prezentacji g&#322;&oacute;wnych w&#322;a&#347;ciwo&#347;ci projektu. 
                  Z powodzeniem mo&#380;esz usun&#261;&#263; niepotrzebne pliki kikaj&#261;c w przycisk 
                  <span class="italic">Usu&#324; teraz</span> na stronie powitalnej. 
                  
               </div>
               <p>
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e91"></a>Pasek debug
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Domy&#347;lnie, w prawym, g&oacute;rnym rogu strony znajduje si&#281;
                     pasek <span class="italic">debug</span>. Jest on generowany automatycznie PO
                     wygenerowaniu w&#322;a&#347;ciwej strony. Zawiera kilka informacji o samym projekcie jak i o
                     zmiennych/sta&#322;ych wykorzystywanych w systemie. S&#261; to informacje przydatne na etapie
                     projektowania. Aby ujrze&#263; szczeg&oacute;ly wystarczy klikn&#261;c na dan&#261; pozycj&#281;. Rozwinie si&#281;
                     w&oacute;wczas okno z dodatkowymi informacjami.
                     
                  </p>
                  <p>
                     Pierwsza ikona umo&#380;liwia wy&#347;wietlenie informacji o samej wersji frameworka, wersji 
                     PHP oraz systemie operacyjnym.
                     
                  </p>
                  <p>
                     Druga zak&#322;adka (ikona) ilo&#347;&#263; pami&#281;ci zu&#380;ytej na wygenerowanie
                     strony.
                     
                  </p>
                  <p>
                     Trzecia zak&#322;adka prezentuje zawarto&#347;&#263; dziennika (logi), kt&oacute;ry zosta&#322;
                     wygenerowany w trakcie. Tutaj mo&#380;esz znale&#378;&#263; informacje z ostrze&#380;eniami, wskz&oacute;wkami (r&oacute;wnie&#380;
                     ostrze&#380;eniami samego interpretera PHP).
                     
                  </p>
                  <p>
                     Czwarta zak&#322;adka prezentuje zawarto&#347;&#263;
                     zmiennych globalnych. Znajduje si&#281; tutaj r&oacute;wnie&#380; konfiguracja projektu oraz lista sta&#322;ych
                     zadeklarowanych w projekcie. 
                     
                  </p>
                  <p>
                     Ostatnia zak&#322;adka prezentuje czasy wygenerowania poszczeg&oacute;lnych element&oacute;w strony. 
                     
                  </p>
                  <p>
                     Pasek mo&#380;esz zamkn&#261;&#263; klikaj&#261;c na czerwon&#261; ikonk&#281; na pasku. 
                     
                  </p>
                  <p>
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Domy&#347;lnie aplikacja dzia&#322;a w trybie <span class="bold"><b>DEBUG</b></span>. Oznacza
                     to, &#380;e czas generowania strony jest d&#322;u&#380;szy. Program podczas generowania gromadzi
                     informacje na temat projektu (logi, czas generowania poszczeg&oacute;lnych podzespo&#322;&oacute;w), a na
                     ko&#324;cu prezentuje wszystko w formie paska debug. W prosty spos&oacute;b mo&#380;esz wy&#322;aczy&#263;
                     generowanie samego paska jak i dzia&#322;anie w trybie deweloperskim (DEBUG). Wystarczy, &#380;e
                     odnajdziesz w pliku index.php (g&#322;&oacute;wnym pliku projektu) sta&#322;&#261; <tt class="constant">DEBUG</tt>,
                     a nast&#281;pnie zmienisz jej warto&#347;&#263; na false. 
                     
                  </div>
                  <p>
                     
                     
                     
                  </p>
                  <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Ostrze&#380;enie</h3>
                     Pami&#281;taj o tym, aby wy&#322;&#261;czy&#263; tryb DEBUG w finalnej wersji produktu umieszczonej
                     na serwerze. Ze wzgled&oacute;w bezpiecze&#324;stwa.
                     
                  </div>
                  <p>
                     
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e125"></a>Konfiguracja
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Framework zosta&#322; napisany tak, &#380;e do prawid&#322;owego dzia&#322;anie nie potrzebuje wcale pliku
                     konfiguracyjnego. Co prawda, domy&#347;lnie, po &#347;ci&#261;gni&#281;ciu i rozpakowaniu projektu, w g&#322;&oacute;wnym
                     katalogu znajdziesz plik <span class="italic">config.xml</span>, lecz nie jest on
                     wcale potrzebny! Mo&#380;esz wi&#281;c go wykasowa&#263;, a projekt nadal b&#281;dzie dzia&#322;a&#322; tak samo. Wi&#281;cej
                     na temat konfiguracji, znajdziesz w dalszej cz&#281;&#347;ci tego podr&#281;cznika. 
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e133"></a>Rozdzia&#322; 3. Wprowadzenie
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e138">MVC</a></span></dt>
                     <dt><span class="section"><a href="#d0e165">Pierwsze kroki</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e176">Hello World</a></span></dt>
                           <dt><span class="section"><a href="#d0e212">URL w Coyote</a></span></dt>
                           <dt><span class="section"><a href="#d0e273">Umieszczanie kontroler&oacute;w w podkatalogach</a></span></dt>
                           <dt><span class="section"><a href="#d0e292">Parametry</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e374">Kontrolery</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e408">Akcje prywatne</a></span></dt>
                           <dt><span class="section"><a href="#d0e421">Konstruktor klas</a></span></dt>
                           <dt><span class="section"><a href="#d0e431">Informacje o module, kontrolerze i akcji</a></span></dt>
                           <dt><span class="section"><a href="#d0e450">Metoda __start()</a></span></dt>
                           <dt><span class="section"><a href="#d0e458">Metoda __call()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e472">Tworzenie folderu aplikacji</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e522">Tworzenie pliku konfiguracji</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e544">Struktura katalog&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e632">Kolejno&#347;&#263; odczytywanych plik&oacute;w</a></span></dt>
                  </dl>
               </div>
               <p>
                  W tym rozdziale, wprowadzimy pare poj&#281;&#263;, z kt&oacute;rymi powiniene&#347; si&#281; zapozna&#263;. Przybli&#380;ymy
                  pokr&oacute;tce zasady dzia&#322;ania frameworka. 
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e138"></a>MVC
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     MVC, czyli akronim od s&#322;&oacute;w <span class="italic">Model-View-Controller</span>. 
                     Jest to architektoniczny wzorzec projektowania aplikacji. Ide&#261; tego wzorca jest odzielenie 
                     warstwy danych, logiki oraz prezentacji. 
                     
                  </p>
                  <p>
                     <span class="bold"><b>Model</b></span> reprezentuje struktur&#281; danych. Przewa&#380;nie zawiera
                     klasy pobieraj&#261;ce, uaktualniaj&#261;ce informacje z no&#347;nika danych. No&#347;nikiem danych mo&#380;e by&#263;
                     baza danych, plik XML. 
                     
                  </p>
                  <p>
                     <span class="bold"><b>Widok</b></span> to warstwa prezentacyjna. Innymi s&#322;owy jest to
                     warstwa zawieraj&#261;ca kod XHTML, XML, DocBook w zale&#380;no&#347;ci od formy prezentacji naszych
                     danych. Widok mo&#380;e pobiera&#263; dane od modelu i/lub kontrolera.            
                     
                  </p>
                  <p>
                     <span class="bold"><b>Kontroler</b></span> to warstwa logiki. Kontroler pobiera dane od
                     modelu, oraz wywo&#322;uje widok. Mo&#380;e r&oacute;wnie&#380; przekaza&#263; dane do widoku. Ka&#380;de &#380;adanie jest
                     przekazywane kontrolerowi, kt&oacute;ry decyduje o dalszych instrukcjach. 
                     
                  </p>
                          
                          Wi&#281;cej informacji na temat wzorca MVC mo&#380;esz znale&#378;&#263; pod adresem <a href="http://en.wikipedia.org/wiki/MVC" target="_top">http://en.wikipedia.org/wiki/MVC</a>. 
                      
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e165"></a>Pierwsze kroki
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Je&#380;eli poprawnie zainstalowa&#322;e&#347; serwer
                     HTTP, PHP oraz Coyote, mo&#380;emy zaczyna&#263;. Je&#380;eli chcesz mo&#380;esz usun&#261;&#263; pliki strony powitalnej.
                     Wystarczy klikn&#261;&#263; na przycisk <span class="italic">Usu&#324; pliki projektu</span> na
                     g&#322;&oacute;wnej stronie powitalnej. Od tej pory posiadasz na dysku framework w "czystej" postaci.
                     Je&#380;eli wiesz ju&#380; czym jest architektura MVC, mo&#380;emy przyst&#261;pi&#263; do pierwszej czynno&#347;ci, czyli
                     napisania standardowego <span class="bold"><b>Hello World</b></span>. 
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e176"></a>Hello World
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Pierwszym krokiem b&#281;dzie utworzenie kontrolera <tt class="filename">index.php</tt>, w
                        katalogu <tt class="filename">controller</tt>. Plik kontrolera musi posiada&#263; tak&#261; sam&#261; nazw&#281;
                        co jego klasa. Tak wi&#281;c utw&oacute;rz plik <tt class="filename">index.php</tt>, kt&oacute;ry powinien mie&#263;
                        tak&#261; posta&#263;:
                        
                     </p><pre class="programlisting">
&lt;?php

class Index extends Controller
{
    function main()
    {
        echo 'Hello World';
    }
}
?&gt;
                </pre><p>
                        
                     </p>
                     <p>
                        Jak widzisz budowa kontrolera jest prosta. Znajduje si&#281; tutaj metoda
                        <tt class="methodname">main()</tt> kt&oacute;ra jest g&#322;&oacute;wn&#261; metod&#261; ka&#380;dego kontrolera. Innymi
                        s&#322;owy jest domy&#347;ln&#261; <span class="emphasis"><em>akcj&#261;</em></span>. Je&#380;eli w URL nie zostanie przekazana
                        nazwa akcji, zostanie wygenerowany kod domy&#347;lnej - <tt class="methodname">main()</tt>. 
                        
                     </p>
                     <p>
                        Napis <span class="emphasis"><em>Hello World</em></span> powinien si&#281; wy&#347;wietli&#263; w momencie wej&#347;cia na
                        g&#322;&oacute;wn&#261; stron&#281; projektu, czyli np. http://127.0.0.1/coyote/index.php
                        
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        Aby unikn&#261;&#263;
                        konflikt&oacute;w w nazewnictwie, nazwa klasy kontrolera mo&#380;e posiada&#263; przyrostek _Controller
                        - np.: Index_Controller.
                        
                     </div>
                     <p>
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e212"></a>URL w Coyote
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Domy&#347;lnie Coyote generuje tzw. przyjazne linki, kt&oacute;re z &#322;atwo&#347;ci&#261; s&#261; indeksowane
                        przez wyszukiwarki. Domy&#347;lnie linki w Coyote maj&#261; posta&#263;: 
                        http://serwer.com/Kontroler/Akcja, czyil np. http://serwer.com/Blog/View.
                        
                        System, tak skonstru&#322;owany URL rozpozna i utworzy obiekt odopwiedniej klasy (kontrolera). 
                        W tym przypadku kontrolerem jest <span class="emphasis"><em>Blog</em></span>, a akcj&#261; - <span class="emphasis"><em>View</em></span>. 
                        Innymi s&#322;owy utworzona zostanie instancja klasy <tt class="classname">blog</tt>, znajduj&#261;ca si&#281; w
                        <tt class="filename">controller/blog.php</tt>. Wykonany zostanie kod metody <tt class="methodname">view</tt>. 
                        
                        
                     </p>
                     <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">WA&#379;NE</h3>
                        Przyj&#281;to za&#322;o&#380;enie, &#380;e nazwy metod zaczynamy
                        od ma&#322;ej litery. Nazwa akcji, czy kontrolera zawarta w URL mo&#380;e by&#263; pisana ma&#322;ymi lub
                        wielkimi literami. Nie ma to znaczenia. Czyli mo&#380;e to by&#263; np. http://serwer.com/Blog/View, 
                        jak i r&oacute;wnie&#380; http://serwer.com/blog/view. 
                        
                     </div>
                     <p>
                        
                     </p>
                     <p>
                        Domy&#347;lnie ka&#380;dy URL w Coyote kszta&#322;towany jest nast&#281;puj&#261;co: http://sewer.com/index.php/Blog. 
                        Czyli innymi s&#322;owy w URL do&#322;&#261;czana jest nazwa skryptu zawieraj&#261;cego <span class="italic">Front Controller</span>.
                        
                        Oczywi&#347;cie konfiguracja umo&#380;liwia wy&#322;&#261;czenie tego. Wcze&#347;niej jednak trzeba odpowiednio
                        skonfigurowa&#263; serwer, tak, aby ka&#380;de &#380;&#261;danie by&#322;o przekazywane do <span class="italic">Front Controllera</span>. 
                        W tym celu, w g&#322;&oacute;wnym katalogu projektu umie&#347;&#263; plik <tt class="filename">.htaccess</tt> o nast&#281;puj&#261;cej
                        tre&#347;ci:
                        
                        
                     </p><pre class="programlisting">
Options +FollowSymlinks
RewriteEngine on
#Jesli masz zainstalowany system Coyote w podkatalogu (np. www.example.pl/coyote/)
#to usun komentarz z ponizszej linii i ustaw prawidlowo nazwe podkatalogu
#RewriteBase /coyote/

RewriteCond %{REQUEST_FILENAME} !-s [NC]
RewriteCond %{REQUEST_FILENAME} !-d [NC]
RewriteRule ^(.+) index.php/$1 [L]
                </pre><p>
                        
                     </p>
                     <p>
                        Takie instrukcje oznaczaj&#261;, i&#380; serwer przy ka&#380;dym &#380;&#261;daniu b&#281;dzie sprawdza&#322;, czy
                        istnieje dany plik lub katalog. Je&#380;eli istnieje - wy&#347;wietla go. Je&#380;eli nie - wykonywany
                        b&#281;dzie skrypt <tt class="filename">index.php</tt>. 
                        
                     </p>
                     <p>
                        Ostatni&#261; rzecz&#261;, kt&oacute;r&#261; musisz zrobi&#263;, to ustawienie parametru konfiguracji
                        frameworka. Otw&oacute;rz plik <tt class="filename">config.xml</tt> (lub inny, zawieraj&#261;cy
                        konfiguracje projektu) i odszukaj w&#322;a&#347;ciwo&#347;&#263; <tt class="varname">frontController</tt>.
                        Zmodyfikuj t&#281; warto&#347;&#263; do takiej postaci:
                        
                        
                     </p><pre class="programlisting">&lt;frontController&gt;&lt;/frontController&gt;</pre><p>
                        
                     </p>
                     <p>
                        Od tej pory nasze URL'e b&#281;d&#261; wygl&#261;da&#322;y lepiej. 
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        Wi&#281;cej informacji o konfiguracji URL, znajdziesz w sekcji po&#347;wi&#281;conej systemowi routingu.
                        
                     </div>
                     <p>
                        
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        R&oacute;wnie dobrze mo&#380;esz usun&#261;&#263; znacznik &lt;fontController&gt; z pliku
                        konfiguracji. Wi&#281;cej o znaczeniu poszczeg&oacute;lnych opcji konfiguracji, dowiesz si&#281; w
                        sekcji po&#347;wi&#281;conej konfiguracji frameworka. 
                        
                     </div>
                     <p>
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e273"></a>Umieszczanie kontroler&oacute;w w podkatalogach
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Kontrolery aplikacji mog&#261; by&#263; gromadzone w podkataloach. Przeprowad&#378;my ma&#322;y test. 
                        W katalogu controller, utw&oacute;rz folder foo. Nast&#281;pnie umie&#347;&#263; w nim plik bar.php:
                        
                     </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
    function main()
    {
        echo 'Hello from: ' . get_class();
    }
}
?&gt;
                    </pre><p>
                        
                     </p>
                     <p>
                        Mo&#380;esz sprawdzi&#263; dzia&#322;anie wpisuj&#261;c w pasku adresu przegl&#261;darki, adres:
                        <tt class="computeroutput">http://serwer.com/Foo/Bar</tt>. 
                        
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        Jak to dzia&#322;a?
                        Je&#380;eli wpiszemy w pasku adres URL, taki jak powy&#380;ej, system poszuka w katalogu
                        controller, kontrolera o nazwie foo. Je&#380;eli go nie odnajdzie - sprawdzi, czy
                        istnieje katalog Foo. W tym momencie Foo jest traktowane jako <span class="italic">podkatalog</span>. 
                        A Bar jako nazwa kontrolera.
                        
                     </div>
                     <p>
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e292"></a>Parametry
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Do URL'a mog&#261; by&#263; przekazywane dodatkowe parametry. Przeanalizujmy nast&#281;puj&#261;cy
                        przyk&#322;ad: <tt class="computeroutput">http://serwer.com/Foo/Bar/Main/12/56</tt>
                        
                     </p>
                     <p>W tym momencie mo&#380;emy wyr&oacute;&#380;ni&#263;:</p>
                     <p>
                        
                     </p>
                     <div class="table"><a name="d0e304"></a><p class="title"><b>Tabela 3.1. Parametry URL</b></p>
                        <table summary="Parametry URL" border="0">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <thead>
                              <tr>
                                 <th>Parametr</th>
                                 <th>Opis</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td>Foo</td>
                                 <td>Nazwa modu&#322;u</td>
                              </tr>
                              <tr>
                                 <td>Bar</td>
                                 <td>Nazwa kontrolera</td>
                              </tr>
                              <tr>
                                 <td>Main</td>
                                 <td>Nazwa akcji</td>
                              </tr>
                              <tr>
                                 <td>12</td>
                                 <td>Parametr</td>
                              </tr>
                              <tr>
                                 <td>56</td>
                                 <td>Parametr</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                        
                     </p>
                     <p>
                        Nast&#281;puj&#261;cy kod pobiera list&#281; parametr&oacute;w przekazanych do
                        URL:
                        
                     </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
    function main()
    {
        echo 'Hello from: ' . get_class() . '&lt;br /&gt;';
        echo 'Action: ' . __FUNCTION__ . '&lt;br /&gt;';
        echo 'Parametr(s): ';
        
        foreach ($this-&gt;router-&gt;getArguments() as $arg)
        {
            echo $arg . '  ';
        }
    }
}
?&gt;
                </pre><p>
                        
                     </p>
                     <p>
                        Taki kod spowoduje wy&#347;wietlenie w oknie przegl&#261;darki nast&#281;puj&#261;cych
                        informacji:
                        
                     </p><pre class="programlisting">
Hello from: Bar
Action: main
Parametr(s): 12 54
                </pre><p>
                        
                     </p>
                     <p>
                        Jak widzisz, do pobierania warto&#347;ci parametru s&#322;u&#380;y metoda <tt class="methodname">getArguments()</tt>. 
                        Zwraca ona tablic&#281; parametr&oacute;w przekazanych wraz z URL'em.
                        
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        Aby pobra&#263; jeden, konkretny parametr, mo&#380;na skorzysta&#263; z metody getArgument(). 
                        W parametrze nale&#380;y poda&#263; numer parametru, poczyanaj&#261;c od zera (tzn. pierwszy parametr b&#281;dzie mia&#322; indeks zero, drugi - jeden
                        itd.).
                        
                     </div>
                     <p>
                        
                     </p>
                     <p>
                        We&#378;my pod uwag&#281; inny przyk&#322;ad. W URL'u chcemy przekaza&#263; nasze imi&#281; oraz wiek.
                        Taki URL mo&#380;e wygl&#261;da&#263; tak: http://127.0.0.1/framework/Foo/Bar/main/Adam/99. 
                        
                        Zamiast korzysta&#263; z metod tablicy <tt class="varname">param</tt> mo&#380;emy przekszta&#322;ci&#263; kontroler w ten
                        spos&oacute;b:
                        
                     </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
    function main($name, $age)
    {
        echo "My name is $name, and I'm $age\n";
    }
}
?&gt;
                </pre><p>
                        
                     </p>
                     <p>
                        Jak widzisz, warto&#347;ci parametr&oacute;w zosta&#322;y przekazane bezpo&#347;rednio do akcji.
                        
                        
                     </p>
                     <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">WA&#379;NE</h3>
                        Warto&#347;ci parametr&oacute;w s&#261; "bezpieczne". Tj. dane wcze&#347;niej s&#261; filtrowane pod wzgl&#281;dem XSS oraz SQL
                        Injection. 
                        
                     </div>
                     <p>
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e374"></a>Kontrolery
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     My&#347;l&#281;, &#380;e w poprzednim rozdziale wyja&#347;nilismy nieco zasady tworzenia kontroler&oacute;w. Podsumujmy:
                     
                     
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>Kontroler musi by&#263; umieszczony w katalogu controller</li>
                        <li>Kontrolery mog&#261; by&#263; grupowane w podkatalogach</li>
                        <li>Nazwa pliku PHP odpowiada nazwie kontrolera</li>
                        <li>Nazwa klasy musi odpowiada&#263; nazwie kontrolera. </li>
                        <li>Kontrolery mog&#261; posiada&#263; akcje.</li>
                     </ul>
                  </div>
                  <p>
                     
                  </p>
                  <p>
                     Zauwa&#380;y&#322;e&#347; zapewne, &#380;e nazwa akcji odpowiada metodzie w klasie kontrolera. Powracaj&#261;c do
                     poprzedniego przyk&#322;adu: je&#380;eli URL kszta&#322;tuje si&#281; w nast&#281;puj&#261;cy spos&oacute;b:
                     <tt class="computeroutput">http://serwer.com/Foo/Bar/View</tt>, wykonany zostanie
                     kontroler <span class="italic">Bar</span>, z podkatalogu <span class="italic">Foo</span> oraz akcja <span class="italic">View</span>.
                     
                     
                  </p>
                  <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">WA&#379;NE</h3>
                     W systemach *nix rozr&oacute;&#380;niana jest wielko&#347;&#263; znak&oacute;w. Wobec tego nazwy plik&oacute;w z kontrolerami oraz nazwy
                     modu&#322;&oacute;w musz&#261; by&#263; pisane ma&#322;ymi literami. Przyk&#322;adowo /controller/foo.php, a nie
                     /controller/FOO.php. 
                     
                  </div>
                  <p>
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e408"></a>Akcje prywatne
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Skoro powiedzieli&#347;my, &#380;e akcja odpowiada metodzie w kontrolerze, musimy wspomnie&#263;
                        r&oacute;wnie&#380; o metodach prywatnych. PHP5 umo&#380;liwia tworzenie metod prywatnych, kt&oacute;re b&#281;d&#261;
                        dostepne jedynie w obr&#281;bie danej klasy. Je&#380;eli chcemy, aby dost&#281;p do danej metody nie by&#322;
                        mo&#380;liwy z zewn&#261;trz, musimy zadeklarowa&#263; akcj&#281; jako prywatn&#261;:
                        
                        
                     </p><pre class="programlisting">
private function view()
{
    echo 'Private metod';
}            
                </pre><p>
                        
                     </p>
                     <p>
                        Teraz przy pr&oacute;bie wej&#347;cia na stron&#281; 
                        <tt class="computeroutput">http://127.0.0.1/framework/Foo/Bar/View</tt>, wy&#347;wietli si&#281;
                        b&#322;&#261;d. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e421"></a>Konstruktor klas
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Jak ka&#380;da klasa PHP5, tak&#380;e kontroler mo&#380;e zawiera&#263; konstruktor. Nie zapomnij jednak,
                        aby zawrze&#263; w nim instrukcje wywo&#322;uj&#261;ce konstrktor
                        bazowy:
                        
                     </p><pre class="programlisting">
function __construct()
{
    parent::__construct();
    
    // dalszy kod
}
                </pre><p>
                        
                     </p>
                     <p>
                        W konstruktorze mo&#380;emy zawrze&#263; kod, kt&oacute;ry ma by&#263; wykonywany zaraz po inicjalizacji
                        kontrolera. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e431"></a>Informacje o module, kontrolerze i akcji
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        W prosty spos&oacute;b mo&#380;emy odczyta&#263; nazw&#281; podkatalogu, kontrolera czy
                        akcji:
                        
                     </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
    function main()
    {
        echo 'Controller: ' . $this-&gt;getController() . '&lt;br &gt;';
        echo 'Action: ' . $this-&gt;getAction() . '&lt;br /&gt;';
        echo 'Folder: ' . $this-&gt;getFolder();
    }
}
?&gt;
                </pre><p>
                        
                     </p>
                     <p>
                        Metoda <tt class="varname">getController()</tt> zwraca nazw&#281; kontrolera,
                        <tt class="varname">getAction()</tt> - nazw&#281; akcji, a <tt class="varname">getFolder()</tt> - jak
                        nietrudno si&#281; domy&#347;le&#263; - nazw&#281; podkatalogu. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e450"></a>Metoda __start()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Czasami istnieje konieczno&#347;&#263; wykonania jakiej&#347; czynno&#347;ci przed wykonaniem kodu z akcji
                        (metody) klasy, ale ju&#380; po wykonaniu kodu z konstruktora klasy. Istnieje taka mo&#380;liwo&#347;&#263; za
                        spraw&#261; specjalnej merody <tt class="methodname">__start()</tt>. Je&#380;eli takow&#261; umie&#347;cisz w
                        kontrolerze, system wywo&#322;a t&#261; metod&#281; zanim wywo&#322;a akcj&#281;. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e458"></a>Metoda __call()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Je&#380;eli jeste&#347; programist&#261; PHP, na pewno wiesz o magicznej metodzie
                        <tt class="methodname">__call()</tt>. Powiedzieli&#347;my sobie, &#380;e je&#380;eli system nie b&#281;dzie
                        m&oacute;g&#322; w danym kontrolerze zlokalizowa&#263; metodzie odpowiadaj&#261;cej akcji, wy&#347;wietli b&#322;&#261;d 404.
                        Tutaj wdar&#322;o si&#281; ma&#322;e niedopowiedzenie. Owszem, stanie si&#281; tak pod warunkiem, i&#380; w klasie
                        nie zadeklarowano metody <tt class="methodname">__call()</tt>. W takim wypadku, system wywo&#322;a
                        metod&#281; <tt class="methodname">__call()</tt>, z kt&oacute;rej ju&#380; sam mo&#380;esz zdecydowa&#263; jakie b&#281;dzie
                        dzia&#322;anie programu. 
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e472"></a>Tworzenie folderu aplikacji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Ok, zapomnij teraz o ca&#322;ym frameworku. Oczwi&#347;cie swoje biblioteki i pliki mo&#380;esz 
                     umieszcza&#263; w folderze z frameworkiem.
                     
                     Jednak mo&#380;esz traktowa&#263; go jako j&#261;dro, w kt&oacute;rym nie trzeba nic zmienia&#263;. Mo&#380;esz utworzy&#263;
                     sw&oacute;j w&#322;asny katalog aplikacji, w kt&oacute;rym b&#281;dziesz Tworzy&#322; struktur&#281; folder&oacute;w wed&#322;ug w&#322;asnego
                     uznania. Jedyne co musisz zrobi&#263;, to za&#322;&#261;czy&#263; plik j&#261;dra frameworka do swojej aplikacji. W
                     ten spos&oacute;b na serwerze mo&#380;esz mie&#263; kilka serwis&oacute;w, kt&oacute;re korzystaj&#261; z tej samej wersji
                     frameworka. Utw&oacute;rz na serwerze nowy katalog. Nazwijmy go <span class="italic">project</span>
                     
                  </p>
                  <p>
                     W nowym folderze stw&oacute;rz plik index.php oraz katalog <tt class="filename">controller</tt>. Zawarto&#347;&#263; pliku
                     index.php powinna zawiera&#263; instrukcje w&#322;&#261;czaj&#261;ce do apliakcji plik Front Controllera. Oto jak
                     mo&#380;e on
                     wygl&#261;da&#263;:
                     
                  </p><pre class="programlisting">
&lt;?php

error_reporting(E_ALL);
setlocale(LC_ALL, array('pl_PL.UTF8', 'polish_pol')); 
date_default_timezone_set('Europe/Warsaw');

DEFINE('DEBUG', true);

$system_dir = '../coyote-1-0/';

/**
*	Ta zmienna nie powinna byc zmieniana. Okresla ona sciezke do katalogu, w ktorym
*	znajduja sie pliki frameworka. 
*/
$root_dir = realpath(dirname(__FILE__)) . '/' . $system_dir;
$root_dir = str_replace('\\', '/', $root_dir);

if (!file_exists($root_dir . 'lib/core.class.php'))
{
die('Could not find framework directory');
}
include_once($root_dir . 'lib/core.class.php');

/**
* Ustawienie sciezki do katalogu, w ktorym znajduje sie aplikacja
*/
Core::setBasePath(getcwd());
/**
*	Metoda bootstrap() sluzy do inicjalizacji podstawowych zmiennych projektu
*/
Core::bootstrap($root_dir)-&gt;dispatch();
?&gt;
            </pre><p>
                     
                  </p>
                  <p>
                     Mamy tutaj kilka instrukcji, kt&oacute;re ustawiaj&#261; &#347;cie&#380;ki do aplikacji oraz frameworka. Zmienna
                     <tt class="varname">$system_dir</tt> musi wskazywa&#263; na folder systemowy (z plikami frameworka).
                     Zmienna <tt class="varname">$root_dir</tt> tworzy wobec tego pe&#322;n&#261; &#347;cie&#380;k&#281; do plik&oacute;w systemu.
                     Metoda <tt class="methodname">bootstrap()</tt> inicjalizuje podstawowe zmienne
                     systemu.
                     
                  </p>
                  <p>
                     Metoda <tt class="methodname">setBasePath()</tt> ustawia &#347;cie&#380;k&#281; do
                     katalogu z aplikacj&#261;. Poniewa&#380; domy&#347;lnie, je&#380;eli nie ustawimy tej &#347;cie&#380;ki - system przyjmie,
                     iz &#347;cie&#380;k&#261; aplikacji jest &#347;cie&#380;ka do frameworka. 
                     
                  </p>
                  <p>
                     P&oacute;ki co to wszystko. 
                     
                     Gratulacje, w&#322;a&#347;nie poprawnie utworzy&#322;e&#347; nowy projekt korzystaj&#261;cy z Coyote. Po pr&oacute;bie
                     wej&#347;cia np. poprzez adres http://serwer.com/project wy&#347;wietli si&#281; informacja o b&#322;&#281;dzie.
                     Wszak nie utworzyli&#347;my jeszcze &#380;adnego kontrolera, st&#261;d aplikacja nie wie jak&#261; stron&#281; ma
                     wygnerowa&#263;. Komunikat powinien by&#263; podobny do tego:
                     
                  </p><pre class="programlisting">
Page not found

The requested page was not found. It may have been moved, been deleted, or archived.
Request file does not exist: controller/index.php
                </pre><p>
                     
                  </p>
                  <p>
                     Utw&oacute;rz w swoim katalogu z aplikacj&#261;, folder controller. Umie&#347;&#263; w nim plik
                     <tt class="filename">index.php</tt>, kt&oacute;rego zawarto&#347;&#263; mo&#380;e by&#263; nast&#281;puj&#261;ca:
                     
                     
                  </p><pre class="programlisting">
&lt;?php

class Index extends Controller
{
    function main()
    {
        echo 'Hello World';
    }
}
?&gt;
            </pre><p>
                     
                  </p>
                  <p>
                     Napisail&#347;my w ten spos&oacute;b prosty kontroler. 
                     
                     Teraz, po wpisaniu w przegl&#261;darce adresu do projektu (np.
                     http://serwer.com/project) powinien wy&#347;wietli&#263; si&#281; napis <span class="emphasis"><em>Hello World</em></span>. 
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e522"></a>Tworzenie pliku konfiguracji
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Coyote nie potrzebuje konfiguracji. Lecz w ka&#380;dej wi&#281;kszej aplikacji pliki
                        konfiguracyjne s&#261; potrzebne. Mog&#261; zawiera&#263; podstawowe informacje o ustawieniach projektu.
                        
                        W naszym nowym folderze utw&oacute;rz plik <tt class="filename">config.xml</tt>. 
                        Przyk&#322;adowa konfiguracja naszego nowego projektu mo&#380;e wygl&#261;da&#263;
                        tak:
                        
                     </p><pre class="programlisting">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
&lt;application&gt;My App&lt;/application&gt;
&lt;/config&gt;
                </pre><p>
                        
                     </p>
                     <p>
                        Coyote automatycznie wczyta plik konfiguracji do swoich zasob&oacute;w. Teraz, w ka&#380;dym
                        miejscu, w programie b&#281;dziesz m&oacute;g&#322; odczyta&#263; warto&#347;&#263; p&oacute;l konfiguracji. S&#322;u&#380;y do tego klasa
                        <tt class="classname">Config</tt>, a konkretnie - metoda
                        <tt class="methodname">getItem()</tt>:
                        
                     </p><pre class="programlisting">
echo 'Hello World &lt;br /&gt;';
echo Config::getItem('application');
                </pre><p>
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e544"></a>Struktura katalog&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     W katalogu <tt class="filename">controller</tt> powiniene&#347; umieszcza&#263; pliki kontroler&oacute;w. 
                     Reszta ju&#380; zale&#380;y od Ciebie. Jednak&#380;e korzystaj&#261;c z loadera Coyote wymagana jest okre&#347;lona struktura
                     katalog&oacute;w. Poniewa&#380; loader domy&#347;lnie poszkuje bibliotek w katalogach
                     <tt class="filename">lib</tt>. Klas modeli natomiast w katalogach <tt class="filename">model</tt>, a
                     helper&oacute;w - w folderze <tt class="filename">helper</tt>. 
                     
                  </p>
                  <p>
                     Coyote dostarcza oczywi&#347;cie w&#322;asny
                     
                     zestaw bibliotek, kt&oacute;re mo&#380;esz znale&#378;&#263; w katalogu lib. Oto przyk&#322;ad jak z nich
                     kozysta&#263;:
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;library('feed');
$feed = $this-&gt;feed-&gt;import('http://4programmers.net/rss.php?rss=topic');

print_r($feed);
            </pre><p>
                     
                  </p>
                  <p>
                     W tym przyk&#322;adzie za&#322;adowali&#347;my bibliotek&#281; <tt class="classname">feed</tt>, do obs&#322;ugi nag&#322;&oacute;wk&oacute;w
                     RSS 2.0. Tutaj wykorzystali&#347;my metod&#281; <tt class="methodname">import()</tt>, kt&oacute;ra pobra&#322;a
                     nag&#322;&oacute;wki ze wskazanego URL i skonwertowa&#322;a je do postaci tablicy PHP.
                     
                  </p>
                  <p>
                     Podsumowuj&#261;c, w swojej aplikcji mo&#380;esz mie&#263; nast&#281;puj&#261;ce katalogi:
                     
                  </p>
                  <p>
                     
                  </p>
                  <div class="table"><a name="d0e578"></a><p class="title"><b>Tabela 3.2. Katalogi aplikacji korzystaj&#261;cej z Coyote</b></p>
                     <table summary="Katalogi aplikacji korzystaj&#261;cej z Coyote" border="0">
                        <colgroup>
                           <col>
                           <col>
                        </colgroup>
                        <thead>
                           <tr>
                              <th>Folder</th>
                              <th>Opis</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>cache</td>
                              <td>Folder z plikami cache</td>
                           </tr>
                           <tr>
                              <td>lib</td>
                              <td>Folder zawieraj&#261;cy dodatkowe biblioteki</td>
                           </tr>
                           <tr>
                              <td>model</td>
                              <td>Folder zawieraj&#261;cy klasy modelu</td>
                           </tr>
                           <tr>
                              <td>module</td>
                              <td>Folder zawieraj&#261;cy dodatkowe modu&#322;y</td>
                           </tr>
                           <tr>
                              <td>i18n</td>
                              <td>Folder zawieraj&#261;cy pliki j&#281;zykowe</td>
                           </tr>
                           <tr>
                              <td>helper</td>
                              <td>Folder zawieraj&#261;cy pliki pomocnik&oacute;w (helper)</td>
                           </tr>
                           <tr>
                              <td>template</td>
                              <td>Folder zawierj&#261;cy widoki</td>
                           </tr>
                           <tr>
                              <td>log</td>
                              <td>Folder zawierj&#261;cy ewentualne logi systemowe</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e632"></a>Kolejno&#347;&#263; odczytywanych plik&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Na tym etapie nale&#380;y powiedzie&#263; wa&#380;n&#261; rzecz, o kt&oacute;rej musisz mie&#263; &#347;wiadomo&#347;&#263;. Framework
                     automatycznie ustawia &#347;cie&#380;ki include_path dla katalogu z frameworkiem oraz dla katalogu z
                     aplikacj&#261;. Oznacza to, &#380;e pr&oacute;buj&#261;c wywo&#322;a&#263; jaki&#347; zas&oacute;b (bibliotek&#281;, plik konfiguracji itp.)
                     system najpierw poszukuje go w katalogu z aplikacj&#261;, a nast&#281;pnie w katalogu z frameworkiem.
                     Powr&oacute;&#263;my do przyk&#322;adu naszego pliku konfiguracyjnego. W momencie startu aplikacji framework
                     spr&oacute;buje odnale&#378;&#263; plik konfiguracyjny z katalogu aplikacji, a nast&#281;pnie - z katalogu
                     frameworku. Ze wzgl&#281;du na dzia&#322;anie mechanizmu konfiguracji, je&#380;eli takie pliki zostan&#261;
                     odnalezione w obydw&oacute;ch katalogach - zostan&#261; po&#322;&#261;czone. Tak wi&#281;c przed pisaniem aplikacji pod
                     Coyote, zalecane jest usuni&#281;cie wszystkich niepotrzebnych plik&oacute;w z katalogu z frameworkiem
                     (mi&#281;dzy innymi pliku config.xml, kt&oacute;ry domy&#347;lnie jest umieszczony w katalogu Coyote'a).
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e637"></a>Rozdzia&#322; 4. Plik front controllera
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e661">Utworzenie pliku .htaccess</a></span></dt>
                     <dt><span class="section"><a href="#d0e680">Zawarto&#347;&#263; pliku front controllera</a></span></dt>
                  </dl>
               </div>
               <p>
                  
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>
                  Front Controller &#8211; jeden ze wzorc&oacute;w projektowych stosowany w projektowaniu aplikacji internetowych. We wzorcu tym istnieje
                  jeden, centralny obiekt (np. serwlet), kt&oacute;ry zarz&#261;dza wszystkimi &#380;adaniami przychodz&#261;cymi od klienta. Wzorzec ten jest cz&#281;sto
                  stosowany ze wzorcem MVC.
                  
               </div>
               <p>
                  
                  <span class="emphasis"><em>&#379;r&oacute;d&#322;o: Wikipedia</em></span>
                  
               </p>
               <p>
                  Wspomnieli&#347;my ju&#380; &#380;e najelpszym sposobem korzystania z frameworka, jest oddzielenie plik&oacute;w samego frameworka, 
                  od plik&oacute;w aplikacji. Nale&#380;y traktowa&#263; pliki frameworka jak j&#261;dro, kt&oacute;rego nie powinno si&#281; modyfikowa&#263; je&#380;eli
                  nie ma takiej wyra&#378;nej potrzeby. Na swoim lokalnym serwerze mo&#380;esz utworzy&#263; katalog aplikacji, w kt&oacute;rej 
                  b&#281;dziesz umieszcza&#322; kontrolery, modele i inne potrzebne pliki. Sposobem na osi&#261;gni&#281;cie tego jest skorzystanie
                  ze wzorca <span class="emphasis"><em>front controllera</em></span>.
                  
               </p>
               <p>
                  Pierwszym krokiem jest utworzenie w katalogu z aplikacj&#261; (nazwijmy go <tt class="filename">demo</tt>) pliku 
                  <tt class="filename">index.php</tt>. Do tego pliku b&#281;d&#261; kierowane wszystkie &#380;&#261;dania u&#380;ytkownika.
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e661"></a>Utworzenie pliku .htaccess
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     W katalogu z projektem, umie&#347;&#263; plik <tt class="filename">.htaccess</tt>, kt&oacute;ry b&#281;dzie odpowiedzialny za
                     kierowanie &#380;&#261;dania do pliku front controllera (czyli <tt class="filename">index.php</tt>):
                     
                     
                  </p><pre class="programlisting">

php_flag short_open_tag on

Options +FollowSymlinks
RewriteEngine on

RewriteCond %{REQUEST_URI} \..+$
RewriteCond %{REQUEST_URI} !\.html$
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule .* - [L]

RewriteCond %{REQUEST_FILENAME} !-s [NC]
RewriteCond %{REQUEST_FILENAME} !-d [NC]
RewriteRule ^(.+) index.php/$1 [L]

ErrorDocument 500 "&lt;h2&gt;Application error&lt;/h2&gt;Coyote application failed to start properly"
                
            </pre><p>
                     
                     W pliku <tt class="filename">.htaccess</tt> umie&#347;cili&#347;my regu&#322;y modu&#322;u Apache - mod_rewrite.
                     Nie b&#281;dziemy rozpisywa&#263; si&#281; tutaj o samym mod_rewrite, gdy&#380; to nie jest przedmiotem
                     tej dokumentacji.
                     
                  </p>
                  <p>
                     Dzi&#281;ki takiemu zapisowi, &#380;&#261;dania kierowane przez u&#380;ytkownika (np. http://localhost/demo/Foo) b&#281;d&#261;
                     kierowane wprost do pliku front controllera, kt&oacute;ry natomiast zainicjuje biblioteki frameworka
                     i przeka&#380;e &#380;&#261;danie do odpowiedniego kontrolera.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e680"></a>Zawarto&#347;&#263; pliku front controllera
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     W katalogu z frameworkiem, znajduje si&#281; przyk&#322;adowy plik <tt class="filename">index.php</tt>, kt&oacute;ry
                     mo&#380;esz wykorzysta&#263; w swojej aplikacji:
                     
                     
                  </p><pre class="programlisting">

&lt;?php
/**
 * @package Coyote-F
 * @author Adam Boduch &lt;adam@boduch.net&gt;
 * @copyright Copyright (c) Adam Boduch (Coyote Group)
 * @license http://www.opensource.org/licenses/bsd-license.php New BSD License
 */

/**
 *	Ustawienie raportowania bledow. W ustawieniu E_ALL, wszystkie bledy i ostrzezenia
 *	beda domyslnie wyswietlane. To ustawienie jest wykorzystywane przez projekt, tylko
 *	wowczas, gdy nie wykorzystujemy klasy error. Wtedy klasa error zajmuje sie 
 *	wyswietlaniem i analiza bledow projektu i decyduje, ktore komunikaty wyswietlic.
 */
error_reporting(E_ALL);

/**
 * Ustawienie lokalizacji dla jezyka polskiego. Jezeli chcesz, mozesz usunac
 * ponizsza linie, lub zmienic lokalizacje 
 */
setlocale(LC_ALL, array('pl_PL.UTF8', 'polish_pol')); 

/**
 * Ustawienie strefy czasowej na polska. Jezeli chcesz, mozesz dowolnie zmienic ponizsze
 * ustawienie lub usunac ponizsza linie i pozostawic ustawienie domyslne
 */
date_default_timezone_set('Europe/Warsaw');


/**
 * Domyslnie wartosc true. Skrypt jednak jest wowczas generowany wolniej ze wzgledu
 * na informacje zbierane w trakcie wykonywania. Ulatwia to prace programiscie. Jednak
 * w wersji finalnej, wartosc DEBUG powinna wynosic false.
 */
DEFINE('DEBUG', true);


/**
 *	Domyslnie wartosc tej zmiennej jest pusta. Mozesz ja wykorzystac jezeli ten plik
 *	(index.php) nie jest umieszczony w folderze z frameworkiem. Wowczas ta zmienna okresla,
 *	w ktorym katalogu znajduja sie pliki frameworka. Nie zapomnij na koncu dodac slasha (/),
 *	np. coyote-f/
 */
$system_dir = 'framework/';

/**
 *	Ta zmienna nie powinna byc zmieniana. Okresla ona sciezke do katalogu, w ktorym
 *	znajduja sie pliki frameworka. 
 */
$root_dir = realpath(dirname(__FILE__)) . '/' . $system_dir;
$root_dir = str_replace('\\', '/', $root_dir);

if (!file_exists($root_dir . 'lib/core.class.php'))
{
	die('Could not find framework directory');
}
include_once($root_dir . 'lib/core.class.php');

/**
 * Ustawienie sciecki do katalogu aplikacji
 */
Core::setBasePath(getcwd());

/**
 * Ustawienie pliku konfiguracji projektu
 */
Core::setConfigPath('config.xml');
/**
 *	Metoda bootstrap() sluzy do inicjalizacji podstawowych zmiennych projektu
 */
Core::bootstrap($root_dir)-&gt;dispatch();
?&gt;
                
            </pre><p>
                     
                     Budowa tego pliku jest prosta. Jego zadaniem jest ustawienie &#347;rodowiska oraz inicjalizacja &#347;cie&#380;ek
                     do katalogu z frameworkiem. 
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Je&#380;eli chcesz zmieni&#263; w swojej aplikacji ustawienia samego PHP, to jest dobre miejsce aby
                     umie&#347;ci&#263; odpowiednie funkcje (np. <tt class="methodname">setlocale()</tt>, <tt class="methodname">error_reporting()</tt></div>
                  <p>
                     
                     
                  </p>
                  <p>
                     Na samym pocz&#261;tku nast&#281;puje ustawienie lokalizacji dla naszego projektu (w tym przypadku - Polska) 
                     oraz strefy czasowej. Nast&#281;pnie zadklearowana zostaje sta&#322;a DEBUG. Jest to sta&#322;a wykorzystywana
                     przez framework i okre&#347;la tryb pracy aplikacji. W trybie DEBUG podczas dzia&#322;ania (generowania) strony, 
                     zbierana jest informacja na temat wykorzystywanych bibliotek, czasie generowania czy zapytaniach SQL.
                     
                  </p>
                  <p>
                     Nast&#281;pna wa&#380;na instrukcja to wywo&#322;anie metody <tt class="methodname">setBasePath()</tt>, kt&oacute;ra
                     ustawia &#347;cie&#380;k&#281; do katalogu aplikacji (NIE frameworka!)
                     
                  </p>
                  <p>
                     W kolejnych instrukcjach nast&#281;puje ustawienie &#347;cie&#380;ki do katalogu z frameworkiem oraz za&#322;adowanie
                     g&#322;&oacute;wnej klasy - <tt class="classname">Core</tt>. Metoda <tt class="methodname">setConfigPath()</tt> powoduje
                     za&#322;adowanie pliku konfiguracyjnego - <tt class="filename">config.xml</tt>. Je&#380;eli nie posiadasz takiego pliku
                     lub nie chcesz, aby w tym momencie zosta&#322; on za&#322;adowany do projektu, mo&#380;esz spokojnie usun&#261;&#263; t&#281; lini&#281; kodu.
                     
                  </p>
                  <p>
                     Najwa&#380;niejsza instrukcja w tym pliku, znajduje si&#281; na samym ko&#324;cu. Wywo&#322;ujemy tutaj bowiem
                     metod&#281; <tt class="methodname">bootstrap()</tt>, kt&oacute;ra inicjalizuje podstawowe elementy systemu. 
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e723"></a>Rozdzia&#322; 5. Klasa Core
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e740">Przep&#322;yw danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e870">Metoda getInstance()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e903">Korzystanie ze sk&#322;adowych aplikacji</a></span></dt>
                     <dt><span class="section"><a href="#d0e1004">Elementy j&#261;dra</a></span></dt>
                     <dt><span class="section"><a href="#d0e1055">Metoda dispatch()</a></span></dt>
                  </dl>
               </div>
               <p>
                  Klasa <tt class="classname">Core</tt> (umieszczona w pliku <tt class="filename">core.class.php</tt>
                  w katalogu <tt class="filename">/lib</tt>) stanowi g&#322;&oacute;wn&#261; klas&#281; dla ca&#322;ego projektu. Jest to
                  pierwsza klasa jaka zostaje za&#322;adowana do projektu. Klasa <tt class="classname">Core</tt> nie mo&#380;e by&#263; klas&#261; bazow&#261; dla
                  innych klas, nie mo&#380;na po niej dziedziczy&#263;. 
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e740"></a>Przep&#322;yw danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Prze&#347;led&#378;my przez chwil&#281; proces inicjalizacji wymaganych bibliotek, klas oraz ich
                     kolejno&#347;&#263;. Pozwoli to u&#380;ytkownikowi na lepsze zrozumienie dzia&#322;ania frameworka.
                     
                  </p>
                  <p>
                     Jak ju&#380; wspomnieli&#347;my, framework implementuje wzorzec front controllera. Czyli ka&#380;de
                     &#380;&#261;danie w aplikacji kierowane jest do pliku <tt class="filename">index.php</tt>. Ten z kolei uruchamia klas&#281;
                     <tt class="classname">Core</tt>, kt&oacute;ra - dalej - rozdziela otrzymane &#380;&#261;dania. Podstawow&#261;
                     metod&#261; tej klasy jest metoda <tt class="methodname">bootstrap()</tt>, kt&oacute;re mo&#380;e przyjmowa&#263;
                     opcjonanly parametr - &#347;cie&#380;k&#281; do aplikacji z frameworkiem. 
                     
                  </p>
                  <p>
                     W metodzie <tt class="methodname">bootstrap()</tt> framework przeprowadza nast&#281;puj&#261;ce czynno&#347;ci:
                     
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                                           Wywo&#322;anie metody statycznej <tt class="methodname">setRootPath()</tt> ustawiaj&#261;c&#261; &#347;cie&#380;k&#281; do
                                           katalogu z frameworkiem.
                                       
                        </li>
                        <li>
                                           Wywo&#322;anie metody statycznej <tt class="methodname">setBasePath()</tt>, kt&oacute;ra ustawia &#347;cie&#380;k&#281; do 
                                           katalogu z aplikacj&#261; (w klasie <tt class="classname">Core</tt>)
                                       
                        </li>
                        <li>
                                           Wywo&#322;anie metody <tt class="methodname">setIncludePath()</tt>, kt&oacute;ra ustawia warto&#347;&#263; 
                                           <span class="emphasis"><em>include_path</em></span> na katalogi z frameworkiem oraz z aplikacj&#261;.
                                       
                        </li>
                        <li>
                                           Za&#322;adowanie klasy loadera (klasa <tt class="classname">Load</tt>)
                                       
                        </li>
                        <li>
                                           Za&#322;adowanie klasy <tt class="classname">Log</tt></li>
                        <li>
                                           Za&#322;adowanie klasy <tt class="classname">Benchmark</tt></li>
                        <li>
                                           Inicjalizacja konfiguracji oraz za&#322;adowanie plik&oacute;w konfiguracyjnych (klasa <tt class="classname">Config</tt>)
                                       
                        </li>
                        <li>
                                           Ustawienie domy&#347;lnych warto&#347;ci konfiguracyjnych takich jak np. rozszerzenie dla plik&oacute;w szablon&oacute;w
                                       
                        </li>
                        <li>
                                           Wywo&#322;anie triggera <span class="emphasis"><em>Trigger.OnReady</em></span></li>
                        <li>
                                           Za&#322;adowanie klasy <tt class="classname">TriggerException</tt> odpowiedzialnej za obs&#322;ug&#281; wyj&#261;tk&oacute;w
                                       
                        </li>
                        <li>
                                           Za&#322;adowanie ewentualnych modu&#322;&oacute;w do projektu aplikacji
                                       
                        </li>
                        <li>
                                           Zwr&oacute;cenie rezultatu wywo&#322;ania metody <tt class="methodname">getInstance()</tt></li>
                     </ul>
                  </div>
                  <p>
                     Pierwszymi instrukcjami jest inicjalizacja p&oacute;l okre&#347;laj&#261;cych &#347;cie&#380;ki do projektu,
                     frameworka oraz pliku konfiguracji (je&#380;eli istnieje). Nast&#281;pnie wywo&#322;ywana jest
                     statyczna, prywatna metoda <tt class="methodname">setIncludePath()</tt>, kt&oacute;ra ustala
                     warto&#347;&#263; zmiennej PHP: <tt class="varname">include_path</tt>. 
                     
                  </p>
                  <p>
                     Pierwsz&#261; klas&#261; &#322;adowan&#261; w projekcie (niezale&#380;nie od ustale&#324; projektu) jest loader
                     (klasa <tt class="filename">load.class.php</tt>). Loader s&#322;u&#380;y do &#322;adowania poszczeg&oacute;lnych
                     komponent&oacute;w aplikacji/frameworka. 
                     
                  </p>
                  <p>
                     Nast&#281;pnie do zasob&oacute;w &#322;adowana jest klasa <tt class="classname">Log</tt> (<tt class="filename">log.class.php</tt>), 
                     statyczna klasa <tt class="classname">Benchmark</tt> (<tt class="filename">benchmark.class.php</tt>), klasa 
                     <tt class="classname">Trigger</tt> (<tt class="filename">trigger.class.php</tt>) obs&#322;uguj&#261;ca wyzwalacze (hooki, triggery). 
                     
                  </p>
                  <p>
                     W dalszej cz&#281;&#347;ci &#322;adowana jest statyczna klasa <tt class="classname">Config</tt>,
                     <tt class="classname">TriggerException</tt> (do ob&#322;ugi b&#322;&#281;d&oacute;w i wyj&#261;tk&oacute;w). Nast&#281;pnie
                     nast&#281;puje bardzo wa&#380;ny proces w&#322;&#261;czania ewentualnych modu&#322;&oacute;w do projektu. P&oacute;ki co
                     powiedzmy sobie, &#380;e modu&#322;y stanowi&#261; roz&#322;&#261;czalny element aplikacji. Mo&#380;emy sobie
                     wyobrazi&#263;, &#380;e modu&#322;y s&#261; &#322;adowane do projektu i stanowi&#261; jego integraln&#261; cz&#281;&#347;&#263; na czas
                     dzia&#322;ania skryptu. 
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     O modu&#322;ach b&#281;dzie mowa w dalszej cz&#281;&#347;ci podr&#281;cznika. 
                     
                  </div>
                  <p>
                     
                  </p>
                  <p>
                     Zauwaz, &#380;e metoda <tt class="methodname">bootstrap()</tt> jest metod&#261; statyczn&#261;. 
                     Ostatni&#261; instrukcj&#261; tej metody, jest zwr&oacute;cenie rezultatu wywo&#322;ania:
                     
                  </p><pre class="programlisting">
Core::getInstance();                            
            </pre><p>            
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e870"></a>Metoda getInstance()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Klasa <tt class="classname">Core</tt> implementuje wzorzec projektowy - <span class="emphasis"><em>singleton</em></span>.
                        
                     </p>
                     <p>
                        Metoda <tt class="methodname">getInstance()</tt> inicjalizuje klas&#281; <tt class="classname">Core</tt> 
                        je&#380;eli jeszcze nie zosta&#322;a utworzona jej instancja. 
                        
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        W systemie mo&#380;e istnie&#263; tylko jedna instancja klasy <tt class="classname">Core</tt>.                     
                        
                     </div>
                     <p>
                        
                     </p>
                     <p>
                        Dzi&#281;ki metodzie <tt class="methodname">getInstance()</tt>, w ka&#380;dej chwili, z dowolnego punktu aplikacji
                        masz mo&#380;liwo&#347;&#263; uzyskania dost&#281;pu do klasy j&#261;dra i do jej obiekt&oacute;w:
                        
                        
                     </p><pre class="programlisting">

$core = &amp;Core::getInstance();
echo $core-&gt;input-&gt;getIp(); // wy&#347;wietla IP
                    
                </pre><p>
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e903"></a>Korzystanie ze sk&#322;adowych aplikacji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Najwa&#380;niejsze bibioteki, potrzebne dla dzia&#322;ania aplikacji &#322;adowane s&#261; w metodzie <tt class="methodname">dispatch()</tt>. Tutaj
                     nast&#281;puje inicjalizacja klasy <tt class="classname">Load</tt>, <tt class="classname">Input</tt>,
                     <tt class="classname">Context</tt> oraz <tt class="classname">Output</tt>.
                     
                  </p>
                  <p>
                     Ka&#380;da biblioteka za&#322;adowana do projektu, z u&#380;yciem metody
                     <tt class="methodname">library()</tt> klasy <tt class="classname">Load</tt>, jest dost&#281;pna
                     poprzez pole klasy Core. Metoda <tt class="methodname">library()</tt> &#322;aduje klas&#281; do projektu (przy pomocy
                     statycznej metody <tt class="methodname">loadClass()</tt>), a nast&#281;pnie tworzy referencj&#281; do tej klasy, jako pole
                     klasy
                     Core:
                     
                  </p><pre class="programlisting">
Core::getInstance()-&gt;$lib_name = &amp;Load::loadClass($lib_name, true, $params);
            </pre><p>
                     
                  </p>
                  <p>
                     Aby
                     odwo&#322;a&#263; si&#281; do elementu j&#261;dra systemu, nale&#380;y u&#380;y&#263; metody <tt class="methodname">getInstance()</tt>, kt&oacute;ra zwraca
                     instancj&#281; klasy <tt class="classname">Core</tt>. Utw&oacute;rz w swoim projekcie przyk&#322;adowy kontroler, a nast&#281;pnie dla
                     test&oacute;w - spr&oacute;buj uruchomi&#263; taki
                     kod:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;library('image');
Core::getInstance()-&gt;image-&gt;open('...'); // prawid&#322;owo
$this-&gt;image-&gt;open('...'); // prawid&#322;owo
            </pre><p>
                     
                  </p>
                  <p>Nasza
                     klasa kontrolera dziedziczy po klasie Controller. &Oacute;w klasa zapewnia nam skr&oacute;towy dost&#281;p
                     do element&oacute;w j&#261;dra st&#261;d mo&#380;emy pomin&#261;c odwo&#322;ywanie si&#281; poprzez metod&#281; <tt class="methodname">getInstance()</tt>.
                     
                  </p>
                  <p>
                     Niezale&#380;nie od ustawie&#324; konfiguracji, z poziomu kontrolera
                     (<tt class="varname">$this</tt>), dost&#281;pne s&#261; biblioteki <tt class="classname">Router</tt>,
                     <tt class="classname">Load</tt>, <tt class="classname">Input</tt>,
                     <tt class="classname">Output</tt>. Pozosta&#322;e klasy s&#261; klasami statycznymi, z kt&oacute;rych mo&#380;na
                     korzysta&#263; w ka&#380;dym miejscu aplikacji (w widokach, modelach czy innych kontrolerach). Np
                     klasa <tt class="classname">Benchmark</tt>:
                     
                     
                  </p><pre class="programlisting">		
Benchmark::start('foo');
// jakies operacje
Benchmark::stop('foo');

echo 'Czas wykonania operacji foo: ' . Benchmark::elapsed('foo') . ' sek.';
            </pre><p>
                     
                  </p>
                  <p>
                     Jak zosta&#322;o pokazane w poprzednich przyk&#322;adach, metoda <tt class="methodname">library()</tt> z
                     klasy <tt class="classname">Load</tt> &#322;aduje bibliotek&#281;, a opr&oacute;cz tego, daje do niej dost&#281;p z
                     poziomu operatora <tt class="varname">$this</tt>:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;library('input');
echo $this-&gt;input-&gt;getIp();
            </pre><p>
                     
                  </p>
                  <p>
                     Inne metody &#322;adowania bibliotek, nie dodaj&#261; odpowiedniego pola do klasy
                     <tt class="classname">Core</tt>, czyli nie s&#261; dost&#281;pne z poziomu operatora
                     <tt class="varname">$this</tt>. Zatrzymajmy si&#281; tutaj na chwil&#281;. Klasa
                     <tt class="classname">Input</tt> jest &#322;adowana w projekcie niezale&#380;nie od tego, czy tego
                     chcemy, czy nie.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1004"></a>Elementy j&#261;dra
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Do element&oacute;w j&#261;dra mo&#380;esz odwo&#322;ywa&#263; si&#281; w ka&#380;dym miejscu aplikacji. Dla przyk&#322;adu:
                     utw&oacute;rzmy nowy helper. Utw&oacute;rz w swoim projekcie katalog <tt class="filename">/helper</tt>, a w
                     nim plik <tt class="filename">ip.helper.php</tt>. Napiszemy w nim funkcj&#281; <tt class="function">ip()</tt>, kt&oacute;ra b&#281;dzie zwraca&#263; adres IP, lecz ka&#380;dy cz&#322;on adresu b&#281;dzie posiada&#322;
                     inny kolor (nie jest to zbyt u&#380;yteczna funkcja, lecz zale&#380;y nam jedynie na
                     zaprezentowaniu idei). 
                     
                  </p>
                  <p>
                     Ca&#322;y plik <tt class="filename">ip.helper.php</tt> mo&#380;e prezentowa&#263; si&#281;
                     nast&#281;puj&#261;co:
                     
                  </p><pre class="programlisting">
&lt;?php
            
function ip()
{
    // pobranie instancji jadra
    $core = &amp;Core::getInstance();
    
    $color = array('silver', 'red', 'green', 'blue');
    $ip = explode('.', $core-&gt;input-&gt;getIp());
    
    foreach ($ip as $k =&gt; $value)
    {
    $ip[$k] = '&lt;span style="color: ' . $color[$k] . '"&gt;' . $value . '&lt;/span&gt;';
    }
    return implode('.', $ip);
}
            
?&gt;
            </pre><p>
                     
                  </p>
                  <p>
                     Najwa&#380;niejsze w tej funkcji jest pobieranie instancji j&#261;dra. Metoda
                     <tt class="methodname">getInstance()</tt> jest metod&#261; statyczn&#261; (na tym polega wzorzec
                     singletonu). Uzyskujemy dzi&#281;ki temu dost&#281;p do biblioteki <tt class="classname">input</tt>, z
                     kt&oacute;rej wykorzystujemy metod&#281; <tt class="methodname">getIp()</tt> do pobrania adresu IP. 
                     
                  </p>
                  <p>
                     W kontrolerze nale&#380;y za&#322;adowa&#263; nasz helper, tak, aby by&#322; dost&#281;pny globalnie, w ca&#322;ej
                     aplikacji:
                     
                  </p><pre class="programlisting">            
// zaladowanie helpera
$this-&gt;load-&gt;helper('ip');

// wyswietlenie widoku
echo $this-&gt;load-&gt;view('foo');
            </pre><p>
                     
                  </p>
                  <p>
                     Helpery s&#261; przewa&#380;nie wykorzystywane w widokach, wi&#281;c nasz widok <tt class="filename">foo.php</tt> mo&#380;e wygl&#261;da&#263;
                     tak:
                     
                  </p><pre class="programlisting">
M&oacute;j IP: &lt;?= ip(); ?&gt;
            </pre><p>
                     
                  </p>
                  <p>
                     Spowoduje to wygenerowanie nast&#281;puj&#261;cego kodu HTML:
                     
                  </p><pre class="programlisting">
M&oacute;j IP: &lt;span style="color: silver"&gt;127&lt;/span&gt;.&lt;span style="color: red"&gt;0&lt;/span&gt;.&lt;span style="color: green"&gt;0&lt;/span&gt;.&lt;span style="color: blue"&gt;1&lt;/span&gt;
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1055"></a>Metoda dispatch()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Statyczna metoda <tt class="methodname">bootstrap()</tt> inicjuje sk&#322;adowe &#347;rodowiska, natomiast
                     metoda <tt class="methodname">dispatch()</tt> inicjalizuje potrzebne biblioteki i 
                     na podstawie adresu URL, przy pomocy klasy <tt class="classname">Router</tt>, kieruje &#380;&#261;danie
                     do klasy <tt class="classname">Dispatcher</tt>.            
                     
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                                           Wywo&#322;anie triggera <span class="emphasis"><em>system.onBeforeSystem</em></span></li>
                        <li>
                                           Utworzenie instancji klasy <tt class="classname">Load</tt> i przyposanie jej do pola klasy 
                                           <tt class="classname">Core</tt>.
                                       
                        </li>
                        <li>
                                           Konstruktor klasy <tt class="classname">Load</tt> &#322;aduje biblioteki: <tt class="classname">Context</tt>,
                                           <tt class="classname">Input</tt>, <tt class="classname">Output</tt> oraz pozosta&#322;e, zadeklarowane
                                           w konfiguracji aplikacji.
                                       
                        </li>
                        <li>
                                           Inicjalizacja klasy <tt class="classname">Router</tt>, kt&oacute;ra na podstawie adresu URL "decyduje",
                                           jaki kontroler oraz akcj&#281;, nale&#380;y wykona&#263;.
                                       
                        </li>
                        <li>
                                           Wywo&#322;anie metody <tt class="methodname">dispatch()</tt> z klasy <tt class="classname">Dispatcher</tt>,
                                           kt&oacute;ra na podstawie informacji uzyskanych klasy routera, wykona kod z odpowiedniego kontrolera.
                                       
                        </li>
                        <li>
                                           Wywo&#322;anie triggera <span class="emphasis"><em>system.onShutdown</em></span></li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e1117"></a>Rozdzia&#322; 6. Klasa Controller
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e1146">Tworzenie w&#322;asnych kontroler&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e1197">Metoda getContext()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1244">Metoda getLibrary()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1274">Metoda getModel()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1285">Metoda getModule()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1290">Metoda getFolder()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1295">Metoda getController()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1306">Metoda getAction()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1320">Metoda getFolder()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1337">Metoda redirect()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1354">Metoda forward()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1387">Metoda getArguments()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1407">Metoda getArgument()</a></span></dt>
                  </dl>
               </div>
               <p>
                  Wszystkie kontrolery w Coyote musz&#261;... no - mo&#380;e nie musz&#261; (bo nie ma takiego wymogu),
                  ale powinny dziedziczy&#263; po klasie <tt class="classname">Controller</tt>. Klasa ta jest klas&#261;
                  abstrakcyjn&#261; i zapewnia kilka ciekawych metod, kt&oacute;re na pewno pomog&#261; w pisaniu w&#322;asnych
                  kontroler&oacute;w. Konstruktor tej klasy wygl&#261;da nast&#281;puj&#261;co:
                  
               </p><pre class="programlisting">
function __construct() 
{
    $this-&gt;router = &amp;Load::loadClass('router');	
    
    $this-&gt;get = &amp;$this-&gt;input-&gt;get;
    $this-&gt;post = &amp;$this-&gt;input-&gt;post;
    $this-&gt;cookie = &amp;$this-&gt;input-&gt;cookie;
    $this-&gt;server = &amp;$this-&gt;input-&gt;server;
}       
        </pre><p>
                  
                  Konstruktor
                  tej klasy inicjalizuje kilka p&oacute;l dzi&#281;ki czemu daje nam &#322;atwy dost&#281;p to paru sk&#322;adowych
                  systemu. Przede wszystkim do element&oacute;w klasy <tt class="classname">Get</tt>,
                  <tt class="classname">Post</tt>, <tt class="classname">Cookie</tt> czy
                  <tt class="classname">Server</tt>. Jak widzisz, tworzona jest referencja do tych obiekt&oacute;w wiec
                  mo&#380;liwe jest u&#380;ycie podw&oacute;jnego zapisu w naszmy
                  kontrolerze:
                  
                  
               </p><pre class="programlisting">
echo $this-&gt;input-&gt;get-&gt;id; // odczyt $_GET['id']
echo $this-&gt;get-&gt;id; // j/w
        </pre><p>
                  
                  
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>
                  Kontrolery to dobre miejsca na umieszczenie ca&#322;ej "logiki" aplikacji. W akcjach (metodach) kontroler&oacute;w
                  mo&#380;esz umieszcza&#263; kod, kt&oacute;ry b&#281;dzie w stanie generowa&#263; stron&#281; WWW (lub inne dane), przy pomocy
                  modeli, bibliotek, helper&oacute;w.
                  
               </div>
               <p>
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1146"></a>Tworzenie w&#322;asnych kontroler&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Kontrolery to pliki, kt&oacute;re maj&#261; posta&#263; klas PHP. Pliki te powinny by&#263; umieszczone w katalogu
                     <tt class="filename">/controller</tt>, twojego projektu. Nazwa klasy kontrolera powinna odpowiada&#263;
                     nazwie pliku. Oznacza to, &#380;e je&#380;eli tworzymy kontroler o nazwie <span class="emphasis"><em>Foo</em></span>,
                     to klasa <tt class="classname">Foo</tt> (ewentualnie <tt class="classname">Foo_Controller</tt> - taki zapis
                     te&#380; jest mo&#380;liwy), powinna znajdowa&#263; si&#281; w pliku <tt class="filename">foo.php</tt>, w katalogu
                     <tt class="filename">/controller</tt>. Dodatkowo klasa <tt class="classname">Foo</tt> lub 
                     <tt class="classname">Foo_Controller</tt> powinna dziedziczy&#263; po klasie <tt class="classname">Controller</tt>.
                     
                  </p>
                  <p>
                     Kontrolery mog&#261; posiada&#263; metody, kt&oacute;re jednocze&#347;nie s&#261; <span class="emphasis"><em>akcjami</em></span>. 
                     Domy&#347;lnie, pierwszy cz&#322;on adresu URL oznacza nazw&#281; kontrolera, a drugi - akcj&#281;.
                     
                  </p>
                  <p>
                     Innymi s&#322;owy, adres URL http://localhost/demo/Foo/Bar spowoduje wywo&#322;anie akcji <span class="emphasis"><em>Bar</em></span>
                     z kontrolera <span class="emphasis"><em>Foo</em></span>. 
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Zaawansowane przypisywanie masek adres&oacute;w do poszczeg&oacute;lnych kontroler&oacute;w mo&#380;liwe jest przy u&#380;yciu
                     klasy <tt class="classname">Router</tt>.
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1197"></a>Metoda getContext()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda <tt class="methodname">getContext()</tt> zapewnia dam dost&#281;p do element&oacute;w
                     sk&#322;adowych z poziomu kontrolera. Jest to instrukcja r&oacute;wnowa&#380;na do
                     <tt class="methodname">Core::getInstance()</tt>:
                     
                     
                  </p><pre class="programlisting">
echo $this-&gt;getContext()-&gt;input-&gt;getIp();
echo Core::getInstance()-&gt;input-&gt;getIp(); 
            </pre><p>
                     
                  </p>
                  <p>
                     Jednak, aby jeszcze &#322;atwiej u&#322;atwi&#263; programi&#347;cie prac&#281; z frameworkiem, jedn&#261; z metod
                     klasy <tt class="classname">Controller</tt>
                     jest:
                     
                  </p><pre class="programlisting">
public function __get($name)
{
        return $this-&gt;getContext()-&gt;$name;
}
            </pre><p>
                     
                  </p>
                  <p>
                     Dzi&#281;ki tej magicznej metodzie, z poziomu ka&#380;dego kontrolera (ka&#380;dego dziedzicz&#261;cego po klasie 
                     <tt class="classname">Controller</tt>) mo&#380;liwy jest dost&#281;p do element&oacute;w sk&#322;adowych j&#261;dra, czyli
                     bibliotek:
                     
                     
                  </p><pre class="programlisting">

&lt;?php

class Bar extends Controller
{
	public function foo()
	{
		/**
		 * Dost&#281;p do metody getIp() klasy Input
		 */
		echo $this-&gt;input-&gt;getIp(); 

		/**
		 * R&oacute;wnowa&#380;ny zapis
		 */
		echo $this-&gt;getContext()-&gt;input-&gt;getIp(); 

		/**
		 * R&oacute;wnowa&#380;ny zapis
		 */
		echo Core::getInstance()-&gt;input-&gt;getIp();
	}
}
?&gt;
                
            </pre><p>
                     
                     W tym przyk&#322;adzie uzyskujemy prosty dost&#281;p do metody <tt class="methodname">getIp()</tt>
                     z klasy <tt class="classname">Input</tt>.            
                     
                  </p>
                  <p>
                     R&oacute;wnie dobrze, mogliby&#347;my utworzy&#263; instancj&#281; klasy <tt class="classname">Input</tt> i wywo&#322;a&#263;
                     metod&#281; <tt class="methodname">getIp()</tt>, ale po co, skoro odpowiednia instancja tej
                     klasy istnieje ju&#380; w systemie:
                     
                     
                  </p><pre class="programlisting">
/**
* Niepotrzebne utworzenie kolejnej instancji klasy...
*/
$input = new Input;
echo $input-&gt;getIp();                
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1244"></a>Metoda getLibrary()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Na starcie aplikacji, tylko niekt&oacute;re, najpotrzebniejsze biblioteki s&#261; &#322;adowane do j&#261;dra
                     systemu. Oczywistym jest, &#380;e nie wszystkie biblioteki musz&#261; by&#263; za&#322;adowane do aplikacji, 
                     je&#380;eli nie s&#261; wykorzystywane. Ma to zwi&#261;zek z wydajno&#347;ci&#261; aplikacji (niepotrzebne marnowanie zasob&oacute;w).
                     
                  </p>
                  <p>
                     W ka&#380;dej chwili mo&#380;esz jednak z dowolnego miejsca w aplikacji (kontroler, widok, model) za&#322;adowa&#263;
                     potrzebn&#261; w danej chwili bibliotek&#281;. Jest na to kilka sposob&oacute;w. W kontrolerze, masz dost&#281;p do
                     metody <tt class="methodname">getLibrary()</tt>, pierwotnie zadeklarowanej w klasie <tt class="classname">Controller</tt>.
                     
                  </p>
                  <p>
                     Metoda realizuje za&#322;adowanie biblioteki do projektu, a nast&#281;pnie - zwr&oacute;cenie jej
                     referencji. Identyczny efekt da u&#380;ycie metody <tt class="methodname">library()</tt> z
                     loadera: 
                     
                     
                  </p><pre class="programlisting">
$foo = &amp;$this-&gt;load-&gt;library('foo');
$foo = &amp;$this-&gt;getLibrary('foo');
            </pre><p>
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Pami&#281;taj, &#380;e metoda <tt class="methodname">getLibrary()</tt> dost&#281;pna jest jedynie w klasach kontroler&oacute;w
                     dziedzicz&#261;cych po klasie <tt class="classname">Controller</tt>.
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1274"></a>Metoda getModel()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda realizuje za&#322;adowanie modelu, a nast&#281;pnie - zwr&oacute;cenie jego referencji.
                     Identyczny efekt da u&#380;ycie metody <tt class="methodname">model()</tt> z klasy
                     loadera:
                     
                     
                  </p><pre class="programlisting">
 $foo = &amp;$this-&gt;load-&gt;model('foo');
$foo = &amp;$this-&gt;getModel('foo');
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1285"></a>Metoda getModule()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda zwraca nazw&#281; ewentualnego modu&#322;u. Poniewa&#380; Coyote obs&#322;uguje modu&#322;y, kt&oacute;re
                     r&oacute;wnie&#380; mog&#261; zawiera&#263; kontrolery. Dzi&#281;ki tej metodzie z poziomu kontrolera mo&#380;emy
                     sprawdzi&#263;, z jakiego modu&#322;u pochodzi uruchomiony kontroler. 
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1290"></a>Metoda getFolder()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda zwraca nazw&#281; ewentualnego podkatalogu, w kt&oacute;rym znajduje si&#281; kontroler, gdy&#380;
                     Coyote umo&#380;liwia gromadzenie kontroler&oacute;w w podkatalogach. 
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1295"></a>Metoda getController()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> 
                     Metoda zwraca nazw&#281; aktualnego kontrolera. Nie jest zwracana nazwa klasy, a jedynie
                     nazwa kontrolera:
                     
                     
                  </p><pre class="programlisting">

class Foo_Controller extends Controller
{
    public function main()
    {
        echo $this-&gt;getController(); // wy&#347;wietli: foo
    }
}

            </pre><p>
                     
                     Mo&#380;emy u&#380;y&#263; skr&oacute;towego zapisu:
                  </p><pre class="programlisting">echo $this;</pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1306"></a>Metoda getAction()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda zwraca nazw&#281; akcji. Ta nazwa pobierana jest z klasy
                     <tt class="classname">Router</tt>. Tak wi&#281;c niewa&#380;ne z kt&oacute;rej metody kontrolera jest
                     wywo&#322;ywana ta metoda - zawsze zwr&oacute;ci nazw&#281; akcji pobran&#261; z klasy
                     <tt class="classname">Router</tt>:
                     
                     
                  </p><pre class="programlisting">
&lt;?php

class Page_Controller extends Controller
{
	function main()
	{
		$this-&gt;foo();		
	}

	private function foo()
	{
		echo $this-&gt;getAction(); // zwr&oacute;ci main
	}
}
?&gt;
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1320"></a>Metoda getFolder()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Pliki kontroler&oacute;w mog&#261; by&#263; grupowane w podkatalogach, w folderze <tt class="filename">/controller</tt>.
                     Metoda <tt class="methodname">getFolder()</tt> zwraca w rzeczywisto&#347;ci rezultat wykonania metody
                     <tt class="methodname">getFolder()</tt> z klasy <tt class="classname">Router</tt>, czyli nazw&#281; ewentualnego
                     podkatalogu danego kontrolera.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1337"></a>Metoda redirect()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> 
                     Umo&#380;liwia przekierowanie na wybrany adres WWW. Nale&#380;y mie&#263; na uwadze, iz po wywo&#322;aniu
                     tej metody, dalszy kod akcji nie b&#281;dzie
                     wykonywany:
                     
                  </p><pre class="programlisting">&lt;?php

class Page_Controller extends Controller
{
	function main()
	{
		$this-&gt;redirect('http://4programmers.net');
		$this-&gt;foo(); // ta instrukcja nie zostanie wykonana		
	}

	private function foo()
	{
		///
	}
}
?&gt;
            </pre><p>
                     
                     Parametrem metody <tt class="methodname">redirect()</tt> mo&#380;e by&#263; adres URL, nazwa regu&#322;y routingu lub
                     &#347;cie&#380;ka do  kontrolera:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;redirect('User/View'); // przekierowuje do http://serwer.com/User/View
$this-&gt;redirect('@user'); // przekieruje na adres okreslony regu&#322;&#261; @user
            </pre><p>
                     
                     Metoda posiada jeszcze jeden, opcjonalny parametr, kt&oacute;ry okre&#347;la&#263; b&#281;dzie kod przekierowania
                     (dodawany w nag&#322;&oacute;wku wysy&#322;anym do
                     przegl&#261;darki):
                     
                  </p><pre class="programlisting">
$this-&gt;redirect('User/View', 301); // kod 301 - Moved Permanently
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1354"></a>Metoda forward()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Czasem (zapewne niecz&#281;sto) mo&#380;e okaza&#263; si&#281; przydatne "przeskoczenie" do innego
                     kontrolera oraz akcji. Metoda <tt class="methodname">forward()</tt> wywo&#322;uje jedynie metod&#281;
                     <tt class="methodname">dispatch()</tt> z klasy <tt class="classname">Dispatcher</tt> wi&#281;c od
                     Ciebie zale&#380;y, jakiego sposobu u&#380;yjesz. Nag&#322;&oacute;wek metody jest
                     nast&#281;puj&#261;cy:
                     
                  </p><pre class="programlisting">
public function forward($controller, $action, $folder = '')
            </pre><p>
                     
                  </p>
                  <p>
                     Pierwszym parametrem jest nazwa kontrolera - drugim - nazwa akcji, a ostatnim - jak
                     nietrudno si&#281; domy&#347;le&#263; - nazwa ewentualnego podkatalogu, w kt&oacute;rym znajduje si&#281;
                     kontroler. Przyk&#322;adowy
                     kod:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;forward('foo', 'main', 'test');	
            </pre><p>
                     
                  </p>
                  <p>
                     Spowoduje wywo&#322;anie kontrolera akcji <tt class="methodname">main</tt>, z kontrolera
                     <tt class="classname">foo</tt> (<tt class="filename">controller/test/foo.php</tt>).
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1387"></a>Metoda getArguments()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda zwraca tablic&#281; parametr&oacute;w przekazanych w adreie URL. Za&#322;&oacute;&#380;my, &#380;e u&#380;ytkownik
                     &#380;&#261;da wczytania kontrolera, kt&oacute;ry kryje si&#281; pod adresem http://127.0.0.1/Foo/Main/1/2.
                     Klasa <tt class="classname">Router</tt> intepretuje taki URL i mo&#380;e stwierdzi&#263;, iz
                     <tt class="classname">Foo</tt> to nazwa kontrolera, <tt class="methodname">Main</tt> -
                     nazwa akcji, a pozosta&#322;e warto&#347;ci to parametry. Te warto&#347;ci zostan&#261; zwr&oacute;cone przez
                     metod&#281; <tt class="methodname">getArguments()</tt>. 
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Metoda zwraca tablic&#281; danych, indeksowan&#261; od zera.
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1407"></a>Metoda getArgument()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda <tt class="methodname">getArgument()</tt> umo&#380;liwia odczytanie warto&#347;ci danego argumentu.                        
                     
                  </p>
                  <p>
                     Dzia&#322;anie jest bardzo podobne do metody <tt class="methodname">getArguments()</tt>, z tym, &#380;e 
                     ta druga zwraca tablic&#281; element&oacute;w:
                     
                     
                  </p><pre class="programlisting">

$args = $this-&gt;getArguments();
echo $args[0];
// to samo co:
echo $this-&gt;getArgument(0);
                
            </pre><p>
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e1423"></a>Rozdzia&#322; 7. Biblioteki
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e1490">Metoda statyczne loadera</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1520">Przekazywanie parametr&oacute;w do konstruktora</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e1528">Konwencje w nazewnictwie</a></span></dt>
                     <dt><span class="section"><a href="#d0e1545">Dziedziczenie</a></span></dt>
                     <dt><span class="section"><a href="#d0e1567">Zast&#281;powanie bibliotek j&#261;dra</a></span></dt>
                     <dt><span class="section"><a href="#d0e1578">Metoda initialize()</a></span></dt>
                     <dt><span class="section"><a href="#d0e1583">Dziedziczenie po klasie Context</a></span></dt>
                  </dl>
               </div>
               <p>
                  Biblioteki w Coyote maj&#261; posta&#263; zwyk&#322;ych klas. Mog&#261; one zosta&#263; u&#380;yte w ka&#380;dym miejscu
                  aplikacji w momencie, gdy ich potrzebujemy. W Coyote biblioteki znajduj&#261; si&#281; w katalogu
                  <tt class="filename">lib</tt>. Nic nie stoi na przeszkodzie, aby&#347; umie&#347;ci&#322; swoje biblioteki,
                  w&#322;a&#347;nie w katalogu <tt class="filename">lib</tt> swojego projektu. Mo&#380;esz np. potrzebowa&#263; w
                  swojej aplikacji biblioteki usuwaj&#261;cej wszystkie niepotrzebne znaczniki HTML z &#322;a&#324;cucha.
                  Tak&#261; bibliotek&#281; mo&#380;esz wykorzysta&#263; w ka&#380;dym miejscu swojej aplikacji. Przeprowad&#378;my prosty
                  eksperyment. Utw&oacute;rz w katalogu swojej aplikacji folder <tt class="filename">lib</tt>. W katalogu
                  tym umie&#347;&#263; plik <tt class="filename">foo.class.php</tt>, kt&oacute;ry b&#281;dzie nasz&#261; bibliotek&#261;.
                  
                  Biblioteki musz&#261; posiada&#263; sufiks .<span class="emphasis"><em>class.php</em></span>. Kod naszej biblioteki mo&#380;e
                  wygl&#261;da&#263;
                  tak:
                  
               </p><pre class="programlisting">
&lt;?php

class Foo
{
    public function bar()
    {
        echo 'Metoda bar() z biblioteki Foo';
    }
}
?&gt;
        </pre><p>
                  
               </p>
               <p>
                  Biblioteki mo&#380;emy wykorzystywa&#263; w ka&#380;dym miejscu aplikacji - w innych bibliotekach lub
                  kontrolerach. Np. w ten spos&oacute;b:
                  
               </p><pre class="programlisting">
$foo = new Foo;
$foo-&gt;bar();
        </pre><p>
                  
               </p>
               <p>
                  Tworzymy obiekt klasy <tt class="classname">Foo</tt>, a nast&#281;pnie wywo&#322;ujemy metod&#281;
                  <tt class="methodname">bar()</tt>. Plik PHP z klas&#261; <tt class="classname">Foo</tt> jest &#322;adowany przez loader, kt&oacute;ry
                  poszukuje pliku <tt class="filename">foo.class.php</tt> w katalogu <tt class="filename">lib</tt>. 
                  
               </p>
               <p>
                  Jest to jeden ze sposob&oacute;w za&#322;adowania biblioteki w programie. Tworzymy tutaj nowy obiekt
                  klasy, ale nie zawsze jest to po&#380;&#261;dane. Ba, by&#263; mo&#380;e musisz wykorzysta&#263; obiekt klasy
                  <tt class="classname">Foo</tt> w wielu miejscach aplikacji (w kontrolerze oraz w innej
                  bibliotece). Mo&#380;e zaistnie&#263; sytuacja, w kt&oacute;rej nie chcemy tworzy&#263; kilku instancji tej samej
                  klasy. Tutaj, z pomoc&#261; przychodzi loader, kt&oacute;ry przechowuje referencj&#281; do instancji klasy.
                  Mo&#380;esz j&#261; uzyska&#263; dzi&#281;ki statycznej metodzie
                  <tt class="methodname">loadClass()</tt>:
                  
                  
               </p><pre class="programlisting">
$foo = &amp;Load::loadClass('foo');
$foo-&gt;bar();

// inne operacje
// ponowne uzycie biblioteki
$foo = &amp;load::loadClass('foo');
$foo-&gt;bar();
        </pre><p>
                  
               </p>
               <p>
                  W takim kodzie, nast&#261;pi podw&oacute;jne u&#380;ycie metody <tt class="methodname">bar()</tt> jednak&#380;e z
                  tej samej instancji klasy <tt class="classname">Foo</tt>. Innymi s&#322;owy nie s&#261; tworzone dwie
                  instancje klasy <tt class="classname">Foo</tt>.
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1490"></a>Metoda statyczne loadera
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Klasa loadera (<tt class="classname">Load</tt>) posiada u&#380;yteczn&#261;, statyczn&#261; metod&#281;
                     <tt class="methodname">loadClass()</tt>. Umo&#380;liwia za&#322;adowania i utworzenie instancji
                     klasy lub - za&#322;adowanie klasy statycznej. Poni&#380;sze instrukcje s&#261;
                     r&oacute;wnowa&#380;ne:
                     
                  </p><pre class="programlisting">
$foo = &amp;$this-&gt;load-&gt;library('foo');
$foo1 = &amp;Load::loadClass('foo');
$foo2 = new Foo;
            </pre><p>
                     
                  </p>
                  <p>
                     Metoda <tt class="methodname">library()</tt>, podobnie jak statyczna metoda
                     <tt class="methodname">loadClass()</tt> nie tworzy kolejnej instancji klasy je&#380;eli ta
                     zosta&#322;a ju&#380; utworzona. Zapobiera r&oacute;wnie&#380; ponownemu wczytaniu danego pliku do projektu. 
                     
                  </p>
                  <p>
                     Metoda <tt class="methodname">loadClass()</tt> posiada dwa kolejne (opcjonalne)
                     parametry. Pierwszy z nich okre&#347;la, czy tworzona ma by&#263; instancja danej klasy (domy&#347;lnie
                     true - jest tworzona); drugi - przekazuje parametry do konstruktora klasy je&#380;eli
                     tworzona jest jego instancja. Przeanalizuj nast&#281;puj&#261;cy
                     przyk&#322;ad:
                     
                     
                  </p><pre class="programlisting">
Load::loadClass('user', false);
User::load(); // u&#380;ycie statycznej metody z klasy User - nie zosta&#322;a utworzona jej instancja
$this-&gt;user-&gt;load(); // b&#322;ad! Nie istnieje instancja klasy User
            </pre><p>
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e1520"></a>Przekazywanie parametr&oacute;w do konstruktora
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p> 
                        Niekiedy konieczne jest przekazanie do konstruktora metody dodatkowych
                        parametr&oacute;w. Mo&#380;na to zrobi&#263; w prosty spos&oacute;b wywo&#322;uj&#261;c jawnie konstruktor
                        klasy:
                        
                     </p><pre class="programlisting">
$foo = new Foo('bar', 1); 
// lub:
Load::loadClass('foo', true, array('bar', 1));
                </pre><p>
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1528"></a>Konwencje w nazewnictwie
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Pliki bibliotek musz&#261; mie&#263; ko&#324;c&oacute;wk&#281; (sufiks) <tt class="filename">class.php</tt>, np.
                     <tt class="filename">foo.class.php</tt>. Oczywi&#347;cie nazwa klasy musi odpowiada&#263; nazwie
                     pliku, w kt&oacute;rym si&#281; znajduje. Tak wi&#281;c w pliku <tt class="filename">foo.class.php</tt> musimy
                     mie&#263; klas&#281; <tt class="classname">Foo</tt>. Nazwa klasy mo&#380;e by&#263; pisana wielkimi/ma&#322;ymi
                     literami. Generalnie nie ma to znaczenia. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1545"></a>Dziedziczenie
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Poniewa&#380; biblioteki w Coyote to zwyk&#322;e klasy, mo&#380;esz z powodzeniem po nich
                     dziedziczy&#263;. Przk&#322;adowo, je&#380;eli chcesz rozbudowa&#263; istniej&#261;c&#261; w Coyote bibliotek&#281;
                     <tt class="classname">email</tt>, mo&#380;esz to zrobi&#263; w nast&#281;puj&#261;cy spos&oacute;b: umie&#347;&#263; w swojej
                     aplikacji, w folderze <tt class="filename">lib</tt>, plik
                     <tt class="filename">my_email.class.php</tt>. Plik powinien zawiera&#263; deklaracj&#281;
                     klasy:
                     
                  </p><pre class="programlisting">
&lt;?php

class My_Class extends Email
{
    function __construct()
    {
        parent::__construct();
    }
}
?&gt;
            </pre><p>
                     
                  </p>
                  <p>
                     W tym momencie mo&#380;esz rozbudowa&#263; swoj&#261; w&#322;asn&#261; klas&#281; <tt class="classname">My_Class</tt>.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1567"></a>Zast&#281;powanie bibliotek j&#261;dra
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Pliki swojego projektu mo&#380;esz trzyma&#263;
                     oddzielnie od plik&oacute;w frameworka. By&#322;a o tym mowa w rozdziale <span class="emphasis"><em>Tworzenie folderu
                           aplikacji</em></span>. Je&#380;eli chcemy za&#322;adowa&#263; bibliotek&#281; - dajmy na to - foo, system
                     poszukuje je najpierw w katalogu projektu, a dopiero p&oacute;zniej - w katalogu frameworka.
                     Oznacza to, &#380;e w swoim projekcie, mo&#380;esz zast&#261;pi&#263; istniej&#261;ce klasy. Innymi s&#322;owy, je&#380;eli nie
                     odpowiada Ci obecna forma biblioteki email, mo&#380;esz utworzy&#263; w&#322;asn&#261; i umie&#347;ci&#263; j&#261; w katalogu
                     /lib, swojego projektu. Instrukcja <span><b class="command">$this-&gt;load-&gt;library('email');</b></span>
                     spowoduje za&#322;adowanie Twojej klasy email. 
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1578"></a>Metoda initialize()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>(PUSTO)</p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1583"></a>Dziedziczenie po klasie Context
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>(PUSTO)</p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e1588"></a>Rozdzia&#322; 8. Helpery
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e1692">Pisanie w&#322;asnych helper&oacute;w</a></span></dt>
                  </dl>
               </div>
               <p>
                  Helpery to pliki PHP zawieraj&#261;ce funkcje lub
                  klasy, kt&oacute;re mog&#261; by&#263; przydatne na etapie projektowania aplikacji. Coyote zawiera kilka
                  helper&oacute;w, kt&oacute;re mo&#380;esz u&#380;y&#263; w swojej aplikacji:
                  
                  
               </p>
               <div class="table"><a name="d0e1593"></a><p class="title"><b>Tabela 8.1. Helpery w Coyote</b></p>
                  <table summary="Helpery w Coyote" border="0">
                     <colgroup>
                        <col>
                        <col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th>Nazwa pliku helpera</th>
                           <th>Opis</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td>system.helper.php</td>
                           <td>Zawiera funkcje systemowe, przydatne w widokach</td>
                        </tr>
                        <tr>
                           <td>url.helper.php</td>
                           <td>Zawiera funkcje url() oraz klas&#281; Url</td>
                        </tr>
                        <tr>
                           <td>html.helper.php</td>
                           <td>Zawiera klas&#281; HTML u&#322;atwiaj&#261;c&#261; tworzenie znacznik&oacute;w HTML</td>
                        </tr>
                        <tr>
                           <td>form.helper.php</td>
                           <td>Zawiera klas&#281; s&#322;u&#380;&#261;c&#261; do tworzenia formularzy HTML</td>
                        </tr>
                        <tr>
                           <td>box.helper.php</td>
                           <td>Zawiera klas&#281; Box umo&#380;liwiaj&#261;c&#261; tworzenie komunikat&oacute;w informacyjnych</td>
                        </tr>
                        <tr>
                           <td>array.helper.php</td>
                           <td>Zawiera funkcje do operowania na tablicach.</td>
                        </tr>
                        <tr>
                           <td>text.helper.php</td>
                           <td>Zawiera klas&#281; Text s&#322;u&#380;&#261;c&#261; do operowaniu na tek&#347;cie</td>
                        </tr>
                        <tr>
                           <td>time.helper.php</td>
                           <td>Zawiera klas&#281; Time s&#322;u&#380;&#261;c&#261; do operacji na datach</td>
                        </tr>
                        <tr>
                           <td>sort.helper.php</td>
                           <td>Klasa Sort umo&#380;liwia tworzenie link&oacute;w sortuj&#261;cych tabele</td>
                        </tr>
                        <tr>
                           <td>sql.helper.php</td>
                           <td>Klasa SQL umo&#380;liwiaj&#261;ca wykonanie instrukcji SQL znajduj&#261;cych si&#281; w
                              zewn&#281;trznym pliku
                           </td>
                        </tr>
                        <tr>
                           <td>breadcrumb.helper.php</td>
                           <td>Klasa umo&#380;liwiaj&#261;ca tworzenie mechanizmu breadcrumb</td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>
                  
                  
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>
                  Pliki helper&oacute;w musz&#261; znajdowa&#263; si&#281; w katalogu <tt class="filename">/helper</tt> projektu.
                  
               </div>
               <p>
                  
               </p>
               <p>
                  Helpery mog&#261; by&#263; &#322;adowane automatycznie (wi&#281;cej informacji na ten temat
                  znajdziesz w rozdziale Konfiguracja projektu) lub jawnie w trakcie dzia&#322;ania aplikacji. Do
                  tego celu nale&#380;y wykorzysta&#263; metod&#281; <tt class="classname">helper()</tt> z klasy
                  <tt class="classname">load</tt>:
                  
                  
               </p><pre class="programlisting">
$this-&gt;load-&gt;helper('box');
Box::information('Informacja', 'Hello World!');
        </pre><p>
                  
               </p>
               <p>
                  Jak
                  widzisz, helpery wykorzystuje si&#281; podobnie jak biblioteki. Raz za&#322;adowany helper w&#322;&#261;cza do
                  projektu funkcje lub klasy, kt&oacute;re mog&#261; by&#263; wykorzystywane w obr&#281;bie ca&#322;ego projektu.
                  
               </p>
               <p>
                  Oczywi&#347;cie mo&#380;esz pisa&#263; w&#322;asne helpery i w&#322;&#261;cza&#263; je do projektu. Zasada
                  dzia&#322;ania jest podobna jak w przypadku bibliotek. Nazwy plik&oacute;w helper&oacute;w musz&#261; mie&#263; form&#281;
                  <tt class="filename">xxx.helper.php</tt>, np. <tt class="filename">foo.helper.php</tt> i musz&#261; znajdowa&#263;
                  si&#281; w katalogu <tt class="filename">/helper</tt> projektu. 
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1692"></a>Pisanie w&#322;asnych helper&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Tworzenie w&#322;asnych helper&oacute;w jest bajecznie proste. Zak&#322;adaj&#261;c, &#380;e w swoim projekcie posiadasz
                     katalog <tt class="filename">/helper</tt>, utw&oacute;rz w nim plik <tt class="filename">foo.helper.php</tt>. 
                     
                  </p>
                  <p>
                     Helpery mog&#261; zawiera&#263; zar&oacute;wno funkcje jak i klasy. Zalecanym rozwi&#261;zaniem jest grupowanie w metody
                     klasy. Dzi&#281;ki temu, nie ma konieczno&#347;ci jawnego za&#322;adowania  helpera do projektu - zostanie on 
                     za&#322;adowany w momencie, gdy zajdzie taka konieczno&#347;&#263;.
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     W rzeczywisto&#347;ci za&#322;adowaniem helpera zajmuje si&#281; klasa loadera.
                     
                  </div>
                  <p>
                     
                  </p>
                  <p>
                     Przyk&#322;adowy helper mo&#380;e mie&#263; nast&#281;puj&#261;c&#261; posta&#263;:
                     
                  </p><pre class="programlisting">

&lt;?php

class Foo
{
    public static function fooBar()
    {
        echo 'Hello from helper Foo';
    }
}

            </pre><p>
                     
                     Teraz, w dowolnym miejscu projektu, czy to w kontrolerze, czy w widoku, mo&#380;esz u&#380;y&#263; helpera:
                     
                     
                  </p><pre class="programlisting">

Foo::fooBar();
                
            </pre><p>
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Zauwa&#380;, &#380;e metoda <tt class="methodname">fooBar</tt> jest metod&#261; statyczn&#261;!
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e1722"></a>Rozdzia&#322; 9. Modele
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e1781">Pobieranie danych z modelu, w widoku</a></span></dt>
                  </dl>
               </div>
               <p>
                  Modele s&#322;u&#380;&#261; do operowania na danych. W Coyote maj&#261; posta&#263; normalnych klas,
                  umieszczonych w katalogu <tt class="filename">/model</tt>. Klasy modelu musz&#261; spe&#322;nia&#263; pewne
                  wymogi:
                  
               </p>
               <div class="itemizedlist">
                  <ul type="disc">
                     <li>Nazwa klasy musi posiada&#263; ko&#324;c&oacute;wk&#281; _Model.</li>
                     <li>Plik modelu musi posiada&#263; kon&oacute;wk&#281; .model.php.</li>
                     <li>Model musi dziedziczy&#263; po klasie Model. </li>
                  </ul>
               </div>
               <p>
                  W swoim projekcie utw&oacute;rz katalog <tt class="filename">/model</tt>, a w nim plik
                  <tt class="filename">foo.model.php</tt>. Niech nasza przyk&#322;adowa klasa modelu posiada tak&#261;
                  posta&#263;:
                  
               </p><pre class="programlisting">
&lt;?php

class Foo_Model extends Model
{
    const VERSION = '1.0';
    
    public function getVersion()
    {
        return self::VERSION;
    }
}

?&gt;
        </pre><p>
                  
               </p>
               <p>
                  Model mo&#380;e zosta&#263; za&#322;adowany dzi&#281;ki metodzie <tt class="methodname">model()</tt> z klasy
                  loadera (<tt class="classname">Load</tt>). W naszym przyk&#322;adowy kontrolerze mo&#380;emy wi&#281;c utworzy&#263;
                  taki kod:
                  
               </p><pre class="programlisting">
&lt;?php

class Index_Controller extends Controller 
{
    function main()
    {
        $foo = &amp;$this-&gt;load-&gt;model('foo');
        // wyswietlenei wersji (pobranie danych z modelu)
        echo $foo-&gt;getVersion();
    }
}
?&gt;
        </pre><p>
                  
               </p>
               <p>
                  Jak widzisz, w parametrze metody <tt class="methodname">model()</tt> podajemy jedynie nazw&#281;
                  modelu (bez ko&#324;c&oacute;wki <span class="emphasis"><em>_Model</em></span>). Metoda <tt class="methodname">model()</tt>
                  zwraca referencj&#281; do obiektu klasy. Od tej pory mo&#380;emy wykorzysta&#263; obecne w nim metody. Oto
                  r&oacute;wnowa&#380;ne u&#380;ycie
                  modelu:
                  
               </p><pre class="programlisting">
$this-&gt;load-&gt;model('foo');
// wyswietlenei wersji (pobranie danych z modelu)
echo $this-&gt;model-&gt;foo-&gt;getVersion();
        </pre><p>
                  
               </p>
               <p>
                  Teraz model <tt class="classname">foo</tt> mo&#380;e by&#263; wykorzystywany w wielu miejscach w
                  projekcie. Kontrolera nie interesuje sk&#261;d pochodz&#261; dane. Model mo&#380;e je odczytywa&#263; z bazy
                  danych, pliku XML itp. Model mo&#380;e dostarcza&#263; np. informacje o u&#380;ytkowniku pobierane z bazy
                  danych. W odpowiednim miejscu (czy to strona g&#322;&oacute;wna naszej strony WWW, czy panel
                  administracyjny dost&#281;pny tylko dla administrator&oacute;w) &#322;adujemy odpowiedni model, a nast&#281;pnie -
                  wywo&#322;ujemy odpowiedni&#261; metod&#281;, kt&oacute;ra dostarcza nam informacje o u&#380;ytkowniku. 
                  
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>
                  Aby wczyta&#263; model do projektu, mo&#380;na wykorzysta&#263; metod&#281; getModel(), kt&oacute;ra zadeklarowana jest w
                  klasie Controller. Jest r&oacute;wnie&#380; dostepna w kontrolerach, ktore dziedzicz&#261; po tej klasie.
                  
               </div>
               <p>
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1781"></a>Pobieranie danych z modelu, w widoku
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Dane dostarczane przez model mog&#261; by&#263; wykorzystywane bezpo&#347;rednio w widoku - z
                     pomini&#281;ciem warstwy kontrolera:
                     
                  </p><pre class="programlisting">
&lt;!-- w widoku (kod HTML): --&gt;
Wersja: &lt;b&gt;&lt;?= $model-&gt;foo-&gt;getVersion(); ?&gt;&lt;/b&gt;
            </pre><p>
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e1790"></a>Rozdzia&#322; 10. Konfiguracja projektu
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e1803">&#321;adowanie pliku konfiguracji do projektu</a></span></dt>
                     <dt><span class="section"><a href="#d0e1837">Automatyczne &#322;adowanie pliku konfiguracji</a></span></dt>
                     <dt><span class="section"><a href="#d0e1869">Wy&#347;wietlanie zawarto&#347;ci konfiguracji</a></span></dt>
                     <dt><span class="section"><a href="#d0e1892">Ustawianie warto&#347;ci konfiguracyjnych</a></span></dt>
                     <dt><span class="section"><a href="#d0e1937">Przestrzenie nazw</a></span></dt>
                     <dt><span class="section"><a href="#d0e1971">Podzia&#322; pliku konfiguracji</a></span></dt>
                     <dt><span class="section"><a href="#d0e1989">Adaptery</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e1994">Adapter XML</a></span></dt>
                           <dt><span class="section"><a href="#d0e2014">Adapter PHP</a></span></dt>
                           <dt><span class="section"><a href="#d0e2026">Adapter INI</a></span></dt>
                           <dt><span class="section"><a href="#d0e2050">W&#322;asny adapter</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e2105">Cache konfiguracji</a></span></dt>
                     <dt><span class="section"><a href="#d0e2125">Automatyczne &#322;adowanie zasob&oacute;w</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2140">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p> W niemal ka&#380;dej aplikacji wykorzystuj&#261;cej framework, potrzebna jest konfiguracja, kt&oacute;ra
                  na sta&#322;e zapisana jest na serwerze. Konfiguracja mo&#380;e przechowywa&#263; informacje wymagane do
                  po&#322;&#261;czenia z baz&#261; danych (serwer, login itp.) lub inne takie jak - tytu&#322; strony czy sta&#322;e
                  informacje, kt&oacute;re nie podlegaj&#261; zmianom w trakcie dzia&#322;ania systemu. Coyote wykorzystuje w
                  tym celu klas&#281; <tt class="classname">Config</tt>, kt&oacute;ra znajduje si&#281; w pliku <tt class="filename">/lib/config.class.php</tt>. System pr&oacute;buje odczyta&#263; plik konfiguracji wraz ze
                  starem aplikacji - je&#380;eli plik konfiguracji nie zostanie okre&#347;lony, system albo wy&#347;wietli
                  b&#322;&#261;d - albo - przejdzie do dalszych czynno&#347;ci. Zale&#380;y to od tego, czy zosta&#322;a okre&#347;lona
                  nazwa pliku konfiguracyjnego. 
               </p>
               <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Ostrze&#380;enie</h3>Powiniene&#347; odpowiednio zabezpieczy&#263; pliki
                  konfiguracji, tak, aby dost&#281;p do nich nie by&#322; mo&#380;liwy z zewn&#261;trz. Mo&#380;esz do tego
                  wykorzysta&#263; regu&#322;y .htaccess.
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1803"></a>&#321;adowanie pliku konfiguracji do projektu
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Config</tt> zawiera metody statyczne, dostepne w ka&#380;dym
                     momencie dzia&#322;ania aplikacji. Do za&#322;adowania konfiguracji do projektu, mo&#380;na wykorzysta&#263;
                     metod&#281; <tt class="methodname">load()</tt>, podaj&#261;c &#347;cie&#380;k&#281; do pliku konfiguracyjnego -
                     np.:
                  </p><pre class="programlisting">Config::load('config/config.xml'); // poszukuje pliku w katalogu /config </pre><p>Przyk&#322;adowy plik konfguracyjny mo&#380;e wygl&#261;da&#263;
                     tak:
                  </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;application&gt;My App&lt;/application&gt;
&lt;/config&gt;</pre><p>Aby odczyta&#263; zwarto&#347;&#263; pola application, nale&#380;y u&#380;y&#263; metody
                     <tt class="methodname">getItem()</tt>:
                  </p><pre class="programlisting">echo Config::getItem('application'); // wy&#347;wietli My App</pre><p>Je&#380;eli dane pole nie znajduje si&#281; w pliku konfiguracji - metoda
                     <tt class="methodname">getItem()</tt> zwr&oacute;ci warto&#347;&#263; null. Drugim, opcjonalnym parametrem
                     metody <tt class="methodname">getItem()</tt> jest warto&#347;&#263; domy&#347;lna. Zostanie ona zwr&oacute;cona
                     je&#380;eli dany klucz nie znajduje si&#281; w
                     konfiguracji:
                  </p><pre class="programlisting">echo Config::getItem('application', 'My App v.2');// zwr&oacute;ci My App v.2 je&#380;eli pole application nie znajduj si&#281; w konfiguracji</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1837"></a>Automatyczne &#322;adowanie pliku konfiguracji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Du&#380;ym u&#322;atwieniem jest automatyczne &#322;adowanie konfiguracji tu&#380; po starcie systemu
                     (inicjalizacja w klasie <tt class="classname">Core</tt>). Nale&#380;y jednak okre&#347;li&#263; &#347;cie&#380;k&#281;
                     oraz nazw&#281; pliku w momencie inicjalizacji systemu. Otw&oacute;rz plik <tt class="filename">index.php</tt> znajduj&#261;cy si&#281; w g&#322;&oacute;wnym katalogu projektu i umie&#347;&#263; nast&#281;puj&#261;c&#261;
                     instrukcj&#281; przed instrukcj&#261; wywo&#322;uj&#261;c&#261; metod&#281;
                     <tt class="methodname">bootstrap()</tt>:
                  </p><pre class="programlisting">Core::setConfigPath('config/config.xml');</pre><p>Statyczna metoda <tt class="methodname">setConfigPath()</tt> z klasy
                     <tt class="classname">Core</tt> umo&#380;liwia ustawienie &#347;cie&#380;ki do g&#322;&oacute;wnego pliku konfiguracji.
                     Od tej pory ten plik b&#281;dzie &#322;adowany tu&#380; po stacie systemu - nie ma konieczno&#347;ci
                     &#322;adowania go, z u&#380;yciem metody <tt class="methodname">load()</tt>. 
                  </p>
                  <p>Metoda <tt class="methodname">setConfigPath()</tt> przypisuje &#347;cie&#380;ki plik&oacute;w konfiguracji
                     do tablicy. Oznacza to, &#380;e mo&#380;emy okre&#347;li&#263; wiele plik&oacute;w konfiguracyjnych, kt&oacute;re zostan&#261;
                     za&#322;adowane na starcie aplikacji. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1869"></a>Wy&#347;wietlanie zawarto&#347;ci konfiguracji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W celu wy&#347;wietlenia zawarto&#347;ci klasy Config, mo&#380;na u&#380;y&#263; metody
                     <tt class="methodname">getItem()</tt> nie podaj&#261;c &#380;adnego
                     parametru:
                  </p><pre class="programlisting">Core::debug(Config::getItem());</pre><p>W&oacute;wczas zostanie zwr&oacute;cona tablica PHP z informacjami o konfiguracji. W moim przypadku
                     w rezultacie zastosowania powy&#380;szych instrukcji, na ekranie zostanie wy&#347;wietlona
                     tablica:
                  </p><pre class="programlisting">
Array
(
    [core] =&gt; Array
        (
            [root] =&gt; C:/usr/src/coyote/demo/../coyote-1-0/
            [base] =&gt; C:\usr\src\coyote\demo/
            [template] =&gt; template
            [templateConfig] =&gt; config.xml
            [templateExtension] =&gt; .php
            [javascript] =&gt; template/js
        )

    [application] =&gt; My App
)</pre><p>Mo&#380;esz zauway&#263;, i&#380; w konfiguracji znajduj&#261; si&#281; pola, kt&oacute;rych nie ustawia&#322;e&#347;. Warto&#347;ci
                     tych p&oacute;l zosta&#322;y nadane automatycznie przez framework. S&#261; to podstawowe informacje,
                     takie jak &#347;cie&#380;ki czy nazwy katalog&oacute;w istotne dla prawid&#322;owego dzia&#322;ania frameworka.
                     Zostaj&#261; one ustawione w momencie, gdy Coyote nie mo&#380;e odnale&#378;&#263; tych p&oacute;l w pliku
                     konfiguracji. Innymi s&#322;owy: je&#380;eli nie ustawisz tych p&oacute;l r&#281;cznie, w pliku XML, Coyote
                     sam ustawi ich warto&#347;&#263;. &#321;atwo to sprawdzi&#263;. Zmien zawarto&#347;&#263; pliku konfiguracyjnego, tak,
                     aby zawiera&#322; on informacje o rozszerzeniu
                     widok&oacute;w:
                  </p><pre class="programlisting">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;application&gt;My App&lt;/application&gt;
	&lt;core&gt;
		&lt;templateExtension&gt;.phtml&lt;/templateExtension&gt;
	&lt;/core&gt;
&lt;/config&gt;</pre><p>Od tej pory, domy&#347;lnym rozszerzeniem dla plik&oacute;w widok&oacute;w b&#281;dzie
                     .<span class="emphasis"><em>phtml</em></span>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1892"></a>Ustawianie warto&#347;ci konfiguracyjnych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Aby przypisa&#263; now&#261; warto&#347;&#263; konfiguracji w trakcie dzia&#322;ania aplikacji, nale&#380;y u&#380;y&#263;
                     metody
                     <tt class="methodname">setItem()</tt>:
                  </p><pre class="programlisting">
echo Config::getItem('application');
Config::setItem('application', 'My App v.3');
echo Config::getItem('application');</pre><p>Ustawianie warto&#347;ci w trakcie dzia&#322;ania aplikacji mo&#380;e by&#263; dobrym sposobem na
                     przechowywanie globalnych danych w trakcie dzia&#322;ania programu. Do ustawienia warto&#347;ci
                     danego klucza, mo&#380;na wykorzysta&#263; statyczn&#261; metod&#281; <tt class="methodname">setDefault()</tt>.
                     R&oacute;zni si&#281; ona od <tt class="methodname">setItem()</tt> tym, i&#380; warto&#347;&#263; zostanie ustawiona
                     tylko wtedy je&#380;eli ta nie zosta&#322;a ustawiona wcze&#347;niej (innymi s&#322;owy - nie nadpisuje ju&#380;
                     istniej&#261;cej
                     warto&#347;ci):
                  </p><pre class="programlisting">		
Config::setDefault('application', 'My App v.3');
echo Config::getItem('application'); // nadal wy&#347;wietli My App
            </pre><p>Alternatywnym rozwi&#261;zaniem jest zastosowanie instrukcji
                     warunkowej:
                  </p><pre class="programlisting">		
if (!Config::getItem('application'))
{
	Config::setItem('application', 'My App v.3');
}
echo Config::getItem('application'); // nadal wy&#347;wietli My App
            </pre><p>Jednak&#380;e u&#380;ycie metody <tt class="methodname">setDefault()</tt> skraca kod do jednej
                     instrukcji. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>U&#380;ycie metody setItem() spowoduje zast&#261;pienie istniej&#261;cej warto&#347;ci znajduj&#261;cej si&#281; pod
                                 danym kluczem. 
                  </div>
                  <p>Metoda setItem() zast&#281;puje warto&#347;&#263; je&#380;eli dany klucz zosta&#322; zadeklarowany ju&#380;
                     wcze&#347;niej.
                     Np.:
                  </p><pre class="programlisting">		Config::setItem('foo', 'foo');
		Config::setItem('foo', 'bar');

		echo Config::getItem('foo'); // wy&#347;wietli "bar"</pre><p>Nieraz przydatne mo&#380;e si&#281; okaza&#263; dodanie warto&#347;ci - zamiast jej zast&#261;pywania.
                     Przyk&#322;adowo - pole <span class="emphasis"><em>templateConfig</em></span> okre&#347;la nazw&#281; pliku
                     konfiguracyjnego dla widok&oacute;w. Jednak system umo&#380;liwia zadeklarowanie kilku nazw plik&oacute;w,
                     kt&oacute;re b&#281;d&#261; przeszukiwane przez Coyote'a. W&oacute;wczas mo&#380;emy u&#380;y&#263; metody
                     <tt class="methodname">addItem()</tt>:
                  </p><pre class="programlisting">		
Config::addItem('foo', 'foo');
Config::addItem('foo', 'bar');

Core::debug(Config::getItem('foo')); 
/*
stdClass Object
(
    [0] =&gt; foo
    [1] =&gt; bar
)
*/

Config::addItem('core.templateConfig', 'myConfig.ini');
Core::debug(Config::getItem('core.templateConfig'));
/*
stdClass Object
(
    [0] =&gt; config.xml
    [1] =&gt; myConfig.ini
)
		*/</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1937"></a>Przestrzenie nazw
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W miare rozbudowy Twojej aplikacji, rozmiary plik&oacute;w konfiguracyjnych mog&#261; przybra&#263; na
                     wielko&#347;ci. Klucze konfiguracji mog&#261; by&#263; grupowane w przestrzenie nazw. Na podstawie
                     znaku kropki, Coyote rozdzieli klucze i utworzy w pami&#281;ci tablice PHP. Oto
                     przyk&#322;ad:
                  </p><pre class="programlisting">		
Config::setItem('application.name', 'My App');
Config::setItem('application.version', '1.0');
Config::setItem('core.version', '1.1');

Core::debug(Config::getItem());
/* rezultat:
Array
(
    [core] =&gt; Array
        (
            [root] =&gt; C:/usr/src/coyote/demo/../coyote-1-0/
            [base] =&gt; C:\usr\src\coyote\demo/
            [templateExtension] =&gt; .phtml
            [template] =&gt; template
            [templateConfig] =&gt; config.xml
            [javascript] =&gt; template/js
            [version] =&gt; 1.1
        )

    [application] =&gt; Array
        (
            [name] =&gt; My App
            [version] =&gt; 1.0
        )

)
*/</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Mimo,
                     i&#380; konfiguracja zapisana jest w pliku XML, Coyote przekszta&#322;ci znaczniki XML na
                     tablice PHP.
                  </div>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Statyczna metoda <tt class="methodname">debug()</tt> klasy
                     <tt class="classname">Core</tt> umo&#380;liwia wy&#347;wietlanie zawarto&#347;ci tablic, obiekt&oacute;w
                     czy zmiennych.
                  </div>
                  <p> Przestrzenie nazw, mimo, i&#380; w rzeczywisto&#347;ci s&#261; to tablice - pomagaj&#261; zachowa&#263; pewn&#261;
                     organizacj&#281;. 
                  </p>
                  <p>Odczyt warto&#347;ci takiego pola nie r&oacute;&#380;ni si&#281; niczym od odczytu zwyk&#322;ego pola. Nale&#380;y
                     jednak poda&#263; nazw&#281; klucza oraz przestrzeni:
                     
                  </p><pre class="programlisting">echo Config::getItem('core.version');</pre><p>Mo&#380;esz r&oacute;wnie&#380; odczyta&#263; zawarto&#347;&#263; ca&#322;ej przestrzeni, podaj&#261;c jej
                     nazw&#281;:
                  </p><pre class="programlisting">Core::debug(Config::getItem('core'));</pre><p>W takim przypadku, zawarto&#347;&#263; przestrzenii <span class="emphasis"><em>core</em></span>, zostanie zwr&oacute;cona
                     jako obiekt, tak wi&#281;c mo&#380;liwe jest alternatywny odczyt p&oacute;l z przestrzenii
                     nazw:
                  </p><pre class="programlisting">echo Config::getItem('core')-&gt;version;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1971"></a>Podzia&#322; pliku konfiguracji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Nie ma ograniczenia m&oacute;wi&#261;cego, i&#380; ca&#322;a konfiguracja powinna by&#263; trzymana w jednym
                     pliku. Wszystko zale&#380;y od Ciebie - mo&#380;esz rozdzieli&#263; plik konfiguracji na kilka
                     mniejszych plik&oacute;w i &#322;adowa&#263; je do projektu przy pomocy metody
                     <tt class="methodname">load()</tt>. Aby bardziej u&#322;atwi&#263; spraw&#281;, w g&#322;&oacute;wnym pliku
                     konfiguracji mo&#380;esz zawrze&#263; instrukcje o plikach, kt&oacute;re maj&#261; by&#263; r&oacute;wnie&#380; automatycznie
                     za&#322;adowane. W pliku XML, s&#322;u&#380;y do tego dyrektywa
                     include:
                  </p><pre class="programlisting">&lt;include&gt;config/route.xml&lt;/include&gt;</pre><p>Zawarto&#347;&#263; znacznika musi wskazywa&#263; na &#347;cie&#380;k&#281; do pliku, kt&oacute;ry ma zosta&#263; za&#322;adowany do
                     projektu. W tym przypadku zostanie za&#322;adowany plik <span class="emphasis"><em>route.xml</em></span>, z
                     katalogu <tt class="filename">config</tt>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e1989"></a>Adaptery
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Domy&#347;lnym formatem plik&oacute;w konfiguracji Coyote'a jest format XML. Coyote jednak
                     obs&#322;uguje inne formaty, takie jak pliki INI czy pliki PHP zawieraj&#261;ce tablice, kt&oacute;ra po
                     prostu zostanie wczytana do projektu. Nic nie stoi r&oacute;wnie&#380; na przeszkodzie, aby samemu
                     napias&#263; adapter, czym zajmiemy si&#281; nieco p&oacute;&#378;niej. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e1994"></a>Adapter XML
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p> XML jest bardzo popularnym formatem, szeroko wykorzystywanym w rozmaitych
                        aplikacjach. Jest to r&oacute;wnie&#380; zalecany format przechowywania konfiguracji w
                        aplikacjach wykorzystuj&#261;cych Coyote. Klasa <tt class="classname">Config</tt>
                        automatycznie rozpozna format XML po rozserzeniu oraz zainicjalizuje odpowiedni
                        adapter. Klasa <tt class="classname">Config</tt> przekonwertuje znaczniki XML na tablc&#281;
                        PHP. Oznacza to, &#380;e taki plik
                        XML:
                     </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;site&gt;
		&lt;name&gt;4programmers.net&lt;/name&gt;
		&lt;version&gt;1.0&lt;/version&gt;
		&lt;description&gt;Serwis o programowaniu&lt;/description&gt;
	&lt;/site&gt;
&lt;/config&gt;</pre><p>Zostanie przekonwertowany na tablic&#281;
                        PHP:
                     </p><pre class="programlisting">Array
(
    [core] =&gt; Array
        (
            [root] =&gt; C:/usr/src/coyote/demo/../coyote-1-0/
            [base] =&gt; C:\usr\src\coyote\demo/
            [template] =&gt; template
            [templateConfig] =&gt; config.xml
            [templateExtension] =&gt; .php
            [javascript] =&gt; template/js
        )

    [site] =&gt; Array
        (
            [name] =&gt; 4programmers.net
            [version] =&gt; 1.0
            [description] =&gt; Serwis o programowaniu
        )

)</pre><p>Dzi&#281;ki
                        temu w prosty spos&oacute;b mo&#380;emy odczyta&#263; warto&#347;ci
                        konfiguracji:
                     </p><pre class="programlisting">		
echo Config::getItem('site.name');
echo Config::getItem('site')-&gt;name;
Core::debug(Config::getItem('site')); // obiekt site
                </pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2014"></a>Adapter PHP
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Format XML jest popularny i przeno&#347;ny. Jednak dla Ciebie - jako programisty PHP,
                        lepszym rozwi&#261;zaniem mo&#380;e si&#281; wydawa&#263; zapisywanie konfiguracji wprost - w pliku PHP.
                        Np.:
                     </p><pre class="programlisting">&lt;?php

$config['site'] = array(
	'name'		=&gt; '4programmers.net',
	'version'	=&gt; '1.0',
	'description'	=&gt; 'Serwis o programowaniu'
	)
;

?&gt;</pre><p>Taki spos&oacute;b jest wydajniejszy poniewa&#380; system nie traci czasu na konwersje na
                        format PHP. Ponad to, plik PHP mo&#380;e zawiera&#263; dodatkowe instrukcje j&#281;zyka PHP - w tym
                        instrukcj&#281; <tt class="code">include</tt> umo&#380;liwiaj&#261;c&#261; &#322;adowanie innych plik&oacute;w (w tym
                        konfiguracji). 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2026"></a>Adapter INI
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Innym sposobem zapisywania konfiguracji jest plik INI. Sekcje w pliku INI b&#281;d&#261;
                        stanowi&#322;y nazw&#281; przestrzeni nazw, czyli innymi s&#322;owy - sekcja utworzy nowy klucz w
                        tablicy asocjacyjnej w procesie konwersji na format
                        PHP:
                     </p><pre class="programlisting">[site]

name = 4programmers.net
version = 1.0
description = To jest serwis o programowaniu</pre><p>Po za&#322;adowaniu takiego pliku INI, metoda <tt class="methodname">getItem()</tt>
                        zwr&oacute;ci:
                     </p><pre class="programlisting">Array
(
    [core] =&gt; Array
        (
            [root] =&gt; C:/usr/src/coyote/demo/../coyote-1-0/
            [base] =&gt; C:\usr\src\coyote\demo/
            [template] =&gt; template
            [templateConfig] =&gt; config.xml
            [templateExtension] =&gt; .php
            [javascript] =&gt; template/js
        )

    [site] =&gt; Array
        (
            [name] =&gt; 4programmers.net
            [version] =&gt; 1.0
            [description] =&gt; To jest serwis o programowaniu
        )

)</pre><p> W pliku INI, klucze mog&#261; dodatkowo posiada&#263; znak kropki, kt&oacute;ry rozdzieli taki
                        klucz na poszczeg&oacute;lne elementy.
                        Przyk&#322;adowo:
                     </p><pre class="programlisting">[final]

site.name = 4programmers.net
site.version = 1.0
site.description = To jest serwis o programowaniu

[developer]

site.name = 4programmers.net beta
site.version = 2.0-dev
site.description = To jest testowa wersja serwisu o programowaniu</pre><p>Teraz
                        wykonanie takiego kodu w
                        kontrolerze:
                     </p><pre class="programlisting">		Config::load('config/config.ini');
		Core::debug(Config::getItem()); 

		echo Config::getItem('developer.site.name');</pre><p>Spowoduje
                        wy&#347;wietlenie na
                        ekranie:
                     </p><pre class="programlisting">Array
(
    [core] =&gt; Array
        (
            [root] =&gt; C:/usr/src/coyote/demo/../coyote-1-0/
            [base] =&gt; C:\usr\src\coyote\demo/
            [template] =&gt; template
            [templateConfig] =&gt; config.xml
            [templateExtension] =&gt; .php
            [javascript] =&gt; template/js
        )

    [final] =&gt; Array
        (
            [site] =&gt; Array
                (
                    [name] =&gt; 4programmers.net
                    [version] =&gt; 1.0
                    [description] =&gt; To jest serwis o programowaniu
                )

        )

    [developer] =&gt; Array
        (
            [site] =&gt; Array
                (
                    [name] =&gt; 4programmers.net beta
                    [version] =&gt; 2.0-dev
                    [description] =&gt; To jest testowa wersja serwisu o programowaniu
                )

        )

)
4programmers.net beta</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2050"></a>W&#322;asny adapter
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Przypu&#347;&#263;my, &#380;e opr&oacute;cz konfiguracji zapisanej w plikach XML oraz INI, w swojej
                        aplikacji posiadasz r&oacute;wnie&#380; konfiguracje zapisan&#261; w tabeli bazy danych. Napiszemy
                        dodatkowy adapter, kt&oacute;ry b&#281;dzie wczytywa&#322; zawaro&#347;&#263; tabeli do konfiguracji projektu.
                        Tabela jest bardzo
                        prosta:
                     </p><pre class="programlisting">CREATE TABLE coyote_config (
  config_name varchar(120) NOT NULL COMMENT 'Nazwa klucza',
  config_value varchar(255) NOT NULL COMMENT 'Warto&#347;&#263; klucza'
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Dodatkowe opcje konfiguracyjne projektu ';</pre><p>Adaptery konfiguracji musz&#261; implementowa&#263; interfejs IConfig, kt&oacute;ry prezentuje si&#281;
                        nast&#281;puj&#261;co:
                     </p><pre class="programlisting">/**
 * Interface dla adapterow konfiguracji
 */
interface IConfig 
{
	public function load($path);
	/**
	 * Do metody przekazywane jest rozszerzenie pliku konfiguracyjnego. Jezeli metoda zwroci true,
	 * to oznacza, iz akceptuje wybrane rozszerzenie i mozna przetwarzac dane. Jezeli nie - wyswietlany
	 * jest blad programu o braku danego kontrolera
	 */
	public function isAccept($suffix);
}</pre><p>Czyli innymi s&#322;owy - nasz adapter musi posiada&#263; metody load() oraz isAccept(). W
                        katalogu swojej aplikacji utw&oacute;rz folder lib. Nast&#281;pnie, w nim utw&oacute;rz kolejny katalog
                        - config. Tutaj umie&#347;cimy nasz adapter. Plik nazwij db.class.php. Jego zawarto&#347;&#263;
                        mo&#380;e by&#263;
                        nast&#281;puj&#261;ca:
                     </p><pre class="programlisting">&lt;?php

class Config_Db implements IConfig
{
	public function load($path)
	{
		$config = array();

		$db = &amp;Load::loadClass('db', true, 'mysql');
		$db-&gt;connect('localhost', 'root', 'root', 'coyote_dev');

		$query = $db-&gt;query('SELECT * FROM coyote_config'); 
		foreach ($query as $row)
		{ 
			$config[$row['config_name']] = $row['config_value'];
		}
		return $config;
	}

	public function isAccept($suffix)
	{
		return true;
	}
}

?&gt;</pre><p>Domy&#347;lnie, klasa <tt class="classname">Config</tt> jest przystosowana do wczytywania
                        konfiguracji z plik&oacute;w umieszczonych, fizycznie na dysku komputera. Dlatego do metody
                        <tt class="methodname">load()</tt> przekazywany jest parametr okre&#347;laj&#261;cy &#347;cie&#380;k&#281;
                        do pliku konfiguracji. W naszej klasie ignorujemy ten parametr. Metoda
                        <tt class="methodname">load()</tt> musi zwraca&#263; tablic&#281; PHP zawieraj&#261;c&#261;
                        konfiguracj&#281;. Zostanie ona po&#322;&#261;czona z dotychczasow&#261; konfiguracj&#261; projektu. 
                     </p>
                     <p>Metoda <tt class="methodname">isAccept()</tt> powinna zwraca&#263; TRUE lub FALSE w
                        zale&#380;no&#347;ci czy dany format pliku jest akceptowany przez adapter. Klasa
                        <tt class="classname">Config</tt> wywo&#322;uje metod&#281;
                        <tt class="methodname">isAccept()</tt> przekazuj&#261;c w parametrze rozszerzenie pliku
                        konfiguracyjnego. Na tej podstawie adapter powinien stwierdzi&#263;, czy rozserzenie jest
                        dla niego akceptowalne i zwr&oacute;ci&#263; TRUE lub FALSE. 
                     </p>
                     <p>Jeszcze jedna istotna sprawa: klasa Config domy&#347;lnie jest przystosowana do
                        wczytywania plik&oacute;w konfiguracji z dysku. Tzn. poszukuje pliku o podanej nazwie i
                        je&#380;eli go znajduje - wywo&#322;uje metod&#281; <tt class="methodname">load()</tt> z odpowiedniego
                        adaptera. Aby nasz adapter mia&#322; szans&#281; zadzia&#322;a&#263;, umie&#347;&#263; w katalogu /config plik
                        config.db. Tre&#347;&#263; jest niewa&#380;na - mo&#380;e to by&#263; pusty plik. Wa&#380;ne, aby istnia&#322; i loader
                        potrafi&#322; go odnale&#378;&#263;. 
                     </p>
                     <p>Teraz najwa&#380;niejsze - uruchomienie adaptera. Najpierw musimy wywo&#322;a&#263; metod&#281;
                        <tt class="methodname">setAdapter()</tt> klasy <tt class="classname">Config</tt>, aby
                        ustawi&#263; nowy adapter tej klasy. Nast&#281;pnie wczytujemy konfiguracj&#281; wykorzystuj&#261;c
                        metod&#281;
                        l<tt class="methodname">oad()</tt>:
                     </p><pre class="programlisting">Config::setAdapter(new Config_Db);
		Config::load('config/config.db');

		Core::debug(Config::getItem());</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2105"></a>Cache konfiguracji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Wyobra&#378; sobie, &#380;e konfiguracja Twojego projektu podzielona jest na 10 pli&oacute;w XML oraz
                     kilka plik&oacute;w INI. Wszystko w ca&#322;o&#347;&#263; &#322;&#261;czy plik PHP. Mo&#380;emy przyspieszy&#263; dzia&#322;anie
                     aplikacji cachuj&#261;c konfiguracje projektu. Spowoduje to zapisanie ca&#322;ej konfiguracji w
                     jednym pliku PHP, w postaci tablicy PHP. W przypadku, gdy konfiguracja Twojego projektu
                     zawiera wiele instrukcji (np. XML), kt&oacute;re musz&#261; by&#263; parsowane, taki zabieg mo&#380;e
                     przyspieszy&#263; dzia&#322;anie programu. 
                  </p>
                  <p>Cachowanie polega na zapisaniu ca&#322;ej zawarto&#347;ci tablicy <tt class="varname">$config</tt> z
                     klasy <tt class="classname">Config</tt>, do jednego pliku PHP. Konfiguracja zapisywana jest
                     w katalogu cache, wi&#281;c musisz takowy najpierw utworzy&#263;. Cachowanie konfiguracji mo&#380;liwe
                     jest po ustawieniu opcji config.compile. Oto przyk&#322;ad kodu:
                     
                  </p><pre class="programlisting">&lt;?php

class Index extends Controller
{
	function main()
	{
		// nie potrzeba ladowania tego pliku - zostal on cachowany
		if (!Config::isCached())
		{
			Config::load('config/config.ini');
		}
		echo Config::getItem('developer.site.name');

		if (!Config::isCached())
		{
			Config::setAdapter(new Config_Db);
			Config::load('config/config.db');
		}

		Core::debug(Config::getItem());

		Config::setItem('config.compile', true);
	}
}
?&gt;</pre><p>Metoda<tt class="methodname"> isCached()</tt> zwraca TRUE je&#380;eli dane zosta&#322;y odczytane z
                     cache. Zwr&oacute;c uwag&#281;, &#380;e w&oacute;wczas nie jest konieczne wczytanie pliku INI czy konfiguracji z
                     bazy danych - znajduje si&#281; ona ju&#380; w cache!
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2125"></a>Automatyczne &#322;adowanie zasob&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>R&#281;czne wywo&#322;ywanie bibliotek, modeli czy helper&oacute;w mo&#380;e by&#263; nu&#380;&#261;ce i niepraktyczne
                     je&#380;eli cz&#281;sto wykorzystujemy dane zasoby. St&#261;d mo&#380;liwo&#347;&#263; automatycznego ich &#322;adowania
                     wraz ze startem systemu. Nast&#281;puje to w momencie utworzenia instancji klasy
                     <tt class="classname">Load</tt>. 
                  </p>
                  <p> Konstruktor klasy Load odczytuje parametr <span class="emphasis"><em>autoload</em></span> konfiguracji
                     i na tej podstawie umo&#380;liwia za&#322;adowanie bibliotek, helper&oacute;w czy modeli. Wystarczy
                     zadeklarowa&#263; w pliku konfiguracyjnym znacznik autoload:
                     
                  </p><pre class="programlisting">
&lt;autoload&gt;
	&lt;helper&gt;system&lt;/helper&gt;
	&lt;helper&gt;url&lt;/helper&gt;
	&lt;helper&gt;html&lt;/helper&gt;
	&lt;library&gt;email&lt;/library&gt;
	&lt;model&gt;foo&lt;/model&gt;
&lt;/autoload&gt;                
            </pre><div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2140"></a>Automatyczne &#322;&#261;czenie z baz&#261; danych
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p> Niemal w ka&#380;dej aplikacji b&#281;dziesz zmuszony korzysta&#263; z bazy danych. Wygodnym
                        rozwi&#261;zaniem jest, aby framework inicjowa&#322; po&#322;&#261;czenie z baz&#261; danych za nas, aby&#347;my
                        nie musieli tego robi&#263; w ka&#380;dym kontrolerze, co jest raczej niewygodne. Dlatego
                        loader wykrywa, czy w pliku konfiguracyjnym nie okre&#347;lili&#347;my ustawie&#324; bazy danych.
                        Je&#380;eli tak - postara si&#281; on zainicjowa&#263; po&#322;&#261;czenie. Przede wszystkim - ustalmy
                        konfiguracje bazy danych w pliku
                        konfiguracyjnym:
                     </p><pre class="programlisting">&lt;databases&gt;

		&lt;default&gt;
			&lt;adapter&gt;mysql&lt;/adapter&gt;
			&lt;host&gt;localhost&lt;/host&gt;
			&lt;user&gt;root&lt;/user&gt;
			&lt;password&gt;root&lt;/password&gt;
			&lt;dbname&gt;coyote_dev&lt;/dbname&gt;
		&lt;/default&gt;
		
	&lt;/databases&gt;</pre><p> Ustawili&#347;my podstawowe warto&#347;ci konfiguracyjne dla bazy danych. Ale to nie
                        wszystko, gdy&#380; w konfiguracji mo&#380;emy mie&#263; kilka ustawie&#324; baz danych. System musi
                        wiedzie&#263;, z kt&oacute;r&#261; &#322;&#261;czy&#263; si&#281; automatycznie. Ustaw argument autoload dla znacznika
                        default w ten
                        spos&oacute;b:
                     </p><pre class="programlisting">	&lt;databases autoload="default"&gt;

		&lt;default&gt;
			&lt;adapter&gt;mysql&lt;/adapter&gt;
			&lt;host&gt;localhost&lt;/host&gt;
			&lt;user&gt;root&lt;/user&gt;
			&lt;password&gt;root&lt;/password&gt;
			&lt;dbname&gt;coyote_dev&lt;/dbname&gt;
		&lt;/default&gt;
		
	&lt;/databases&gt;</pre><p> Od tego momentu system b&#281;dzie automatycznie zwi&#261;zywa&#322; po&#322;&#261;czenie z baz&#261; danych
                        okre&#347;lon&#261; jako default w konfiguracji aplikacji. 
                     </p>
                  </div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e2153"></a>Rozdzia&#322; 11. Loader
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e2175">Metoda autoload()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2214">Metoda loadFile()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2244">Metoda setIncludePath()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2263">Metoda loadClass()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2281">Metoda loadModule()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2295">Metoda fileExists()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2309">Konstruktor klasy</a></span></dt>
                     <dt><span class="section"><a href="#d0e2341">Metoda directory()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2361">Metoda library()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2386">Metoda lang()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2391">Metoda helper()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2410">Metoda database()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2435">Metoda model()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2451">Metoda module()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2462">Metoda view()</a></span></dt>
                     <dt><span class="section"><a href="#d0e2473">W&#322;asna klasa loadera</a></span></dt>
                  </dl>
               </div>
               <p>
                  Jest to pierwsza biblioteka &#322;adowana przez klas&#281; <tt class="classname">Core</tt>. Jest to
                  bardzo wa&#380;na klasa, kt&oacute;ra odpowiada za &#322;adowanie podzespo&#322;&oacute;w aplikacji. Klasa posiada
                  zar&oacute;wno metody statyczne jak i zwyk&#322;e, co umo&#380;liwia u&#380;ycie loadera na wiele sposob&oacute;w w
                  ka&#380;dym momencie dzia&#322;ania aplikacji. 
                  
               </p>
               <p>
                  Klasa <tt class="classname">Core</tt> rejestruje metod&#281; <tt class="methodname">autoload()</tt> z
                  klasy <tt class="classname">Load</tt> jako metod&#281; typu autoload PHP. Dzi&#281;ki temu mo&#380;liwe jest u&#380;ycie
                  podzespo&#322;&oacute;w aplikacji (bibliotek, helper&oacute;w) bez jawnego &#322;adowania danego pliku przy pomocy - np.
                  instrukcji <tt class="function">include()</tt>. Wystarczy u&#380;y&#263; danego elementu (np. helpera), aby system
                  sam zidentyfikowa&#322; dane wywo&#322;anie, jako pr&oacute;b&#281; wywo&#322;ania - np. helpera i za&#322;adowa&#322; do projektu odpowiedni plik.
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2175"></a>Metoda autoload()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Pierwsz&#261; metod&#261;, kt&oacute;r&#261; warto om&oacute;wi&#263; jest metoda <tt class="methodname">autoload()</tt>. W
                     przypadku gdy PHP nie mo&#380;e odnale&#378;&#263; danej klasy, do kt&oacute;rej chcemy si&#281; odwo&#322;a&#263;,
                     wywo&#322;ywana jest ta metoda, kt&oacute;ra pr&oacute;buje za&#322;adowa&#263; do projektu &#380;&#261;dan&#261; bibliotek&#281;, model,
                     helper lub kontroler. W tym celu metoda odczytuje przyrostek klasy. Je&#380;eli przyrostek to
                     <span class="emphasis"><em>model</em></span> - oznacza, i&#380; &#380;&#261;dana klasa jest modelem. Je&#380;eli jest to
                     <span class="emphasis"><em>controller</em></span> - klasa jest kontrolerem. W innym przypadku, loader
                     pr&oacute;buje odszuka&#263; klasy w podkatalogach folderu <tt class="filename">lib</tt> a je&#380;eli i to
                     nie pomo&#380;e - sprawdza, czy dana klasa jest nazw&#261; helpera lub biblioteki. 
                     
                  </p>
                  <p>
                     W przypadku korzystania z metody <tt class="methodname">autoload()</tt>, klasa nie
                     zostanie zainicjalizowana. Oznacza to, &#380;e nie zostanie utworzona instancja danej klasy.
                     Przyk&#322;adowo:
                     
                  </p><pre class="programlisting">
User::foo(); // pr&oacute;ba odwo&#322;ania si&#281; do nieistniej&#261;cej klasy User i statycznej metody foo()
            </pre><p>
                     
                  </p>
                  <p>
                     W takim przypadku, przed wy&#347;wietleniem komunikatu z b&#322;&#281;dem, system przeszukuje
                     katalogi <tt class="filename">helper</tt> i <tt class="filename">lib</tt> projektu (zar&oacute;wno w
                     katalogu z frameworkiem jak i z aplikacj&#261;) i szuka pliku <tt class="filename">user.helper.php</tt> lub <tt class="filename">user.class.php</tt>. Plik jest &#322;adowany
                     do projektu, lecz sama klasa nie jest inicjalizowana.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2214"></a>Metoda loadFile()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Dzia&#322;anie metody <tt class="methodname">loadFile()</tt> jest proste. Wczytuje ona do aplikacji dany
                     plik PHP. Wywo&#322;uje ona instrukcj&#281; <tt class="function">include_once()</tt>. Statyczna metoda
                     <tt class="methodname">loadFile()</tt> umo&#380;liwia za&#322;adowanie do projektu ca&#322;ej grupy plik&oacute;w korzystaj&#261;c
                     z maski:
                     
                     
                  </p><pre class="programlisting">

Load::loadFile('lib/foo/*.php', true); 
                
            </pre><p>
                     
                     Taka instrukcja za&#322;aduje wszystkie pliki z rozszerzeniem .php, z katalogu <tt class="filename">/lib/foo.</tt>
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                                 Zwr&oacute;&#263; uwage, &#380;e drugim parametrem metody <tt class="methodname">loadFile()</tt> jest typ bool. Warto&#347;&#263;
                                 TRUE oznacza, &#380;e uwzgl&#281;dniana b&#281;dzie maska w pierwszym parametrze tej metody.
                             
                  </div>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                                 Metoda <tt class="methodname">loadFile()</tt> umo&#380;liwia za&#322;adowanie tak&#380;e pliku znajduj&#261;cego si&#281; w module.
                             
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2244"></a>Metoda setIncludePath()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda wywo&#322;uje funkcj&#281; PHP: <tt class="function">set_include_path()</tt> dodaj&#261;c dan&#261;
                     &#347;cie&#380;k&#281; do zmiennej PHP: <span class="emphasis"><em>include_path</em></span>. W zwi&#261;zku z tym, szukaj&#261;c
                     jakiego&#347; pliku, system b&#281;dzie przeszukiwa&#322; wszystkie foldery okre&#347;lone w tej zmiennej.
                     
                  </p>
                  <p>
                     Ta metoda ma du&#380;e znaczenie przy &#322;adowaniu nowego modu&#322;u do aplikacji. Po za&#322;adowaniu nowego modu&#322;u
                     (przy pomocy metody <tt class="methodname">loadModule()</tt>) wywo&#322;ywana zostaje metoda 
                     <tt class="methodname">setIncludePath()</tt> dodaj&#261;c odpowiedni&#261; &#347;cie&#380;k&#281; do danego modu&#322;u.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2263"></a>Metoda loadClass()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda u&#380;ywana jest do &#322;adowania bibliotek projektu. Jej nag&#322;&oacute;wek prezentuje si&#281;
                     nast&#281;puj&#261;co:
                     
                  </p><pre class="programlisting">
public static function &amp;loadClass($class_name, $init = true, $params = '')
            </pre><p>
                     
                  </p>
                  <p>
                     Pierwszym parametrem jest oczywi&#347;cie nazwa klasy. Drugi parametr okre&#347;la, czy metoda
                     ma by&#263; inicjalizowana czy te&#380; nie. Ostatni parametr okre&#347;la dodatkowe parametry
                     przekazywane do konstruktora klasy.
                     
                  </p>
                  <p>
                     Metoda <tt class="methodname">loadClass()</tt> &#322;aduje dan&#261; bibliotek&#281; tylko raz! Oznacza
                     to, &#380;e raz za&#322;adowana przechowywana w pami&#281;ci komputera, jest mo&#380;liwa do obs&#322;u&#380;enia w
                     r&oacute;&#380;nych miejscach programu.
                     
                     Przyk&#322;adowo:
                     
                  </p><pre class="programlisting">
$foo = &amp;load::loadClass('foo'); 
$foo-&gt;bar(); 
// w innym pliku mo&#380;emy uzyska&#263; dost&#281;p do tej biblioteki ponownie:
$foo = &amp;Load::loadClass('foo');
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2281"></a>Metoda loadModule()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     O modu&#322;ach b&#281;dzie mowa w dalszej cz&#281;&#347;ci dokumentacji. Statyczna metoda
                     <tt class="classname">loadModule() </tt>s&#322;u&#380;y do &#322;adowania do projektu modu&#322;&oacute;w, kt&oacute;re
                     zlokalizowane s&#261; w katalogu <tt class="filename">/module</tt>:
                     
                  </p><pre class="programlisting">
Load::loadModule('user'); // za&#322;adowanie modu&#322;u user
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2295"></a>Metoda fileExists()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Zwraca true je&#380;eli plik podany w parametrze istnieje pod podan&#261; &#347;cie&#380;k&#261;. W praktyce
                     niczym nie r&oacute;&#380;ni si&#281; od funkcji PHP: <tt class="function">file_exists()</tt>. Jest jednak
                     ma&#322;a subtelna r&oacute;&#380;nica, a mianowicie <tt class="methodname">fileExists()</tt> przeszukuje w
                     r&oacute;&#380;nych lokalizacjach okre&#347;lonych w zmiennej PHP: <span class="emphasis"><em>include_path</em></span>.
                     Jest to nadzwyczaj wa&#380;ne w przypadku modu&#322;&oacute;w. 
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2309"></a>Konstruktor klasy
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Konstruktor klasy <tt class="classname">Load</tt>, wywo&#322;ywany jest w klasie
                     <tt class="classname">Core</tt> (metoda <tt class="methodname">dispatch()</tt>). W tym
                     momencie za&#322;adowane zostaj&#261; wszystkie biblioteki okre&#347;lone parametrze konfiguracji
                     <span class="emphasis"><em>autoload</em></span>, tzn. modu&#322;y, biblioteki, helpery, pliki j&#281;zykowe. W
                     tym momencie zainicjowane zostanie ewentualne po&#322;&#261;czenie z baz&#261; danych (je&#380;eli aplikacja
                     tego wymaga). Tak wi&#281;c od tego momentu mo&#380;liwe b&#281;dzie korzystanie z bazy danych (czyli
                     de facto, w momencie wywo&#322;ania metody <tt class="methodname">dispatch()</tt>). 
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     W metodzie dispatch() nast&#281;puje utworzenie instancji klasy Load. W parametrze
                     konstruktora tej klasy przekazywane s&#261; nazwy podstawowych klas, kt&oacute;re s&#261;
                     inicjalizowane przez framework (m.in. <tt class="classname">Context</tt>,
                     <tt class="classname">Input</tt>, <tt class="classname">Output</tt>). Oznacza to, &#380;e
                     klasy te, niezale&#380;nie od ustawien aplikacji s&#261; automatycznie &#322;adowane do zasob&oacute;w
                     aplikacji i s&#261; dost&#281;pne w &oacute;w programie. 
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2341"></a>Metoda directory()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Je&#380;eli masz katalog, w kt&oacute;rym znajduje si&#281; wiele bibliotek, czy helper&oacute;w, mo&#380;esz
                     skorzysta&#263; z metody <tt class="methodname">directory()</tt> podaj&#261;c jako parametr &#347;cie&#380;k&#281;
                     do &oacute;w katalogu. W takim momencie system za&#322;aduje wszystkie biblioteki czy helpery z
                     tego&#380; folderu:
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;library('lib/');
            </pre><p>
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Metoda <tt class="methodname">directory()</tt> nie jest metod&#261; statyczn&#261;!
                     
                  </div>
                  <p>
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Ostatnim znakiem &#322;a&#324;cucha musi by&#263; znak / je&#380;eli framework ma za&#322;adowa&#263; ca&#322;y katalog.
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2361"></a>Metoda library()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     T&#261; metod&#281; ju&#380; znasz. Wywo&#322;uje ona <tt class="methodname">loadClass()</tt>, a nast&#281;pnie po
                     za&#322;adowaniu klasy, tworzy referencj&#281; do jej obiektu w <tt class="classname">Core</tt>.
                     Metoda ta posiada drugi, opcjonalny parametr, kt&oacute;ry mo&#380;e zawiera&#263; parametry przekazywane
                     do konstruktora klasy.
                     
                  </p>
                  <p>
                     Metoda opr&oacute;cz tego, &#380;e tworzy referencj&#281; w klasie Core, zwraca j&#261;, dzi&#281;ki temu mo&#380;emy
                     u&#380;ywa&#263; takiego, skr&oacute;towego zapisu:
                     
                  </p>
                  <p>
                     
                  </p><pre class="programlisting">
$foo = &amp;$this-&gt;load-&gt;library('foo');
$foo-&gt;bar();
// to samo, co:
$this-&gt;load-&gt;library('foo');
$this-&gt;foo-&gt;bar();
            </pre><p>
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3> 
                                 Metoda <tt class="methodname">loadClass</tt> jedynie &#322;aduje (lub/i inicjalizuje) dan&#261;
                                 klas&#281; lecz nie tworzy referencji do niej w obiekcie klasy Core! Przyk&#322;adowo: 
                                 <span><b class="command">Load::loadClass('foo'); $this-&gt;foo-&gt;bar(); // b&#322;&#261;d! Brak referencji!</b></span></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2386"></a>Metoda lang()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     System umo&#380;liwia pisanie aplikacji wieloj&#281;zykowych. Przy pomocy tej metody mo&#380;emy
                     za&#322;adowa&#263; plik z komunikatami j&#281;zykowymi. Wi&#281;cej informacji o tej funkcji w dalszej
                     cz&#281;&#347;ci dokumentacji. 
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2391"></a>Metoda helper()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Prosta w u&#380;yciu metoda umo&#380;liwia za&#322;adowanie helper&oacute;w. Metoda &#322;aduje dany plik do
                     projektu, jedynie jeden raz! Tzn. nawet jezeli u&#380;yjemy metody helper() kilkakrotnie, z
                     tym samym parametrem - dany plik zostanie za&#322;adowany do aplikacji tylko raz.
                     
                  </p>
                  <p>
                     Helpery mog&#261; by&#263; grupowane w podkatalogach. Tzn. w folderze 
                     <tt class="filename">helper</tt>, mo&#380;esz utworzy&#263; katalog <tt class="filename">foo</tt>, a w nim -
                     <tt class="filename">bar.helper.php</tt>. Za&#322;adowanie helpera do projektu wymaga podania
                     nazwy podkatalogu:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;helper('foo/bar'); // &lt;-- bez sufiksu helper.php
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2410"></a>Metoda database()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda s&#322;u&#380;y do zainicjowania po&#322;&#261;czenia z baz&#261; danych. W Coyote istnieje kilka
                     sposob&oacute;w na po&#322;&#261;czenie z baz&#261; danych. Mo&#380;na u&#380;y&#263; klasy <tt class="classname">DB</tt> lub
                     metody <tt class="methodname">database()</tt> z klasy <tt class="classname">Load</tt>. Metoda
                     ta automatycznie za&#322;aduje bibliotek&#281; <tt class="classname">DB</tt> (je&#380;eil ta nie zosta&#322;a
                     jeszcze za&#322;adowana) oraz po&#322;&#261;czenie z baz&#261; danych. Nag&#322;&oacute;wek tej metody wygl&#261;da
                     nast&#281;puj&#261;co:
                     
                     
                  </p><pre class="programlisting">
public function database($adapter, $host, $user, $password, $dbname, $port = false)
            </pre><p>
                     
                  </p>
                  <p>
                     Pierwszym parametrem musi by&#263; nazwa adaptera bazy danych (np. mysql, postgresql).
                     Przyk&#322;ad:
                     
                     
                  </p><pre class="programlisting">
$this-&gt;load-&gt;database('mysql', 'localhost', 'root', 'root', 'coyote_dev');
$this-&gt;db-&gt;query('SELECT * .... '); 
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2435"></a>Metoda model()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda &#322;aduje do projektu model na podstawie parametru okre&#347;laj&#261;cego jego nazw&#281;.
                     Dodatkowo zwracana jest referencja do klasy
                     modelu:
                     
                  </p><pre class="programlisting">
$foo = &amp;$this-&gt;load-&gt;model('foo');
echo $foo-&gt;version();
// to samo, co:
$this-&gt;laod-&gt;model('foo');
echo $this-&gt;model-&gt;foo-&gt;version();
            </pre><p>
                     
                  </p>
                  <p>
                     Plik z klas&#261; modelu r&oacute;wnie&#380; &#322;adowany jest tylko raz. Dzi&#281;ki temu jak tylko potrzbujesz
                     uzyska&#263; dost&#281;p do metod danego modelu, po prostu go wywo&#322;ujesz. Metoda
                     <tt class="methodname">model()</tt> zwr&oacute;ci odpowiedni&#261; referencj&#281; do klasy.
                     
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>
                     Ze wzgl&#281;du na to, &#380;e plik z modelem &#322;adowany jest tylko raz, r&oacute;wnie&#380; klasa modelu
                     inicjalizowana jest jednokrotnie bez wzgl&#281;du na ilo&#347;&#263; u&#380;ycia metody model().
                     
                  </div>
                  <p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2451"></a>Metoda module()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda realizuje t&#281; sam&#261; czynno&#347;&#263; co metoda statyczna
                     <tt class="methodname">loadModule()</tt>. Tak wi&#281;c oba wywo&#322;ania s&#261; sobie
                     r&oacute;wne:
                     
                     
                  </p><pre class="programlisting">
Load::loadModule('foo');
$this-&gt;load-&gt;module('foo');
            </pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2462"></a>Metoda view()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Metoda tworzy instancj&#281; klasy <tt class="classname">View</tt> i zwraca obiekt tej klasy.
                     Tak wi&#281;c chc&#261;c wy&#347;wietli&#263; dany widok, mo&#380;emy u&#380;y&#263; nast&#281;puj&#261;cych
                     instrukcji:
                     
                  </p><pre class="programlisting">
$view = new View('foo');
echo $view;
// albo:
$view = $this-&gt;load-&gt;view('foo');
echo $view;</pre><p>
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2473"></a>W&#322;asna klasa loadera
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> 
                     Je&#380;eli nie odpowiada Ci obecny kszta&#322;t klasy Load, albo chcia&#322;by&#347; po prostu -
                     rozbudowa&#263; j&#261; o swoje metody bez zmiany jej oryginalnego wygladu (dziedziczenie),
                     powiniene&#347; okre&#347;li&#263; &#347;cie&#380;k&#281; do klasy loadera. Loader &#322;adowany jest do projektu w
                     metodzie <tt class="methodname">bootstrap()</tt> klasy <tt class="classname">Core</tt>.
                     Domy&#347;lnie framework poszukuje loadera pod &#347;cie&#380;k&#261; <tt class="filename">lib/load.class.php</tt>. 
                     Je&#380;eli chcesz ustawi&#263; now&#261; &#347;cie&#380;k&#281; do loadera, musisz skorzysta&#263; z metody 
                     <tt class="methodname">setLoaderPath() </tt>i wywo&#322;a&#263; j&#261; przed metod&#261;
                     <tt class="methodname">bootstrap()</tt>. W tym celu otw&oacute;rz plik <tt class="filename">index.php</tt> 
                     swojego projektu i dopisz jedn&#261; lini&#281;
                     kodu:
                     
                  </p><pre class="programlisting">
Core::setLoaderPath('lib/myloader.class.php');
/**
 * Ustawienie pliku konfiguracji projektu
 */
Core::setConfigPath('config.xml');
/**
 *	Metoda bootstrap() sluzy do inicjalizacji podstawowych zmiennych projektu
 */
Core::bootstrap($root_dir)-&gt;dispatch();
            </pre><p>
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e2499"></a>Rozdzia&#322; 12. Dispatcher
                        </h2>
                     </div>
                  </div>
               </div>
               <p>W klasie <tt class="classname">Core</tt>, po odczytaniu nazwy kontrolera oraz akcji (z klasy
                  <tt class="classname">Router</tt>), te dane przekazywane s&#261; do klasy
                  <tt class="classname">Dispatcher</tt>. Ona bowiem tworzy obiekt klasy kontrolera i wywo&#322;uje
                  odpowiedni&#261; akcj&#281;. Dzieje si&#281; to jedna bez Twojego udzia&#322;u wi&#281;c nie jest zbyt istotne z
                  punktu widzenia programisty. 
               </p>
               <p>System umo&#380;liwia r&oacute;wnie&#380; na przeskok z jednego kontrolera do drugiego. Na pewno nie b&#281;dzie
                  to zbyt cz&#281;sto u&#380;ywana funkcja, ale warto wiedzie&#263;, i&#380; co&#347; takiego jest mo&#380;liwe. 
               </p>
               <p>Klasa <tt class="classname">Dispatcher</tt> posiada jedn&#261; statyczn&#261; metod&#281; -
                  <tt class="methodname">dispatch()</tt>:
               </p><pre class="programlisting">public static function dispatch($controller, $action, $folder = '', array $args = array())</pre><p>Pierwszym parametrem jest nazwa kontrolera, kt&oacute;ry ma zosta&#263; wywo&#322;any. Kolejnym jest nazwa
                  akcji, a trzecim - nazwa ewentualnego podkatalogu, w kt&oacute;rym znajduje si&#281; kontroler. Ostatni
                  parametr to tablica parametr&oacute;w, ktore zostan&#261; przekazane do akcji. Dla przyk&#322;adu utw&oacute;rzmy
                  kontroler
                  bar:
               </p><pre class="programlisting">
 class Bar extends Controller
 {
    function __construct()
    {
    }
    
    function FooBar($name)
    {
        echo $name;
    }
}</pre><p>Chcemy przekierowa&#263; dzia&#322;anie aplikacji do kontrolera <tt class="classname">Bar</tt>, z
                  kontrolera <tt class="classname">Foo</tt>. Mo&#380;liwe jest to dzi&#281;ki takiemu u&#380;yciu metody
                  <tt class="methodname">dispatch()</tt>:
               </p><pre class="programlisting">Dispatcher::dispatch('bar', 'foobar', '', array('Adam'));</pre><p>Metoda <tt class="methodname">dispatch()</tt> przed wywo&#322;aniem danego kontrolera, sprawdza,
                  czy odpowiedni plik i akcja - istniej&#261;. Je&#380;eli nie - wykonywany jest wy&#261;tek
                  <tt class="classname">FileNotFoundException</tt>, co spowoduje wy&#347;wietlenie b&#322;&#281;du. Je&#380;eli w
                  kontrolerze nie istnieje dana akcja - system poszukuje metody
                  <tt class="methodname">__call()</tt>. Je&#380;eli i ona nie zostanie odnaleziona - system
                  sygnalizuje brak odpowiedniej metody. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Pami&#281;taj, i&#380; po utworzeniu instancji klasy
                  kontrolera (czyli de facto - wywo&#322;aniu jego konstruktora), a przed wykonaniem akcji,
                  metoda <tt class="methodname">dispatch()</tt> spr&oacute;buje odnale&#378;&#263;, a nast&#281;pnie wykona&#263; metod&#281;
                  <tt class="methodname">_start()</tt>. Mo&#380;esz w niej umie&#347;ci&#263; dodatkowy kod, kt&oacute;ry
                  zostanie wykonany pomi&#281;dzy kodem konstroktora a akcji. 
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e2561"></a>Rozdzia&#322; 13. Obs&#322;uga baz danych
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e2570">&#321;&#261;czenie z baz&#261; danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2596">Automatyczne &#322;&#261;czenie z baz&#261; danych</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e2609">Zamykanie po&#322;&#261;czenia z baz&#261;</a></span></dt>
                     <dt><span class="section"><a href="#d0e2620">Wysy&#322;anie zapyta&#324; SQL</a></span></dt>
                     <dt><span class="section"><a href="#d0e2645">Dodawanie rekord&oacute;w w tabeli</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2667">Metoda multiInsert()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e2677">Uaktualnianie rekord&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e2698">Usuwanie rekord&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e2721">Pobieranie danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2758">Metoda select()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2775">Metoda from()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2789">Metoda where()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2818">Metody order() oraz limit()</a></span></dt>
                           <dt><span class="section"><a href="#d0e2831">Instrukcje JOIN</a></span></dt>
                           <dt><span class="section"><a href="#d0e2851">Instrukcja GROUP BY</a></span></dt>
                           <dt><span class="section"><a href="#d0e2861">Instrukcja IN</a></span></dt>
                           <dt><span class="section"><a href="#d0e2876">Metoda like()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e2886">Klasa Db_Result</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e2925">Pobieranie danych</a></span></dt>
                           <dt><span class="section"><a href="#d0e3068">Pobieranie pola z tablicy wynik&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e3094">Informacja o ilo&#347;ci zwr&oacute;conych rekord&oacute;w i p&oacute;l</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e3116">Bezpiecze&#324;stwo</a></span></dt>
                     <dt><span class="section"><a href="#d0e3166">Mechanizm transakcji</a></span></dt>
                     <dt><span class="section"><a href="#d0e3185">Blokowanie tabel</a></span></dt>
                     <dt><span class="section"><a href="#d0e3198">Metoda nextId()</a></span></dt>
                     <dt><span class="section"><a href="#d0e3203">Pobranie wersji systemu bazodanowego</a></span></dt>
                  </dl>
               </div>
               <p>W ka&#380;dym wi&#281;kszym projekcie zachodzi potrzeba wykorzystania baz danych. Mo&#380;emy oczywi&#347;cie
                  korzysta&#263; ze &#347;wietnego formatu jakim jest XML, lecz nie odda nam on mo&#380;liwo&#347;ci jakie oferuj&#261;
                  mechanizmy relacyjnych baz danych. 
               </p>
               <p>Obecnie Coyote obs&#322;uguje dost&#281;p do baz danych MySQL oraz PostgreSQL. Obsluga kolejnego
                  systemu bazodanowego wi&#261;ze si&#281; z napisaniem odpowiedniego adaptera (szczeg&oacute;&#322;y w dalszej cz&#281;&#347;ci). 
               </p>
               <p>Generalnie, Coyote zapewnia abstrakcyjny dost&#281;p do baz danych. Oznacza to, &#380;e niezale&#380;nie,
                  czy korzystamy z MySQL, czy PostgreSQL - do obs&#322;ugi wykorzystujemy te same metody. 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2570"></a>&#321;&#261;czenie z baz&#261; danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W Coyote, do obslugi baz danych, wykorzystujemy klas&#281; <tt class="classname">Db</tt>. Ta wi&#281;c
                     przed po&#322;&#261;czeniem nale&#380;y &oacute;w klas&#281; za&#322;adowa&#263; oraz okre&#347;li&#263; adapter. W naszym przyk&#322;adzie
                     pos&#322;u&#380;ymy si&#281; baz&#261; MySQL. Za po&#322;&#261;czenie do bazy odpowiada poni&#380;szy
                     kod:
                  </p><pre class="programlisting">// zaladowanie biblioteki db
		$this-&gt;load-&gt;library('db', 'mysql');
		// laczenie...
		$this-&gt;db-&gt;connect('localhost', 'root', 'root', 'coyote_dev');</pre><p>W drugim parametrze metody <tt class="methodname">library()</tt> mo&#380;emy przekaza&#263; warto&#347;ci,
                     kt&oacute;re zostan&#261; przekazane do konstruktora klasy - w tym wypadku - adaptera mysql. Gdy
                     biblioteka zosta&#322;a za&#322;adowana, przy pomocy metody <tt class="methodname">connect() </tt>-
                     realizujemy po&#322;&#261;czenie z baz&#261;. Metoda posiada kilka parametr&oacute;w, w kolejno&#347;ci: host bazy,
                     login, has&#322;o, nazwa bazy, port (opcjonalnie). 
                  </p>
                  <p>Alternatywnym sposobem jest zwyk&#322;e utworzenie instancji:
                     
                  </p><pre class="programlisting">$db = new db('mysql');
		$db-&gt;connect('localhost', 'root', 'root', 'coyote_dev');</pre><p>Jeszcze innym sposobem jest u&#380;ycie metody database() z klasy Load. Metoda zainicjalizuje
                     klas&#281; DB oraz po&#322;&#261;czy si&#281; z baz&#261;
                     danych:
                  </p><pre class="programlisting">$this-&gt;load-&gt;database('mysql', 'localhost', 'root', 'root', 'coyote_dev');</pre><div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2596"></a>Automatyczne &#322;&#261;czenie z baz&#261; danych
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Wygodnym rozwi&#261;zaniem jest, aby framework inicjowa&#322; po&#322;&#261;czenie z baz&#261; danych za nas,
                        aby&#347;my nie musieli tego robi&#263; w ka&#380;dym kontrolerze, co jest raczej niewygodne. Dlatego
                        loader wykrywa, czy w pliku konfiguracyjnym nie okre&#347;lili&#347;my ustawie&#324; bazy danych. Je&#380;eli
                        tak - postara si&#281; on zainicjowa&#263; po&#322;&#261;czenie. Przede wszystkim - ustalmy konfiguracje bazy
                        danych w pliku
                        konfiguracyjnym:
                     </p><pre class="programlisting">&lt;databases&gt;
          
          &lt;default&gt;
          &lt;adapter&gt;mysql&lt;/adapter&gt;
          &lt;host&gt;localhost&lt;/host&gt;
          &lt;user&gt;root&lt;/user&gt;
          &lt;password&gt;root&lt;/password&gt;
          &lt;dbname&gt;coyote_dev&lt;/dbname&gt;
          &lt;/default&gt;
          
          &lt;/databases&gt;</pre><p>Ustawili&#347;my podstawowe warto&#347;ci konfiguracyjne dla bazy danych. Ale to nie wszystko,
                        gdy&#380; w konfiguracji mo&#380;emy mie&#263; kilka ustawie&#324; baz danych. System musi wiedzie&#263;, z kt&oacute;r&#261;
                        &#322;&#261;czy&#263; si&#281; automatycznie. Ustaw argument autoload dla znacznika default w ten
                        spos&oacute;b:
                     </p><pre class="programlisting">	
          &lt;databases autoload="default"&gt;
          
          &lt;default&gt;
          &lt;adapter&gt;mysql&lt;/adapter&gt;
          &lt;host&gt;localhost&lt;/host&gt;
          &lt;user&gt;root&lt;/user&gt;
          &lt;password&gt;root&lt;/password&gt;
          &lt;dbname&gt;coyote_dev&lt;/dbname&gt;
          &lt;/default&gt;
          
          &lt;/databases&gt;</pre><p>Od tego momentu system b&#281;dzie automatycznie zwi&#261;zywa&#322; po&#322;&#261;czenie z baz&#261; danych okre&#347;lon&#261;
                        jako default w konfiguracji aplikacji. 
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2609"></a>Zamykanie po&#322;&#261;czenia z baz&#261;
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> Zamkni&#281;cie po&#322;&#261;czenia z baz&#261; realizuje metoda <tt class="methodname">close()</tt>. Nie ma
                     jednak konieczno&#347;ci, jawnego jej u&#380;ycia, gdy&#380; jest wywo&#322;ywana z poziomu destruktora klasy
                     <tt class="classname">Db</tt>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2620"></a>Wysy&#322;anie zapyta&#324; SQL
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Na potrzeby tego rozdzia&#322;u utworzy&#322;em, prost&#261;, przyk&#322;adow&#261; tabel&#281; w mojej bazie
                     danych:
                  </p><pre class="programlisting">CREATE TABLE `coyote_dev`.`coyote_dev` (
`id` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`value` VARCHAR( 100 ) NOT NULL 
) ENGINE = MYISAM</pre><p>W Coyote, a dok&#322;adnie w bibliotece <tt class="classname">Db</tt>, za wysy&#322;anie zapyta&#324; SQL do
                     systemu bazodanowego, odpowiada metoda <tt class="methodname">query()</tt>. Wys&#322;anie prostego
                     zapytania <span><b class="command">INSERT</b></span>, mo&#380;e wygl&#261;da&#263;
                     nast&#281;puj&#261;co:
                  </p><pre class="programlisting">// zaladowanie biblioteki db
		$this-&gt;load-&gt;library('db', 'mysql');
		// laczenie...
		$this-&gt;db-&gt;connect('localhost', 'root', 'root', 'coyote_dev');

		$sql = 'INSERT INTO `coyote_dev` (value) VALUES("adam");';
		$this-&gt;db-&gt;query($sql);</pre><p>Taki kod wstawi nowy rekord do naszej przyk&#322;adowej tabeli <span class="emphasis"><em>coyote_dev</em></span>.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2645"></a>Dodawanie rekord&oacute;w w tabeli
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>System Coyote upraszcza realizowanie prostych operacji na bazie danych. Do nich nale&#380;y
                     r&oacute;wnie&#380; wstawianie rekord&oacute;w w tabeli (innymi s&#322;owy realizowanie zapytania INSERT). W tym celu
                     mo&#380;emy u&#380;y&#263; metody <tt class="methodname">insert()</tt> klasy
                     <tt class="classname">Db</tt>:
                  </p><pre class="programlisting">$this-&gt;db-&gt;insert('coyote_dev', array('value' =&gt; 'adam'));</pre><p>Pierwszym parametrem metody musi by&#263; nazwa tabeli do kt&oacute;rej wstawiamy dane. Kolejny
                     parametr to tabela okre&#347;laj&#261;ca nazwy kolumn oraz ich warto&#347;ci w nowym rekordzie. Innymi s&#322;owy,
                     u&#380;ycie metody <tt class="methodname">insert()</tt> jest r&oacute;wnowa&#380;ne z kodem prezentowanym
                     wcze&#347;niej:
                  </p><pre class="programlisting">$sql = 'INSERT INTO `coyote_dev` (value) VALUES("adam");';
		$this-&gt;db-&gt;query($sql);</pre><p>Zalet&#261; takiego rozwi&#261;zania jest to, i&#380; nie musimy martwi&#263; si&#281; o pisanie dok&#322;adnej sk&#322;adni
                     SQL. Wstawianie rekord&oacute;w realizowane jest szybciej. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2667"></a>Metoda multiInsert()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>MySQL umo&#380;liwia wstawienie wielu rekord&oacute;w do tabeli, przy pomocy jednego zapytania SQL.
                        Umo&#380;liwia to metoda <tt class="methodname">multiInsert()</tt>. Parametrem tej metody jest
                        tablica zawieraj&#261;ca warto&#347;ci rekord&oacute;w do wstawienia. Oto przyk&#322;ad wykorzystania tej
                        metody:
                     </p><pre class="programlisting">
$arr = array('adam', 'marta', 'ewelina');
foreach ($arr as $value)
{
	$sql_arr[] = array(
		'value'			=&gt; $value
	);
}
$this-&gt;db-&gt;multiInsert('coyote_dev', $sql_arr);</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2677"></a>Uaktualnianie rekord&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Uaktualnienie rekordu jest r&oacute;wnie proste, jak jego wstawienie. Odpowiada za to metoda
                     <tt class="methodname">update()</tt>. Pierwszy parametr metody musi oznacza&#263; nazw&#281; tabeli, a
                     drugi - dane, kt&oacute;re zostan&#261;
                     uaktualnione:
                  </p><pre class="programlisting">$this-&gt;db-&gt;update('coyote_dev', array('value' =&gt; 'adam'));</pre><p>W takim wypadku uaktualnione zostan&#261; wszystkie rekordy, poniewa&#380; nie dodali&#347;my
                     opcjonalnego, trzeciego warunku
                     <span class="emphasis"><em>where</em></span>:
                  </p><pre class="programlisting">$this-&gt;db-&gt;update('coyote_dev', array('value' =&gt; 'boduch'), 'id = 1');</pre><p>Uaktualnione zostan&#261; wszystkie rekordy, kt&oacute;rych kolumna id r&oacute;wna si&#281; 1. Mo&#380;na oczywi&#347;cie
                     &#322;&#261;czy&#263; warunki ze
                     sob&#261;:
                  </p><pre class="programlisting">$this-&gt;db-&gt;update('coyote_dev', array('value' =&gt; 'boduch'), 'id = 1 AND value = "adam"');</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2698"></a>Usuwanie rekord&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Jak &#322;atwo si&#281; domy&#347;li&#263;, za usuwanie rekord&oacute;w odpowiada metoda
                     <tt class="methodname">delete()</tt>. Pierwszym jej parametrem jest oczywi&#347;cie nazwa tabeli, a
                     drugim - warunek <span class="emphasis"><em>where</em></span>
                     (opcjonalnie):
                  </p><pre class="programlisting">$this-&gt;db-&gt;delete('coyote_dev', 'id = 1 AND value = "adam"');</pre><p>Usuni&#281;te zostana rekordy, kt&oacute;rych kolumna <span class="emphasis"><em>id</em></span> ma warto&#347;&#263; 1, a
                     <span class="emphasis"><em>value</em></span> - adam.
                  </p>
                  <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Ostrze&#380;enie</h3>Drugi parametr where jest parametrem opcjonalnym.
                     Pomini&#281;cie go grozi usuni&#281;ciem wszystkich rekord&oacute;w w tabeli. 
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2721"></a>Pobieranie danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Jakkolwiek mo&#380;liwe jest pisanie zapyta&#324; SQL i wysy&#322;anie ich do serwera przy pomocy metody
                     <tt class="methodname">query()</tt>, tak w przypadku prostych zapyta&#324; mo&#380;e to by&#263; zbyteczne.
                     Klasa <tt class="classname">Db</tt> wykona to za nas. Oto prosty przyk&#322;ad pobrania wszystkich
                     rekord&oacute;w w bazie, a nast&#281;pnie wy&#347;wietlenie
                     ich:
                  </p><pre class="programlisting">$db = &amp;$this-&gt;db;

		// SELECT * FROM coyote_dev
		$q = $db-&gt;select()-&gt;from('coyote_dev')-&gt;get();

		Core::debug($q-&gt;fetch());</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Metoda
                     debug() z klasy Core, umo&#380;liwia przyjazne wy&#347;wietlenie zawarto&#347;ci tablic, czy obiekt&oacute;w.
                     
                  </div>
                  <p>Metoda <tt class="methodname">select()</tt> pobiera wszystkie kolumny z danej tabeli,
                     okre&#347;lanej w parametrze metody <tt class="methodname">from()</tt>. Obydwie metody zwracaj&#261;
                     instancj&#281; klasy <tt class="classname">Db</tt>. 
                  </p>
                  <p>Metoda <tt class="methodname">get()</tt> generuje zapytanie i wysy&#322;a je do serwera
                     bazodanowego. Zwraca obiekt klasy <tt class="classname">Db_Result</tt>. Wy&#347;wietlenie zawarto&#347;ci
                     pobranych rekord&oacute;w, w formie tablicy, realizuje metoda <tt class="methodname">fetch()</tt> (o tym
                     b&#281;dzie mowa w kolejnym podpunkcie).
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2758"></a>Metoda select()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda <tt class="methodname">select()</tt> s&#322;u&#380;y do okre&#347;lenia jakie kolumny danych tabel
                        zostan&#261; pobrane. Domy&#347;lnie s&#261; to wszystkie kolumny. Mo&#380;na sprecyzowa&#263; jakie kolumny maj&#261;
                        zosta&#263; pobrane, oddzielaj&#261;c je
                        przecinkami:
                     </p><pre class="programlisting">$q = $db-&gt;select('id, value')-&gt;from('coyote_dev')-&gt;get();</pre><p>Metoda <tt class="methodname">select()</tt> przyjmuje r&oacute;wnie&#380; parametry w formie
                        tablicowej:
                     </p><pre class="programlisting">$db = &amp;$this-&gt;db;

		$col = array('id', 'value');
		$q = $db-&gt;select($col)-&gt;from('coyote_dev')-&gt;get();</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2775"></a>Metoda from()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W zapytaniu SELECT mo&#380;emy &#322;&#261;czy&#263; wiele tabel. Parametrem metody
                        <tt class="methodname">from()</tt> mo&#380;e by&#263; albo &#322;a&#324;cuch albo tablica.
                        
                     </p><pre class="programlisting">$col = array('id', 'value');
		$q = $db-&gt;select($col)-&gt;from('coyote_dev, coyote_user')-&gt;get();</pre><p>Pomineli&#347;my w tym zapytaniu warunek WHERE, co spowoduje wykonanie zapytania z iloczynem
                        kartezja&#324;skim. Jednak nie to jest w tym momencie najwa&#380;niejsze. W parametrze metody mo&#380;emy
                        okre&#347;la&#263; r&oacute;wnie&#380; aliasy
                        tabel:
                     </p><pre class="programlisting">$col = array('id', 'value');
		// SELECT id, value FROM coyote_dev d, coyote_user u 
		$q = $db-&gt;select($col)-&gt;from(array('d' =&gt; 'coyote_dev', 'u' =&gt; 'coyote_user'))-&gt;get();</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2789"></a>Metoda where()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W zapytaniach SQL cz&#281;sto musimy okre&#347;la&#263; dodatkowe warunki. W tym celu musimy skorzysta&#263;
                        z metody <tt class="methodname">where()</tt>, kt&oacute;ra podobnie jak metody przedstawione wcze&#347;niej
                        - r&oacute;wnie&#380; zwraca instancj&#281; klasy <tt class="classname">Db</tt>. Poni&#380;sze zapytanie pobierze
                        wszystkich u&#380;ytkownik&oacute;w z tabeli, pod warunkiem, &#380;e ID b&#281;dzie mniejsze od
                        100:
                     </p><pre class="programlisting">$db = &amp;$this-&gt;db;
		$q = $db-&gt;select('user_id, user_name')-&gt;from('coyote_user')-&gt;where('user_id &lt; 100')-&gt;get();</pre><p>Warunki WHERE mog&#261; by&#263; &#322;&#261;czone (domy&#347;lnie operatorem
                        AND):
                     </p><pre class="programlisting">$db = &amp;$this-&gt;db;
		$q = $db-&gt;select('user_id, user_name')-&gt;from('coyote_user')-&gt;
						where('user_id &lt; 100')-&gt;
						where('LENGTH(user_name) &lt; 5')-&gt;get();</pre><p>Powy&#380;sze instrukcje s&#261; adekwatne do wykonania zapytania: <span><b class="command">SELECT user_id,
                              user_name FROM coyote_user WHERE user_id &lt; 100 AND LENGTH(user_name) &lt; 5</b></span>. 
                     </p>
                     <p>Je&#380;eli chcemy po&#322;&#261;czy&#263; obydwa warunki operatorem OR, mo&#380;emy zawrze&#263; warunek w parametrze
                        metody
                        <tt class="methodname">where()</tt>:
                     </p><pre class="programlisting">$db = &amp;$this-&gt;db;
		$q = $db-&gt;select('user_id, user_name')-&gt;from('coyote_user')-&gt;
						where('user_id &lt; 100 OR LENGTH(user_name) &lt; 5')-&gt;
						get();</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2818"></a>Metody order() oraz limit()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metody <tt class="methodname">order()</tt> oraz <tt class="methodname">limit()</tt>
                        odpowiadaj&#261; instrukcj&#261; SQL - ORDER BY oraz
                        LIMIT:
                     </p><pre class="programlisting">$db = &amp;$this-&gt;db;
		$q = $db-&gt;select('user_id, user_name')-&gt;
						from('coyote_user')-&gt;
						where('user_id &lt; 100 OR LENGTH(user_name) &lt; 5')-&gt;
						order('user_id DESC')-&gt;
						limit(0, 10)-&gt;
						get();</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2831"></a>Instrukcje JOIN
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W klasie Db znajduj&#261; si&#281; trzy metody odpowiadaj&#261;ce za zapytanie JOIN:
                        l<tt class="methodname">eftJoin()</tt>, <tt class="methodname">rightJoin()</tt> oraz
                        <tt class="methodname">innerJoin()</tt> odpowiadaj&#261;ce kolejno za zapytania LEFT JOIN, RIGHT
                        JOIN oraz INNER JOIN.
                        Przyk&#322;ad:
                     </p><pre class="programlisting">$q = $this-&gt;db-&gt;select()-&gt;where('user_id &lt; 10')
				 -&gt;leftJoin('coyote_template', 'template_id = user_template')-&gt;get('coyote_user');
		debug($q-&gt;fetch());</pre><p>Pierwszym parametrem metody musi by&#263; nazwa &#322;&#261;czonej tabeli - a drugim - warunek
                        &#322;&#261;czenia.
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Opcjonalnym parametrem metody get() jest nazwa tabeli bazy
                        danych.
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2851"></a>Instrukcja GROUP BY
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Do wstawienia instrukcji GROUP BY, w cia&#322;o zapytania, s&#322;u&#380;y metoda
                        <tt class="methodname">group()</tt>:
                     </p><pre class="programlisting">$this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;group('user_id'); 
// SELECT * FROM coyote_user GROUP BY user_id</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2861"></a>Instrukcja IN
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda <tt class="methodname">in()</tt> umo&#380;liwia wstawienie w zapytaniu instrukcji SQL -
                        IN. U&#380;ycie metody jest proste. Pierwszym jej parametrm musi by&#263; nazwa pola, a drugim -
                        tablica warto&#347;ci:
                        
                     </p><pre class="programlisting">$this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;in('user_id', array(1,2,3))-&gt;get();
// rownoznaczne z :
$this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;where('user_id IN(' . implode(',', array(1,2,3)) . ')')-&gt;get();</pre><p>Jak wi&#281;c widzisz, metoda <tt class="methodname">in()</tt> potrafi skr&oacute;ci&#263; czas pisania
                        instrukcji.
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2876"></a>Metoda like()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda <tt class="methodname">like()</tt> dodaje do zapytania warunek
                        LIKE:
                     </p><pre class="programlisting">$this-&gt;db-&gt;select()-&gt;like('user_name', '%adam%')-&gt;get('coyote_user');
// SELECT * FROM coyote_user WHERE user_name LIKE "%adam%"</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e2886"></a>Klasa Db_Result
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Rezultat wykonania zapytania zwracany jest w postaci instancji klasy dziedziczonej po
                     klasie Db_Result. Przyk&#322;adowo: adapter mysql posiada klas&#281;
                     <tt class="classname">Mysql_Result</tt>, kt&oacute;ra dziedziczy po abstrakcyjnej klasie
                     <tt class="classname">Db_Result</tt>. Abstrakcyjna kalsa <tt class="classname">Db_Result</tt>
                     implementuje interfejsy: <tt class="interfacename">ArrayAccess</tt>,
                     <tt class="interfacename">Iterator</tt>, <tt class="interfacename">Countable</tt>. 
                  </p>
                  <p>Wys&#322;anie zapytania SELECT oraz odczytanie zwr&oacute;conych rekord&oacute;w jest bardzo
                     proste:
                  </p><pre class="programlisting">&lt;?php

class Db_Controller extends Controller
{
	function main()
	{
		$this-&gt;load-&gt;database('mysql', 'localhost', 'root', 'root', 'coyote_dev');

		// SELECT * FROM coyote_dev
		$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();

		foreach ($q as $row)
		{
			echo $row['user_name'] . '&lt;br /&gt;';
		}		
	}
}
?&gt;</pre><p>Klasa implementuje interfejs <tt class="interfacename">Iterator</tt> st&#261;d mo&#380;liwe jest
                     swobodne manewrowanie po wynikach zapytania.
                  </p>
                  <p>Alternatywnym rozwi&#261;zaniem b&#281;dzie u&#380;ycie metody <tt class="methodname">fetch()</tt>, kt&oacute;ra
                     pobiera wszystkie rekordy uzyskane w wyniku zapytania oraz zwraca tablic&#281;
                     wynik&oacute;w:
                  </p><pre class="programlisting">$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();

		foreach ($q-&gt;fetch() as $row)
		{
			echo $row['user_name'] . '&lt;br /&gt;';
			}		</pre><div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e2925"></a>Pobieranie danych
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda <tt class="methodname">fetch()</tt> posiada jeden, opcjonalny parametr, kt&oacute;ry
                        okre&#347;la w jakiej formie maj&#261; by&#263; zwr&oacute;cone dane. Domy&#347;lnie jest to tablica asocjacyjna, lecz
                        w prosty spos&oacute;b mo&#380;emy zwr&oacute;ci&#263; tablic&#281;
                        obiekt&oacute;w:
                     </p><pre class="programlisting">foreach ($q-&gt;fetch(Db::FETCH_OBJ) as $row)
		{
			echo $row-&gt;user_name . '&lt;br /&gt;';
		}</pre><p>Parametrem metody mog&#261; by&#263; nast&#281;puj&#261;ce warto&#347;ci:</p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>Db::FETCH_ASSOC - tablica asocjacyjna</li>
                           <li>Db::FETCH_ARRAY - tablica asocjacyjna oraz tablica numerowana</li>
                           <li>Db::FETCH_ROW - tablica numerowana</li>
                           <li>Db::FETCH_OBJ - obiekty</li>
                        </ul>
                     </div>
                     <p>Metoda <tt class="methodname">fetch()</tt> pobiera w p&#281;tli wszystkie rekordy, zapisuje do
                        tablicy i dopiero zwraca. Je&#380;eli wi&#281;c wy&#347;wietlamy rekordy w p&#281;tli (tak jak w poprzednim
                        przyk&#322;adzie), dokonujemy dw&oacute;ch iteracji. Mo&#380;emy wykorzysta&#263; r&oacute;wnie&#380; metody
                        <tt class="methodname">fetchAssoc()</tt>, <tt class="methodname">fetchArray()</tt>,
                        <tt class="methodname">fetchObject()</tt>,
                        <tt class="methodname">fetchRow()</tt>:
                     </p><pre class="programlisting">		while ($row = $query-&gt;fetchObject())
		{
			echo $row-&gt;user_name . '&lt;br /&gt;';
			}</pre><div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e2965"></a>Interfejs Iterator
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p>Klasa <tt class="classname">Db_Result</tt> implementuje interfejs
                           <tt class="interfacename">Iterator</tt>, co wymusza, aby klasa posiada&#322;a istotne metody
                           umo&#380;liwiaj&#261;ce iteracj&#281; danych. 
                        </p>
                        <p>Zanim przejdziemy do tego, warto wspomnie&#263; o metodzie
                           <tt class="methodname">setFetchMethod()</tt> oraz <tt class="methodname">getFetchMethod()</tt>.
                           Ta pierwsze umo&#380;liwia ustawienie domy&#347;lnego typu zwracanych danych. Domy&#347;lni jest to
                           tablica asocjacyjna, lecz &#322;atwo mo&#380;na to zmieni&#263;, dzi&#281;ki czemu zwracane dane b&#281;d&#261; - np. w
                           formie
                           obiekt&oacute;w:
                        </p><pre class="programlisting">
// SELECT * FROM coyote_dev
$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();
$q-&gt;setFetchMethod(Db::FETCH_OBJ);

foreach ($q as $row)
{
	echo $row-&gt;user_name . '&lt;br /&gt;';
}		</pre><p>Jak powiedzieli&#347;my, klasa implementuje interfejs
                           <tt class="interfacename">Iterator</tt>, wi&#281;c posiada takie metody jak:
                           <tt class="methodname">current()</tt>, <tt class="methodname">next()</tt>,
                           <tt class="methodname">prev()</tt>, <tt class="methodname">key()</tt>,
                           <tt class="methodname">valid()</tt>, <tt class="methodname">rewind()</tt>.
                        </p>
                        <p>Pobranie aktualnego elementu w tablicy wynik&oacute;w zapewnia metoda
                           <tt class="methodname">current()</tt>. Oto przyk&#322;ad pobrania informacji o pierwszym zwr&oacute;conym
                           rekodzie:
                        </p><pre class="programlisting">
 // SELECT * FROM coyote_dev
$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();
$q-&gt;setFetchMethod(Db::FETCH_OBJ);

$current = $q-&gt;current();
echo $current-&gt;user_name;</pre><p>Taki kod spowoduje pobranie pierwszego rekordu. Mo&#380;emy pobra&#263; kolejny u&#380;ywaj&#261;c metody
                           <tt class="methodname">next()</tt>:
                        </p><pre class="programlisting">		$current = $q-&gt;current();
		echo $current-&gt;user_name;

		$q-&gt;next();
		$current = $q-&gt;current();
		echo $current-&gt;user_name;</pre><p>Nale&#380;y wiedzie&#263;, &#380;e metody <tt class="methodname">next()</tt>,
                           <tt class="methodname">rewind()</tt> oraz <tt class="methodname">prev()</tt> zwracaj&#261; instancj&#281;
                           obiektu <tt class="classname">Db_Result</tt> wi&#281;c mo&#380;liwy jest skr&oacute;cony zapis powy&#380;szego
                           kodu:
                        </p><pre class="programlisting">echo $q-&gt;current()-&gt;user_name;
		echo $q-&gt;next()-&gt;current()-&gt;user_name;</pre><p>Jak &#322;atwo si&#281; domy&#347;le&#263;, metoda <tt class="methodname">prev()</tt> s&#322;u&#380;y do cofania
                           kursora w tablicy wynik&oacute;w, a <tt class="methodname">rewind() </tt>ustawia kursor na 0. Jest
                           jeszcze metoda <tt class="methodname">key()</tt> kt&oacute;ra zwraca aktualn&#261; pozycj&#281; kursora w
                           tablicy wynik&oacute;w. 
                        </p>
                     </div>
                     <div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e3050"></a>Interfejs ArrayAccess
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p>Poniewa&#380; klasa <tt class="classname">Db_Result</tt> implementuje r&oacute;wnie&#380; interfejs
                           <tt class="interfacename">ArrayAccess</tt>, mo&#380;liwy jest dost&#281;p do wynik&oacute;w tabeli tak,
                           jakby by&#322;a to zwyk&#322;a tablica. Je&#380;eli chcemy wi&#281;c odczyta&#263; zawarto&#347;&#263; drugiego rekordu,
                           mo&#380;emy zastosowa&#263; taki
                           kod:
                        </p><pre class="programlisting">echo $q[1]-&gt;user_name;
// lub odczyt w p&#281;tli:

// SELECT * FROM coyote_dev
		$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();
		$q-&gt;setFetchMethod(Db::FETCH_OBJ);

		for ($i = 0, $limit = count($q); $i &lt; $limit; $i++)
		{
			echo $q[$i]-&gt;user_name . '&lt;br /&gt;';
		}</pre><p>
                           
                        </p>
                        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                           <h3 class="title">Notatka</h3>Klasa Db_Result implementuje r&oacute;wnie&#380; interfejs Countable, tak wi&#281;c metoda count()
                           wywo&#322;ana na obiekcie, zwraca ilo&#347;&#263; rekord&oacute;w zwr&oacute;conych przez zapytanie. 
                        </div>
                        <p>
                           
                        </p>
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3068"></a>Pobieranie pola z tablicy wynik&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Klasa <tt class="classname">Mysql_Result</tt> posiada metod&#281;
                        <tt class="methodname">fetchField()</tt>, dzi&#281;ki kt&oacute;rej mo&#380;emy pobra&#263; pojedy&#324;cz pole z
                        rekordu:
                     </p><pre class="programlisting">
$sql = 'SELECT COUNT(*) AS total_page
		        FROM coyote_user';
		echo $this-&gt;db-&gt;query($sql)-&gt;fetchField('total_page');</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Identyczny
                        rezultat da u&#380;ycie metody <tt class="methodname">count()</tt> z klasy Db: <span><b class="command">echo
                              $this-&gt;db-&gt;count('coyote_user');</b></span></div>
                     <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Ostrze&#380;enie</h3>Metoda fetchField()
                        zadeklarowana jest w klasie Mysql_Result - nie jest zadeklarowana w klasie bazowej
                        Db_Result. 
                     </div>
                     <p>Inny spos&oacute;b na pobranie warto&#347;ci pola w p&#281;tli:
                        
                     </p><pre class="programlisting">$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();
		$q-&gt;setFetchMethod(Db::FETCH_ASSOC);

		for ($i = 0, $limit = count($q); $i &lt; $limit; $i++)
		{
			$q-&gt;next();

			echo $q-&gt;fetchField('user_name') . '&lt;br /&gt;';
		}</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3094"></a>Informacja o ilo&#347;ci zwr&oacute;conych rekord&oacute;w i p&oacute;l
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Je&#380;eli chcemy pobra&#263; ilo&#347;&#263; rekord&oacute;w zwr&oacute;conych w wyniku ostatniej operacji SELECT,
                        mo&#380;emy wykorzysta&#263; metod&#281; <tt class="methodname">getTotalRows()</tt>:
                        
                     </p><pre class="programlisting">$sql = 'SELECT * FROM coyote_user LIMIT 100';
		$q = $this-&gt;db-&gt;query($sql);

		echo $q-&gt;getTotalRows();</pre><p>Natomiast je&#380;eil chcemy pobra&#263; ilo&#347;&#263; uaktualnionych (dodanych) rekord&oacute;w, musimy
                        wykorzysta&#263; metod&#281; <tt class="methodname">getAffected()</tt>. 
                     </p>
                     <p>Prostszym rozwi&#261;zaniem b&#281;dzie u&#380;ycie funkcji <tt class="function">count()</tt>, kt&oacute;ra zwr&oacute;ci
                        liczba zwr&oacute;conych rekord&oacute;w (w przypadku zapytania SELECT) albo ilo&#347;ci uaktualnionych,
                        usuni&#281;tych
                        rekord&oacute;w:
                     </p><pre class="programlisting">$q = $this-&gt;db-&gt;select()-&gt;from('coyote_user')-&gt;get();
		echo count($q);</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3116"></a>Bezpiecze&#324;stwo
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W procesie wysy&#322;ania zapyta&#324; SQL, szczeg&oacute;ln&#261; uwag&#281; nale&#380;y przywi&#261;za&#263; do bezpiecze&#324;stwa
                     wysy&#322;anych danych. Przyk&#322;adowo, sp&oacute;jrz na poni&#380;szy
                     kod:
                  </p><pre class="programlisting">$username = $_GET['username'];

		$query = "SELECT * FROM coyote_user WHERE user_name = '$username'";
		debug($this-&gt;db-&gt;query($query)-&gt;fetch());</pre><p>Pobieramy tutaj parametr bezpo&#347;rednio z tablicy $_GET, bez &#380;adnego filtrowania danych. Po
                     podstawieniu w miejsce parametru username warto&#347;ci x' OR 1='1 otrzymujemy zapytanie
                     SQL:
                  </p><pre class="programlisting">SELECT * FROM coyote_user WHERE user_name = 'x' OR 1='1'</pre><p>kt&oacute;re pobiera wszystkie rekordy z tabeli. Mo&#380;esz si&#281; przed tym zabezpieczy&#263; u&#380;ywaj&#261;c
                     metody <tt class="methodname">quote()</tt> z klasy <tt class="classname">Db</tt>:
                     
                  </p><pre class="programlisting">$username = $this-&gt;db-&gt;quote($_GET['username']);</pre><p>Jej zadaniem jest rzutowanie na okre&#347;lony typ danych. Tzn. je&#380;eli parametr metody
                     <tt class="methodname">quote()</tt> oka&#380;e si&#281; &#322;a&#324;cuchem, przed znakami specjalnymi dodany
                     zostanie znak \. 
                  </p>
                  <p>Innym rozwi&#261;zaniem b&#281;dzie zastosowanie tzw. mechanizmu za&#347;lepek. Klasa
                     <tt class="classname">Db</tt> zadba w&oacute;wczas o prawid&#322;owy format
                     danych:
                  </p><pre class="programlisting">$sql = "SELECT * FROM coyote_user WHERE user_name = '?'";
		$q = $this-&gt;db-&gt;query($sql, $_GET['username']);

		debug($q-&gt;fetch());</pre><p>W zapytaniu znaki ? zostan&#261; zast&#261;pione warto&#347;ci&#261; przekazan&#261; w parametrze metody
                     <tt class="methodname">query()</tt>. Dodatkowo dane te zostan&#261; zwalidowane przez klas&#281;
                     <tt class="classname">Db</tt>. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji o mechani&#378;mie SQL Injection mo&#380;na znale&#378;&#263;
                     w internecie - tutaj nie b&#281;dziemy dok&#322;adnie omawia&#263; techniki dzia&#322;ania tego mechanizmu.
                     
                  </div>
                  <p>Tak wi&#281;c podsumowuj&#261;c: je&#380;eli chcesz pobiera&#263; dane wprost z tablicy $_GET/$_POST,
                     najlepiej przepu&#347;&#263; je wcze&#347;niej przez metod&#281; <tt class="methodname">quote()</tt> lub u&#380;yj
                     mechanizmu za&#347;lepek. Najlepszym jednak sposobem na zabezpieczenie si&#281; przed atakami XSS oraz
                     SQL Injection, jest niepbieranie danych z tablicy $_POST/$_GET a wykorzystuj&#261;c wewn&#281;trzny
                     mechanizm frameworka, kt&oacute;ry zajmuje si&#281; filtrowaniem zewn&#281;trznych
                     danych:
                  </p><pre class="programlisting">$username = $this-&gt;get-&gt;username;

		$query = "SELECT * FROM coyote_user WHERE user_name = '$username'";
		debug($this-&gt;db-&gt;query($query)-&gt;fetch());</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3166"></a>Mechanizm transakcji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W nowoczesnych systemach bazodanych obs&#322;ugiwane s&#261; mechanizmy transakcji. Tym powinny
                     zaj&#261;c si&#281; adaptery baz danych. Klasa <tt class="classname">Db</tt> posiada trzy metody
                     odpowiadaj&#261;ce za obs&#322;ug&#281; transakcji: <tt class="methodname">begin()</tt>,
                     <tt class="methodname">commit()</tt> oraz
                     <tt class="methodname">rollback()</tt>:
                  </p><pre class="programlisting">try
{
    $this-&gt;db-&gt;begin();
    $this-&gt;db-&gt;query('...');
    $this-&gt;db-&gt;commit();
}
catch (Exception $e)
{
    $this-&gt;db-&gt;rollback();
    echo $e-&gt;getMessage();
}        </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3185"></a>Blokowanie tabel
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Czasem mo&#380;e zaistnie&#263; konieczno&#347;&#263; zablokowania tabeli lub tabel na czas wykonywania
                     operacji. S&#322;u&#380;&#261; do tego metody <tt class="methodname">lock()</tt> oraz
                     <tt class="methodname">unlock()</tt>. W parametrze pierwszej metody nale&#380;y okre&#347;li&#263; nazwy tabel
                     oraz tryb
                     blokady:
                  </p><pre class="programlisting">$this-&gt;db-&gt;lock('coyote_user WRITE', 'coyote_log READ');
//
$this-&gt;db-&gt;unlock();</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3198"></a>Metoda nextId()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zwraca ostatnie ID jakie zosta&#322;o utworzone w wyniku zapytania INSERT.</p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3203"></a>Pobranie wersji systemu bazodanowego
                           </h2>
                        </div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3203"></a>Pobranie wersji systemu bazodanowego
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Ka&#380;dy adapter powinien posiada&#263; metod&#281; <tt class="methodname">version()</tt> kt&oacute;ra zwraca
                     wersj&#281; systemu bazodanowego:
                     
                  </p><pre class="programlisting">
echo $this-&gt;db-&gt;version();      
    </pre><p>(PUSTO)</p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e3217"></a>Rozdzia&#322; 14. Widoki
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e3222">Tworzenie szablonu</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3256">Konfiguracja katalogu z szablonami</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e3278">Zwracanie wyniku w akcji</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3318">Sta&#322;e klasy View</a></span></dt>
                           <dt><span class="section"><a href="#d0e3360">U&#380;ycie &#322;a&#324;cucha</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e3375">Przekazywanie danych do widoku</a></span></dt>
                     <dt><span class="section"><a href="#d0e3395">U&#380;ywanie kodu PHP w szablonach</a></span></dt>
                     <dt><span class="section"><a href="#d0e3441">Klasa View</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3466">Wy&#347;wietlanie zawarto&#347;ci widoku</a></span></dt>
                           <dt><span class="section"><a href="#d0e3482">Przekazywanie danych do widoku</a></span></dt>
                           <dt><span class="section"><a href="#d0e3563">Statyczna metoda getView()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e3587">Klasa widoku</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3598">W&#322;asna klasa widoku</a></span></dt>
                           <dt><span class="section"><a href="#d0e3647">Wywo&#322;ywanie widoku</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e3697">&#321;adowanie klasy View przy pomocy loadera</a></span></dt>
                     <dt><span class="section"><a href="#d0e3715">Konfiguracja widoku</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e3720">Layouty</a></span></dt>
                           <dt><span class="section"><a href="#d0e3761">Okre&#347;lanie nazwy pliku konfiguracji widok&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e3815">Budowa plik&oacute;w konfiguracji</a></span></dt>
                           <dt><span class="section"><a href="#d0e3858">Ustawianie tytu&#322;u dla strony</a></span></dt>
                           <dt><span class="section"><a href="#d0e3898">Ustawianie szablon&oacute;w CSS</a></span></dt>
                           <dt><span class="section"><a href="#d0e4000">Przypisanie skrypt&oacute;w JavaScript</a></span></dt>
                           <dt><span class="section"><a href="#d0e4027">Ustawianie znacznik&oacute;w META</a></span></dt>
                           <dt><span class="section"><a href="#d0e4045">Ustawianie atrybut&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e4067">U&#380;ywanie warto&#347;ci konfiguracyjnych klasy Config</a></span></dt>
                           <dt><span class="section"><a href="#d0e4089">Formaty konfiguracji</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p>Widoki to warstwa aplikacji odpowiadaj&#261;ca za prezentacj&#281; danych. W Coyote typowym
                  adapterem dla widok&oacute;w jest klasa XHTML. Widoki, przewa&#380;nie wy&#347;wietlaj&#261; dane w formie XHTML +
                  CSS, lecz nic nie stoi na przeszkodzie, aby widoki zwraca&#322;y dane w innej formie (XML, PDF,
                  JSON). 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3222"></a>Tworzenie szablonu
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Nim przejdziemy dalej - utw&oacute;rzmy w folderze naszej aplikacji, katalog <tt class="filename">template</tt>. W katalogu b&#281;d&#261; znajdowa&#263; si&#281; sablony zawieraj&#261;ce kod XHTML.
                     Utw&oacute;rz w tym katalogu plik foo.php. Dla naszej aplikacji, przyk&#322;adowy szablon mo&#380;e by&#263;
                     banalny:
                  </p><pre class="programlisting">&lt;h1&gt;Witaj &lt;?= $username; ?&gt;&lt;/h1&gt;
&lt;hr /&gt;</pre><p>W procesie wy&#347;wietlania szablonu, w kodzie <tt class="varname">$username</tt> zostanie
                     zast&#261;piona przez warto&#347;&#263; znajduj&#261;c&#261; si&#281; w tej zmiennej. Utw&oacute;rz teraz kontroler o nazwie
                     Foo. Niech jego przyk&#322;adowy kod b&#281;dzie
                     taki:
                  </p><pre class="programlisting">&lt;?php

class Foo extends Controller
{
	function main()
	{
		$this-&gt;username = 'Adam Boduch';

		return true;
	}
}
?&gt;</pre><p>Mamy tutaj klas&#281; <tt class="classname">Foo</tt> (kontroler Foo) oraz g&#322;&oacute;wn&#261; metod&#281;
                     <tt class="methodname">main()</tt>. Jak widzisz przypisujemy tutaj warto&#347;&#263; pola
                     <tt class="varname">username</tt>, a nast&#281;pnie zwracamy warto&#347;&#263; true. Spowoduje to
                     wy&#347;wietlenie widoku, kt&oacute;ry za&#322;aduje szablon <tt class="filename">foo.php</tt> i przeka&#380;e do
                     niego warto&#347;ci pola z klasy kontrolera (czyli w tym przypadku -
                     <tt class="varname">username</tt>). 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3256"></a>Konfiguracja katalogu z szablonami
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Warto&#347;&#263; <span class="emphasis"><em>core.template</em></span> zawiera nazw&#281; katalogu, w kt&oacute;rym system
                        domy&#347;lnie b&#281;dzie poszukiwa&#322; szablon&oacute;w. Warto&#347;&#263; tego pola jest nadawana automatycznie
                        w klasie <tt class="classname">Core</tt> tylko je&#380;eli nie zosta&#322;a ona wcze&#347;niej
                        zadeklarowana w pliku konfiguracji. Domy&#347;lnie warto&#347;ci&#261; tego pola konfiguracji jest
                        <span class="emphasis"><em>template</em></span>.
                     </p>
                     <p>Mo&#380;esz ustawi&#263; warto&#347;&#263; tego pola w pliku
                        konfiguracyjnym:
                     </p><pre class="programlisting">&lt;core&gt;
    &lt;template&gt;view&lt;/template&gt;
&lt;/core&gt;</pre><p>Mo&#380;esz r&oacute;wnie&#380; ustawi&#263; (nadpisa&#263;) warto&#347;&#263; tego pola w trakcie dzia&#322;ania
                        aplikacji:
                     </p><pre class="programlisting">Config::setItem('core.template', 'view');</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3278"></a>Zwracanie wyniku w akcji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Domy&#347;lnie widok nie jest wywo&#322;ywany, gdy akcja nic nie zwraca (warto&#347;&#263;
                     null):
                  </p><pre class="programlisting">
public function submit()
{
	echo 'Brak wywo&#322;ania widoku!';
}</pre><p>Ten sam rezultat mo&#380;na osi&#261;gn&#261;&#263; zwracaj&#261;c w akcji warto&#347;&#263; false lub u&#380;ywaj&#261;c sta&#322;ej
                     klasy
                     <tt class="classname">View</tt>:
                  </p><pre class="programlisting">
public function submit()
{
	echo 'Brak wywo&#322;ania widoku!';

	return false;
}
// lub:
public function submit()
{
	echo 'Brak wywo&#322;ania widoku!';

	return View::NONE;
}</pre><p>Klasa kontrolera jest inicjalizowana w klasie <tt class="classname">Dispatcher</tt>, a
                     konkretnie w jej metodzie <tt class="methodname">dispatch()</tt>. W tej metodzie odbywa si&#281;
                     sprawdzenie jak&#261; warto&#347;&#263; zwr&oacute;ci&#322;a akcja i w zale&#380;no&#347;ci od wyniku - wygenerowanie lub nie
                     - widoku. 
                  </p>
                  <p>Je&#380;eli akcja zwraca warto&#347;&#263; true wywolany zostanie widok o nazwie odpowiadaj&#261;cej
                     nazwie kontrolera oraz
                     akcji:
                  </p><pre class="programlisting">&lt;?php

class Foo extends Controller
{
	function main()
	{
		$this-&gt;username = 'Adam Boduch';

		return true;
	}

	public function submit()
	{
		return true;
	}
}</pre><p>Metoda (akcja) <tt class="methodname">submit()</tt> zwraca warto&#347;&#263; true, co zaowocuje
                     pr&oacute;b&#261; wywo&#322;ania widoku z szablonem o nazwie <tt class="filename">fooSubmit.php</tt>. Je&#380;eli
                     taki plik nie zostanie odnaleziony - Coyote wy&#347;wietli b&#322;&#261;d. Ta regu&#322;a ma jeden wyj&#261;tek.
                     Je&#380;eli warto&#347;&#263; true zwr&oacute;ci metoda <tt class="methodname">main()</tt>, system b&#281;dzie
                     probowa&#322; odnale&#378;&#263; plik o nazwie odpowiadaj&#261;cej nazwie kontrolera, czyli w tym przypadku
                     - plik <tt class="filename">foo.php</tt>. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3318"></a>Sta&#322;e klasy View
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W klasie <tt class="classname">View</tt> znajduje si&#281; kilka sta&#322;ych, kt&oacute;re mo&#380;emy
                        wykorzysta&#263; w naszym kontrolerze, takich jak:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>NONE = false,</li>
                           <li>MAIN = ''</li>
                           <li>SUCCESS = 'Success',</li>
                           <li>SUBMIT = 'Submit',</li>
                           <li>ERROR = 'Error',</li>
                           <li>DELETE = 'Delete',</li>
                           <li>EDIT = 'Edit'</li>
                        </ul>
                     </div>
                     <p>U&#380;ycie sta&#322;ej <tt class="constant">MAIN</tt> spowoduje pr&oacute;b&#281; wy&#347;wietlenia g&#322;&oacute;wnego
                        widoku
                        kontrolera:
                     </p><pre class="programlisting">
public function submit()
{
	// zaladowanie widoku foo.php
	return VIEW::MAIN;
}</pre><p>Identyczny rezultat przyniesie zwr&oacute;cenie pustego ci&#261;gu
                        znak&oacute;w:
                     </p><pre class="programlisting">
public function submit()
{
	// zaladowanie widoku foo.php
	return '';
}</pre><p>Sta&#322;ych mo&#380;esz z powodzeniem u&#380;ywa&#263;, aby wymusi&#263; za&#322;adowanie danego
                        widoku:
                     </p><pre class="programlisting">
public function submit()
{
    // zaladowanie widoku fooSubmit.php
    return View::SUBMIT;
}</pre><p>Przy u&#380;yciu sta&#322;ych, nazwa widoku, nazwa szablonu kszta&#322;towana jest nast&#281;puj&#261;co:
                        <span class="emphasis"><em>&lt;katalog w kt&oacute;rym umieszczony jest kontroler&gt;&lt;nazwa
                              kontrolera&gt;&lt;warto&#347;&#263; sta&#322;ej&gt;&lt;rozszerzenie dla sablonu&gt;</em></span></p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3360"></a>U&#380;ycie &#322;a&#324;cucha
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Warto&#347;&#263; zwrotna w akcji mo&#380;e by&#263; &#322;a&#324;cuchem danych. &#321;a&#324;cuch (string) mo&#380;e by&#263;
                        substytutem sta&#322;ej. Je&#380;eli zwr&oacute;cony zostanie &#322;a&#324;cuch, system b&#281;dzie pr&oacute;bowa&#322;
                        odnale&#378;&#263; szablon odpowiadaj&#261;cy nast&#281;puj&#261;cemu wzorcowi: <span class="emphasis"><em>&lt;katalog w
                              kt&oacute;rym umieszczony jest kontroler&gt;&lt;nazwa kontrolera&gt;&lt;zwr&oacute;cony
                              &#322;a&#324;cuch&gt;&lt;rozszerzenie dla szablonu&gt;</em></span>. Czyli
                        przyk&#322;adowo:
                     </p><pre class="programlisting">&lt;?php

class Foo_Controller extends Controller
{
	function main()
	{
		echo 'Zarzadznie Foo';
		
		return 'foo';
	}
}
?&gt;</pre><p>W takim przypadku system b&#281;dzie pr&oacute;bowa&#322; odnale&#378;&#263; szablon <tt class="filename">foofoo.php</tt>. 
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3375"></a>Przekazywanie danych do widoku
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Przekazanie danych do widoku wi&#261;&#380;e si&#281; po prostu z przypisaniem danego pola w klasie
                     kontrolera:
                  </p><pre class="programlisting">
function main()
{
	$this-&gt;username = 'Adam Boduch';
	$this-&gt;names = array(
		'Adam',
		'Marta',
		'Karolina'
	);

	return View::MAIN;
}</pre><p>W metodzie <tt class="methodname">main()</tt> przypisujemy dwa pola w klasie -
                     <tt class="varname">username</tt> oraz tablic&#281; <tt class="varname">user</tt>. Warto&#347;ci tych p&oacute;l
                     dost&#281;pne s&#261; w widoku, kt&oacute;ry z kolei przypisuje te dane do szablonu, kt&oacute;ry odpowiada za
                     wy&#347;wietlenie danych w formie akceptowalnej przez u&#380;ytkownika (np. kod
                     HTML):
                  </p><pre class="programlisting">&lt;h1&gt;Witaj &lt;?= $username; ?&gt;&lt;/h1&gt;
&lt;hr /&gt;
&lt;?php foreach ($names as $key =&gt; $name) : ?&gt;
&lt;b&gt;&lt;?= $key; ?&gt;&lt;/b&gt; &lt;?= $name; ?&gt;&lt;/br &gt;
&lt;?php endforeach; ?&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3395"></a>U&#380;ywanie kodu PHP w szablonach
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Generalnie warstwa widoku odpowiada za warstw&#281; prezentacji, a szablony - konkretnie -
                     za wy&#347;wietlenie danych otrzymanych od kontrolera w akceptowalnej formie. Teoretycznie
                     mo&#380;liwe jest u&#380;ywanie w szablonach systemu metaznacznik&oacute;w oraz dodatkowej klasy (np.
                     Smarty), lecz ze wzgl&#281;d&oacute;w wydajno&#347;ciowych oraz praktycznych - zalecane jest u&#380;ywanie
                     kodu PHP do wstawiania w okre&#347;lone miejsce pewnych danych. Mo&#380;na do tego u&#380;y&#263; skr&oacute;towego
                     znacznika dostepnego w
                     PHP:
                  </p><pre class="programlisting">&lt;?= $foo; ?&gt;
&lt;?php echo $foo; // to samo do wy&#380;ej ?&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Aby
                     skr&oacute;towy zapis zadzia&#322;a&#322;, w pliku PHP musi by&#263; w&#322;&#261;czona opcja short_open_tags.
                     
                  </div>
                  <p>Powracaj&#261;c do tematu: jakkolwiek logika aplikacji powinna by&#263; umiejscowiona w
                     kontrolerze, nie wyklucza to u&#380;ywania kodu PHP w
                     widokach:
                  </p><pre class="programlisting">&lt;h1&gt;Witaj &lt;?= $username; ?&gt;&lt;/h1&gt;
&lt;hr /&gt;
&lt;?php foreach ($names as $key =&gt; $name) : ?&gt;
&lt;b&gt;&lt;?= $key; ?&gt;&lt;/b&gt; &lt;?= $name; ?&gt;&lt;/br &gt;
&lt;?php endforeach; ?&gt;

&lt;hr /&gt;
&lt;?= Benchmark::elapsed(); ?&gt;</pre><p>W tym przypadku w szablonie zostanie wstawiony czas generowania strony (metoda
                     <tt class="methodname">elapsed()</tt>). Nale&#380;y jednak unika&#263; wstawiania w szablonach
                     rozbudowanego kodu PHP, gdy&#380; takowy powinien zosta&#263; wykonany w kontrolerze (wzorzec MVC
                     zak&#322;ada rozdzielenie warstwy logiki oraz warstwy prezentacji, aby nie miesza&#263; kodu PHP z
                     kodem XHTML). 
                  </p>
                  <p>W widokach oraz w szablonach mo&#380;liwe jest odwo&#322;ywanie si&#281; do obiekt&oacute;w j&#261;dra. Coyote
                     umo&#380;liwia skr&oacute;cony zapis, z pomini&#281;ciem odwo&#322;ania do samego obiektu j&#261;dra. Poni&#380;sze
                     instrukcje s&#261; sobie
                     r&oacute;wnowa&#380;ne:
                  </p><pre class="programlisting">&lt;hr /&gt;
IP: &lt;?= $input-&gt;getIp(); ?&gt;&lt;br /&gt;
IP: &lt;?= $core-&gt;input-&gt;getIp(); ?&gt;</pre><p>UWAGA! Odwo&#322;ywanie si&#281; do element&oacute;w obiektu poprzez operator <tt class="varname">$this</tt>
                     umo&#380;liwia odwo&#322;ywanie si&#281; do klasy widoku (domy&#347;lnie <tt class="classname">View_XHTML</tt>),
                     a nie do element&oacute;w j&#261;dra. Sp&oacute;jrz na poni&#380;sze dwie
                     instrukcje:
                  </p><pre class="programlisting">B&#322;&#261;d: &lt;?= $this-&gt;input-&gt;getIp(); ?&gt;
Nazwa szablonu: &lt;?= $this-&gt;context-&gt;getName(); ?&gt;</pre><p>Pierwsza instrukcja umieszczona w szablonie pr&oacute;buje odwo&#322;a&#263; si&#281; do nieistniej&#261;cego
                     elementu <tt class="varname">input</tt>, klasy <tt class="classname">View_XHTML</tt>. Druga
                     instrukcja wy&#347;wietla nazw&#281; widoku (metoda <tt class="methodname">getName()</tt> z klasy
                     <tt class="classname">View</tt>). 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3441"></a>Klasa View
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W pokazanych do tej pory, fragmentach kodu, wygenerowaniem widoku zajmuje si&#281; klasa
                     <tt class="classname">Dispatcher</tt>. W rzeczywisto&#347;ci tworzy ona now&#261; instancj&#281; klasy
                     <tt class="classname">View</tt> i przekazuje do niej zawarto&#347;ci p&oacute;l klasy kontrolera. 
                  </p>
                  <p>Nic nie stoi na przeszkodzie, aby&#347;my sami utworzyli instancj&#281; tej klasy i przekazali
                     widokowi warto&#347;ci, kt&oacute;re maj&#261; by&#263; dalej wy&#347;wietlone - czy to w formie kodu XHTML, czy
                     XML itp. W tym celu nale&#380;y utworzy&#263; instancj&#281; klasy <tt class="classname">View</tt>, podaj&#261;c
                     nazw&#281; widoku jako parametr
                     konstruktora:
                  </p><pre class="programlisting">
function main()
{
	$view = new View('foo');

	$view-&gt;username = 'Adam Boduch';
	$view-&gt;names = array(
		'Adam',
		'Marta',
		'Karolina'
	);

	echo $view;

	return false; // nie wykonuj dalszego kodu
}</pre><p>Przypisanie danych do widoku wi&#261;&#380;e si&#281; z przypisaniem warto&#347;ci odpowiednich p&oacute;l.
                     Warto&#347;ci p&oacute;l mog&#261; by&#263; dowolne. Mog&#261; to by&#263; dane skalarne, tablice czy obiekty.
                     Wy&#347;wietlenie widoku wi&#261;&#380;e si&#281; z wywo&#322;aniem metody <tt class="methodname">display()</tt> lub
                     u&#380;yciem skr&oacute;towego
                     zapisu:
                  </p><pre class="programlisting">$view-&gt;display(); // lub:
echo $view;</pre><div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3466"></a>Wy&#347;wietlanie zawarto&#347;ci widoku
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Jak pokaza&#322; powy&#380;szy przyk&#322;ad, wy&#347;wietlenie zawarto&#347;ci widoku nast&#281;puje po u&#380;yciu
                        metody <tt class="methodname">display()</tt>. Prostsze b&#281;dzie u&#380;ycie instrukcji echo na
                        obiekcie klasy, co r&oacute;wnie&#380; spowoduje wy&#347;wietlenie zawarto&#347;ci widoku. Metoda
                        <tt class="methodname">display()</tt> posiada opcjonalny parametr, kt&oacute;ry okre&#347;la,
                        czy zawarto&#347;&#263; widoku ma by&#263; wy&#347;wietlana na ekranie (domy&#347;lnie - true), czy zawarto&#347;&#263;
                        widoku ma by&#263; zwracana w metodzie
                        <tt class="methodname">display()</tt>:
                     </p><pre class="programlisting">
$content = $view-&gt;display(false);
// dodatkowe operacje na $content
echo $content;</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3482"></a>Przekazywanie danych do widoku
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W poprzednich przyk&#322;adach pokazano w jaki spos&oacute;b przekazywa&#263; dane do widoku.
                        Warto&#347;ci mo&#380;na przypisywa&#263; bezpo&#347;rednio do element&oacute;w obiektu typu
                        <tt class="classname">View</tt> lub skorzysta&#263; z metody
                        <tt class="methodname">assign()</tt> lub <tt class="methodname">append()</tt>. Metoda
                        <tt class="methodname">assign()</tt> umo&#380;liwia przypisywanie pojedy&#324;czych element&oacute;w
                        lub tablicy asocjacyjnej. Oto
                        przyk&#322;ad:
                     </p><pre class="programlisting">
$view = new View('foo');

$view-&gt;assign('username', 'Adam Boduch');
$view-&gt;assign(array(
		'password'		=&gt; '123',
		'email'			=&gt; 'user@user.com',
	)
);

echo $view;</pre><p>Teraz, szablon <tt class="filename">foo.php</tt> mo&#380;e wygl&#261;da&#263;
                        tak:
                     </p><pre class="programlisting">
&lt;h1&gt;Witaj &lt;?= $username; ?&gt;&lt;/h1&gt;
&lt;hr /&gt;
&lt;p&gt;Twoje has&#322;o to &lt;?= $password; ?&gt;, a e-mail: &lt;b&gt;&lt;?= $email; ?&gt;&lt;/b&gt;&lt;/p&gt;</pre><p>Kolejny
                        przyk&#322;ad:
                     </p><pre class="programlisting">
$view-&gt;assign('user', array(
				'Adam Boduch', 'Marta', 'Karolina'
			)
		);
// w sablonie:
&lt;?= implode(', ', $user); ?&gt;</pre><p>Metoda <tt class="methodname">assign()</tt> nadpisuje warto&#347;ci przypisane ju&#380;
                        wcze&#347;niej.
                        Przyk&#322;adowo:
                     </p><pre class="programlisting">
$view-&gt;assign('user', array(
				'Adam Boduch', 'Marta', 'Karolina'
			)
);
$view-&gt;assign('user', array(
				'Marek', 'Darek'
			)
);</pre><p>W widoku, <tt class="varname">$user</tt> b&#281;dzie posiada&#322;o warto&#347;&#263; array('Marek',
                        'Darek'). 
                     </p>
                     <p>Metoda <tt class="methodname">append()</tt> umo&#380;liwia dodawanie element&oacute;w do ju&#380;
                        istniej&#261;cej tablicy w widoku. Oto prosty
                        przyk&#322;ad:
                     </p><pre class="programlisting">
$arr = array(
		'Adam Boduch', 'Marta', 'Karolina', 'Marek', 'Darek'
);

foreach ($arr as $element)
{
	$view-&gt;append('user', $element);
}
        </pre><p>W widoku <tt class="varname">$user</tt> b&#281;dzie tablic&#261; imion. Je&#380;eli u&#380;yliby&#347;my metody
                        <tt class="methodname">assign()</tt>, zamiast <tt class="methodname">append()</tt>,
                        warto&#347;ci&#261; <tt class="varname">$user</tt> by&#322;by ci&#261;g Darek. Metody
                        <tt class="methodname">append()</tt> mo&#380;emy u&#380;y&#263; je&#380;eli musimy dokona&#263; w kontrolerze
                        jaki&#347; operacji na tablicy. Gdy&#380; w innym przypadku, mo&#380;emy po prostu przekaza&#263;
                        tablic&#281; do
                        widoku:
                     </p><pre class="programlisting">
$arr = array(
		'Adam Boduch', 'Marta', 'Karolina', 'Marek', 'Darek'
);
$view-&gt;user = $arr;</pre><div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e3550"></a>Przekazywanie parametr&oacute;w w konstruktorze
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p>Konstruktor klasy <tt class="classname">View</tt> posiada opcjonalny parametr
                           <i class="parameter"><tt>$data</tt></i>, kt&oacute;ry mo&#380;e by&#263; tablic&#261; element&oacute;w, kt&oacute;re maj&#261;
                           by&#263; przekazane do widoku. Przyk&#322;adowo, wy&#347;wietlenie widoku wraz z przekazaniem
                           do niego element&oacute;w, mo&#380;emy zrealizowa&#263; przy pomocy jednej
                           instrukcji:
                        </p><pre class="programlisting">
echo $view = new View('foo', array(
        'username'	=&gt; 'Adam Boduch',
        'user'		=&gt; array('Adam Boduch', 'Marta', 'Karolina', 'Marek', 'Darek')
        )
);</pre></div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3563"></a>Statyczna metoda getView()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Klasa <tt class="classname">View</tt> posiada statyczn&#261; metode
                        <tt class="methodname">getView()</tt>, kt&oacute;ra prezentuje si&#281;
                        nast&#281;puj&#261;co:
                     </p><pre class="programlisting">public static function getView($name, $data = array(), IView $instance = null)
	{
		return new View($name, $data, $instance);
	}</pre><p>Metoda zwraca instancj&#281; klasy <tt class="classname">View</tt>. Obiekt tej klasy mo&#380;e
                        by&#263; zwr&oacute;cony w akcji
                        kontrolera:
                     </p><pre class="programlisting">function main()
	{
		return View::getView('foo', array(
			'username'	=&gt; 'Adam Boduch',
			'user'		=&gt; array('Adam Boduch', 'Marta', 'Karolina', 'Marek', 'Darek')
			)
		);
	}</pre><p>lub:</p><pre class="programlisting">	function main()
	{
		$this-&gt;username	= 'Adam Boduch';
		$this-&gt;user		= array('Adam Boduch', 'Marta', 'Karolina', 'Marek', 'Darek');

		return View::getView('foo', array('foo' =&gt; 'bar'));
	}</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3587"></a>Klasa widoku
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Domy&#347;lnie klasa <tt class="classname">View</tt> u&#380;ywa adaptera
                     <tt class="classname">View_XHTML</tt>. Oznacza to, &#380;e domy&#347;lnym typem danych zwracanych
                     przez widok jest typ XHTML. Napiszemy nowy widok, kt&oacute;ry zwr&oacute;ci dane w formacie XML.
                     Mo&#380;na powiedzie&#263;, &#380;e kontroler nie ma wp&#322;ywu na spos&oacute;b prezentowanych danych i nie
                     powinien w to ingerowa&#263;. W naszym przyk&#322;adowym kontrolerze, w zale&#380;no&#347;ci od wybranej
                     opcji - dane zostan&#261; zwr&oacute;cone w formacie XHTML lub XML. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3598"></a>W&#322;asna klasa widoku
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Utw&oacute;rz w katalogu z aplikacja, w folderze <tt class="filename">lib</tt>, katalog
                        <tt class="filename">view</tt>. Umie&#347;&#263; w nim plik <tt class="filename">xml.class.php</tt>.
                        Klasa widoku musi implementowa&#263; interfejs <tt class="interfacename">IView</tt>,
                        kt&oacute;ry zadeklarowany jest w pliku
                        view.class.php:
                     </p><pre class="programlisting">interface IView
{
	public function initialize(&amp;$context);
	public function display($display = true);
}</pre><p>Nasza klasa musi wi&#281;c posiada&#263; dwie metody - <tt class="methodname">initialize()</tt>
                        oraz <tt class="methodname">display()</tt>. W parametrze metody
                        <tt class="methodname">initialize()</tt> zostanie przekazana referencja do obiektu
                        klasy View. Dzi&#281;ki temu, w naszej klasie mo&#380;emy pobiera&#263; dane przekazane do klasy
                        <tt class="classname">View</tt>. 
                     </p>
                     <p>Ok, nasza klasa widoku powinna generowa&#263; dane w postaci XML. Na nasze potrzeby
                        napiszemy bardzo prost&#261;
                        klas&#281;:
                     </p><pre class="programlisting">&lt;?php

class View_Xml implements IView
{
	/**
	 * Instancja klasy View
	 */
	private $context;
	
	/**
	 * Inicjalizacja klasy. Przekazanie do metody instancji do klasy View
	 * @param mixed &amp;$context Referencja do obiektu klasy View
	 */
	public function initialize(&amp;$context)
	{
		$this-&gt;context = $context;
	}

	public function display($display = true)
	{
		$xml = '&lt;?xml version="1.0" encoding="UTF-8" ?&gt;';
		$xml .= '&lt;page&gt;';

		foreach ($this-&gt;context-&gt;getData() as $element =&gt; $value)
		{
			$value = htmlspecialchars($value);
			$xml .= "&lt;$element&gt;$value&lt;/$element&gt;";
		}
		$xml .= '&lt;/page&gt;';

		if ($display)
		{
			echo $xml;
		}
		else
		{
			return $xml;
		}
	}
}
?&gt;</pre><p>Metoda <tt class="methodname">display()</tt> jest wywo&#322;ywana w momencie, gdy
                        u&#380;ytkownik za&#380;&#261;da wy&#347;wietlenia widoku. Pobieramy tutaj wszystkie dane przekazane do
                        widoku, a nast&#281;pnie wy&#347;wietlamy je w postaci znacznik&oacute;w XML. 
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Metoda getData()
                        z klasy View zwraca wszystkie elementy przypisane do widoku. 
                     </div>
                     <p>Wida&#263;, &#380;e ta klasa nie operuje na szablonach - nie jest to w tej chwili konieczne.
                        Niewa&#380;ne wi&#281;c jak&#261; nazw&#281; szablonu poda u&#380;ytkownik - klasa
                        <tt class="classname">View_XML</tt> i tak j&#261; ignoruje. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3647"></a>Wywo&#322;ywanie widoku
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Dobrze, czas napisa&#263; kontroler. Jest on banalnie prosty. Przypisuje warto&#347;ci do
                        dw&oacute;ch p&oacute;l, a nast&#281;pnie - w zale&#380;no&#347;ci od &#380;&#261;dania - wywo&#322;uje odpowiedni
                        widok:
                     </p><pre class="programlisting">&lt;?php

class Foo extends Controller
{
	function main()
	{
		$this-&gt;version = Core::version;
		$this-&gt;foo = "Lorem ipsum ... ";

		if ($this-&gt;get-&gt;type == 'xml')
		{
			return View::getView('xmlData', array(), new View_XML);
		}		
		return View::getView('foo');
	}
}
?&gt;</pre><p>Czyli domy&#347;lnie, dane zostan&#261; wy&#347;wietone w formie strony WWW. Je&#380;eli natomiast do
                        adresu URL do&#322;&#261;czony zostanie parametr <span class="emphasis"><em>type</em></span> - np.
                        <span class="emphasis"><em>http://127.0.0.1/demo/index.php/Foo?type=xml </em></span>- dane zostan&#261;
                        wy&#347;wietlone w formacie XML. Teraz, jeszcze szablon HTML, kt&oacute;ry mo&#380;e wygl&#261;da&#263;
                        tak:
                     </p><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Test&lt;/title&gt;
&lt;head&gt;

&lt;style&gt;
body
{
		margin:			10px auto 10px auto;
		border:			1px solid #ccc;
		width:			80%;
		background-color:		#f8f8f8;
		padding:		10px;
		font-family:	Arial;
}
&lt;/style&gt;

&lt;body&gt;
&lt;p&gt;&lt;?= $version; ?&gt;&lt;/p&gt;
&lt;b&gt;&lt;?= $foo; ?&gt;&lt;/b&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>Bardzo wa&#380;ne w tym kodzie jest nazewnictwo widoku. Klasy widok&oacute;w musz&#261; by&#263;
                        umieszczane w katalogu <tt class="filename">/lib/view</tt>, czy to projektu, czy
                        frameworka. Klasa natomiast musi nosi&#263; przedrostek <span class="emphasis"><em>View</em></span>. Jest
                        to istotne dla loadera Coyote. Ten, pr&oacute;buje odnale&#378;&#263; klas&#281;
                        <tt class="classname">View_XML</tt> (np.) i w momencie, gdy nie mo&#380;e jej odnale&#378;&#263;
                        pr&oacute;buje przeszuka&#263; podkatalogi folderu <tt class="filename">lib</tt>. Na podstawie
                        przedrostka <span class="emphasis"><em>view</em></span>, lokalizuje folder <tt class="filename">view</tt>,
                        a w nim plik <tt class="filename">xml.class.php</tt> kt&oacute;ry odpowiada wzorcowi. W ten
                        spos&oacute;b &#322;aduje ten plik do projektu. 
                     </p>
                     <p>Konstruktor klasy <tt class="classname">View</tt>, r&oacute;wnie&#380; posiada trzeci, opcjonalny
                        parametr <i class="parameter"><tt>$instance</tt></i>, kt&oacute;ry umo&#380;liwia przekazanie klasy widoku
                        w
                        konstruktorze:
                     </p><pre class="programlisting">$view = new View('xmlData', array(), new View_XML);
		$view-&gt;version = Core::version;
		$view-&gt;foo = "Lorem ipsum ... ";

		echo $view;</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3697"></a>&#321;adowanie klasy View przy pomocy loadera
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Kolejnym sposobem za&#322;adowania widoku jest u&#380;ycie loadera, a konkretnie metody
                     <tt class="methodname">view()</tt>:
                  </p><pre class="programlisting">$view = $this-&gt;load-&gt;view('foo');
		$view-&gt;version = Core::version;
		$view-&gt;foo = "Lorem ipsum ... ";

		echo $view;</pre><p>Nag&#322;&oacute;wek metody <tt class="methodname">view()</tt> jest identyczny z nag&#322;&oacute;wkiem
                     konstruktora klasy <tt class="classname">View</tt>, wi&#281;c mo&#380;emy przekazywa&#263; parametry tak
                     samo, jakby&#347;my inicjalizowali klas&#281; bezpo&#347;rednio. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e3715"></a>Konfiguracja widoku
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Pisz&#261;c aplikacje w PHP pod Coyote w wi&#281;kszo&#347;ci przypadk&oacute;w b&#281;d&#261; one wy&#347;wietla&#322;y kod
                     (X)HTML interpretowany przez przegl&#261;darki. Jak wiadomo, najcz&#281;&#347;ciej wraz z kodem XHTML,
                     do pary idzie kod CSS oraz ewentualne skrypty JavaScript. Coyote pomaga zarz&#261;dza&#263; ca&#322;em
                     mechanizmem poprzez pliki konfiguracji szablon&oacute;w. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3720"></a>Layouty
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Obecne strony w wi&#281;kszo&#347;ci przypadk&oacute;w generowane s&#261; dynamicznie, przy pomocy
                        takich j&#281;zyk&oacute;w jakim jest np. PHP. Posiadaj&#261; one wiele podstron, z kt&oacute;rych w
                        wi&#281;kszo&#347;ci niekt&oacute;re elementy s&#261; takie same. We&#378;my np. logo strony (nag&#322;&oacute;wek) oraz
                        stopk&#281;. W wi&#281;kszo&#347;ci stron te elementy s&#261; sta&#322;e na ka&#380;dej podstronie. Mechanizm
                        layout&oacute;w pozwala na utworzenie jednego layoutu, kt&oacute;ry zawiera&#322;by elementy jednakowe
                        dla ka&#380;dej podstrony. 
                     </p>
                     <p>Utw&oacute;rz w katalogu <tt class="filename">template</tt>, plik <tt class="filename">layout.php</tt>, kt&oacute;ry b&#281;dzie naszym layoutem i mo&#380;e zawiera&#263; taki kod
                        XHTML:
                     </p><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Moja pierwsza strona WWW&lt;/title&gt;
&lt;head&gt;

&lt;style&gt;
body
{
		margin:			10px auto 10px auto;
		border:			1px solid #ccc;
		width:			80%;
		background-color:		#f8f8f8;
		padding:		10px;
		font-family:	Arial;
}
&lt;/style&gt;

&lt;body&gt;
&lt;h1&gt;Moja pierwsza strona WWW&lt;/h1&gt;

&lt;?= $this-&gt;content; ?&gt;

&lt;/body&gt;
&lt;/html&gt;</pre><p>W miejsce $this-&gt;content b&#281;dzie wstawiana zawarto&#347;&#263; szablon&oacute;w, kt&oacute;re nie musz&#261;
                        zawiera&#263; ju&#380; kodu umieszczonego w layoucie. Ma to wiele zalet, a jedna z nich jest
                        taka, &#380;e przy zmianie - np. tytu&#322;u strony - wystarczy zmieni&#263; tylko jeden plik
                        (layout). 
                     </p>
                     <p>Utw&oacute;rzmy teraz szablon dla strony g&#322;&oacute;wnej naszego serwisu - np. <tt class="filename">index.php</tt>. Zawarto&#347;&#263; tego szablonu mo&#380;e by&#263;
                        banalna:
                     </p><pre class="programlisting">&lt;p&gt;To jest strona g&#322;&oacute;wna&lt;/p&gt;</pre><p>Teraz widok po&#322;&#261;czy te dwa pliki w jedn&#261; ca&#322;o&#347;&#263; i wy&#347;le do klienta (przegl&#261;darka
                        WWW). Utw&oacute;rz kontroler index.php, kt&oacute;ry mo&#380;e wygl&#261;da&#263;
                        tak:
                     </p><pre class="programlisting">&lt;?php

class Index extends Controller
{
	function main()
	{
		$view = new View('index');
		$view-&gt;setConfig('layout', 'layout');

		echo $view;
	}
}
?&gt;</pre><p>Klasa <tt class="classname">View</tt> posiada metod&#281; <tt class="methodname">setConfig()</tt> kt&oacute;ra s&#322;u&#380;y do
                        ustawiania warto&#347;ci konfiguracyjnych dla widoku. W tym przypadku ustawili&#347;my warto&#347;&#263;
                        pola <span class="emphasis"><em>layout</em></span>, kt&oacute;re wskazuje na nazw&#281; pliku z layoutem (pomijane jest rozszerzenie
                        pliku). Taki kod wygeneruje i po&#322;&#261;czy dwa pliki - layoutu oraz plik szablonu. 
                     </p>
                     <p>Wygodniejsze jest, gdy informacje o layoucie zapisane s&#261; w konfiguracji. Nie
                        musimy si&#281; w&oacute;wczas martwi&#263; o ustawienie odpowiednich warto&#347;ci konfiguracji widoku, w
                        kontrolerze. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3761"></a>Okre&#347;lanie nazwy pliku konfiguracji widok&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Otw&oacute;rz plik konfiguracji aplikacji (u mnie znajduje si&#281; w katalogu <tt class="filename">config/config.xml</tt> mojej aplikacji). Ustawimy w nim warto&#347;&#263; pola
                        <span class="emphasis"><em>core.templateConfig</em></span>:
                     </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;core&gt;
		&lt;templateConfig&gt;config.php&lt;/templateConfig&gt;
	&lt;/core&gt;
&lt;/config&gt;</pre><p>Ustawienie takiego pola spowoduje, i&#380; widok b&#281;dzie poszukiwa&#322; opisu konfiguracji w
                        pliku <tt class="filename">config.php</tt>, w folderze z szablonami (czyli np. w katalogu
                        <tt class="filename">template</tt>). 
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Konfiguracja widok&oacute;w odczytywana jest
                        przez klas&#281; Config, wi&#281;c format plik&oacute;w konfiguracji widok&oacute;w mo&#380;e by&#263; dowolny,
                        bylby by&#322; obslugiwany przez klas&#281; Config. 
                     </div>
                     <p>Nast&#281;pnie w katalogu <tt class="filename">template</tt>, utw&oacute;rz plik <tt class="filename">config.php</tt>:
                     </p><pre class="programlisting">&lt;?php

$config['*'] = array(
	'layout'			=&gt; 'layout'
);

?&gt;</pre><p>Taki zapis oznacza, &#380;e ka&#380;dy szablon w projekcie b&#281;dzie korzysta&#322; z layoutu o
                        nazwie <span class="emphasis"><em>layout</em></span>. Teraz, w akcji wystarczy wywo&#322;a&#263; odpowiedni
                        widok:
                     </p><pre class="programlisting">	function main()
	{
		return View::MAIN;
	}</pre><p>Widok automatycznie odczyta zapis konfiguracji i wygeneruje stron&#281; zgodnie z
                        zapisem. 
                     </p>
                     <p>Mo&#380;esz okre&#347;li&#263; kilka nazw plik&oacute;w zawieraj&#261;cych konfiguracje.
                        Np.:
                     </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;core&gt;
		&lt;templateConfig&gt;config.php&lt;/templateConfig&gt;
&lt;templateConfig&gt;config.ini&lt;/templateConfig&gt;
	&lt;/core&gt;
&lt;/config&gt;</pre><p>W takim przypadku system b&#281;dzie poszukiwa&#322; konfiguracji zar&oacute;wno w pliku <tt class="filename">config.php</tt> jak i <tt class="filename">config.ini</tt>. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3815"></a>Budowa plik&oacute;w konfiguracji
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Domy&#347;lnie formatem plik&oacute;w konfiguracji widok&oacute;w jest XML. Jednak w poprzednim
                        akapicie pokaza&#322;em jak to zmieni&#263;, tak, aby formatem by&#322; PHP. Konfiguracja widok&oacute;w
                        jest taka sama jak pozosta&#322;a konfiguracja w aplikacji. Plik PHP musi posiada&#263;
                        tablic&#281; o nazwie <tt class="varname">$config</tt>, w kt&oacute;rej klucz b&#281;dzie odpowiada&#322; nazwie
                        szablonu. Znak * odpowiada za ka&#380;d&#261; warto&#347;&#263;, tak wi&#281;c klucz
                        <span class="emphasis"><em>box*</em></span> odpowiada zar&oacute;wno szablonowi
                        <span class="emphasis"><em>boxInformation</em></span> jak i <span class="emphasis"><em>boxConfirm</em></span>. 
                     </p>
                     <p>Mechanizm odczytu konfiguracji jest nast&#281;puj&#261;cy: </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>Wczytanie pliku konfiguracji</li>
                           <li>Przeszukanie tablicy konfiguracji i por&oacute;wnanie klucza tablicy z nazw&#261;
                              szablonu
                           </li>
                           <li>Je&#380;eli klucz odpowiada nazwie - dodanie informacji z tablicy do
                              konfiguracji widoku.
                           </li>
                        </ul>
                     </div>
                     <p>Dla przyk&#322;adu - zmie&#324; zawarto&#347;&#263; pliku <tt class="filename">config.php</tt>:
                     </p><pre class="programlisting">&lt;?php

$config['*'] = array(
	'layout'			=&gt; 'layout'
);

$config['index'] = array(
	'layout'			=&gt; false
);

?&gt;</pre><p>Po wczytaniu zwarto&#347;ci tego pliku do klasy, system zacznie przeszukiwa&#263; tablic&#281;
                        <tt class="varname">$config</tt>. Pierwszy element (*) pasuje do ka&#380;dego widoku -
                        zostanie wi&#281;c wczytany do widoku. Kolejny element r&oacute;wnie&#380; odpowiada naszemu
                        szablonowi i r&oacute;wnie&#380; zostanie wczytany. Jednak&#380;e zast&#281;puje on wcze&#347;niej
                        zadeklarowan&#261; warto&#347;&#263; layout, kt&oacute;ra zostanie nadpisana. W wyniku tego nasz szablon
                        b&#281;dzie wy&#347;wietlany samotnie, bez layoutu. 
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                                        Klucz <span class="emphasis"><em>all</em></span> odpowiada ka&#380;demu widokowi, podobnie jak symbol *
                                    
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3858"></a>Ustawianie tytu&#322;u dla strony
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Klasa widoku <tt class="classname">View_Xhtml</tt> &#347;ci&#347;le wsp&oacute;&#322;pracuje z klas&#261;
                        <tt class="classname">Output</tt>. W konfiguracji mo&#380;emy ustawi&#263; tytu&#322; dla
                        poszczeg&oacute;lnych stron naszego serwisu. Warto&#347;&#263; ta przekzywana jest do metody
                        <tt class="methodname">setTitle()</tt> klasy <tt class="classname">Output</tt>. Oto
                        przyk&#322;ad ustawienia tytu&#322;u strony dla szablonu <tt class="filename">index.php</tt>:
                     </p><pre class="programlisting">&lt;?php

$config['*'] = array(
	'layout'			=&gt; 'layout'
);

$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna'
);

?&gt;</pre><p>W rzeczywisto&#347;ci widok przeka&#380;e warto&#347;&#263; pola title do metody
                        <tt class="methodname">setTitle()</tt> klasy <tt class="classname">Output</tt>. To nie
                        wszystko - musimy bowiem okre&#347;li&#263;, w kt&oacute;rym miejscu - w layoucie - ma zosta&#263;
                        wstawiony znacznik &lt;title&gt;. Otw&oacute;rz wi&#281;c plik <tt class="filename">layout.php</tt> i
                        zmie&#324; nag&#322;&oacute;wek
                        strony:
                     </p><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;?= $output-&gt;getTitle(); ?&gt;
&lt;head&gt;</pre><p>Metoda <tt class="methodname">getTitle()</tt> zwr&oacute;ci tytu&#322; dla danej strony w formie
                        znacznika XHTML - &lt;title&gt;. Dzi&#281;ki takiemu zabiegowi mo&#380;na ustala&#263; tytu&#322; dla
                        poszczeg&oacute;lnych stron, nie ingeruj&#261;c w kod kontrolera. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e3898"></a>Ustawianie szablon&oacute;w CSS
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Ustawianie szablon&oacute;w jest podone do ustawiania tytu&#322;&oacute;w dla stron. Przed tem jednak
                        warto zmodyfikowa&#263; plik layoutu, tak, aby pomi&#281;dzy znacznikami &lt;head&gt; wstawiane
                        by&#322;by znaczniki pobierane z klasy
                        <tt class="classname">Output</tt>:
                     </p><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;?= $output-&gt;getTitle(); ?&gt;
&lt;?= $output-&gt;getHttpMeta(); ?&gt;
&lt;?= $output-&gt;getMeta(); ?&gt;
&lt;?= $output-&gt;getStylesheet(); ?&gt;
&lt;?= $output-&gt;getJavaScript(); ?&gt;
&lt;head&gt;

&lt;body&gt;
&lt;h1&gt;Moja pierwsza strona WWW&lt;/h1&gt;

&lt;?= $this-&gt;content; ?&gt;

&lt;/body&gt;
&lt;/html&gt;</pre><p>Metoda <tt class="classname">getStylesheet()</tt> zwraca znaczniki &lt;style&gt; je&#380;eli
                        do klasy <tt class="classname">Output</tt> przekazane zosta&#322;y szablony CSS. Metoda
                        <tt class="methodname">getJavaScript()</tt> zwraca znaczniik &lt;script&gt;. Chc&#261;c
                        przypisa&#263; plik styl&oacute;w CSS do danego szablonu, mo&#380;emy u&#380;y&#263; metody
                        <tt class="methodname">setStylesheet()</tt> z klasy <tt class="classname">Output</tt>:
                        
                     </p><pre class="programlisting">function main()
	{
		$this-&gt;output-&gt;setStylesheet('main');

		return View::MAIN;
	}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Nie
                        ma konieczno&#347;ci podawania pe&#322;nej nazwy pliku. System sam doda rozszerzenie .css
                        do nazy pliku. 
                     </div>
                     <p>Pliki styl&oacute;w CSS powinny by&#263; umieszczone w katalogu z szablonami, tak wi&#281;c u&#380;ycie
                        metody <tt class="methodname">setStylesheet()</tt> tak jak to pokazano w przyk&#322;adzie -
                        spowoduje umieszczenie w layoucie
                        znacznika:
                     </p><pre class="programlisting">&lt;link rel="stylesheet" type="text/css" href="http://127.0.0.1/demo/template/main.css" /&gt;</pre><p>Zamiast integrowa&#263; w kod kontrolera (akcji), mo&#380;na ustali&#263; style CSS dla danego
                        szablonu, z poziomu pliku konfiguracji:
                        
                     </p><pre class="programlisting">&lt;?php

$config['*'] = array(
	'layout'			=&gt; 'layout',
	'stylesheet'		=&gt; 'main'
);

$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna',
);

?&gt;</pre><p>Przyjmujemy, i&#380; dla ka&#380;dej podstrony b&#281;dzie obowi&#261;zywa&#322; ten sam plik styl&oacute;w -
                        <tt class="filename">main.css</tt>. Je&#380;eli chcesz, to zmieni&#263;, wystarczy nadpisa&#263;
                        warto&#347;&#263;, jednocze&#347;nie ustawiaj&#261;c znak minusa przed nazw&#261; szablonu, kt&oacute;ry ma zosta&#263; usuni&#281;ty:
                        <span class="emphasis"><em>stylesheet</em></span>:
                     </p><pre class="programlisting">$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna',
	'stylesheet'		=&gt; array('-main', 'indexStyle')
	);</pre><p>
                        Domy&#347;lnie bowiem ustawienia arkuszy styl&oacute;w nie s&#261; nadpisywane. Tzn. w pliku konfiguracji mo&#380;emy
                        okre&#347;la&#263; wiele arkuszy, tak jak to pokazano w dalszych przyk&#322;adach.
                        
                     </p>
                     <div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e3952"></a>Ustawianie kilku arkuszy
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p>Nieraz arkusze styli podzielone s&#261; na kilka plik&oacute;w i na pewno nie raz przyda&#380;y
                           Ci si&#281; konieczno&#347;&#263; ustawienia kilku arkuszy na jednej stronie (lub podstronie).
                           W Coyote mo&#380;esz ustali&#263; kilka arkuszy w jednym szablonie, oddzielaj&#261;c je
                           przecinkiem:
                        </p><pre class="programlisting">$config['*'] = array(
	'layout'			=&gt; 'layout',
	'stylesheet'		=&gt; 'main,print'
);

$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna',
	'stylesheet'		=&gt; 'foo'
	);</pre><p>
                           W takim przypadku, widok <span class="emphasis"><em>index</em></span> b&#281;dzie zawiera&#322; arkusze main.css, print.css oraz foo.css.
                           
                        </p>
                        <p>
                           Parametr <span class="emphasis"><em>stylesheet</em></span> mo&#380;e by&#263; tablic&#261; arkuszy styli:
                           
                        </p><pre class="programlisting">
'stylesheet'  =&gt; array('foo', 'bar');                         
                    </pre><p>
                           
                        </p>
                     </div>
                     <div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e3972"></a>Okre&#347;lanie podkatalog&oacute;w arkuszy
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p>Arkusze styli musz&#261; by&#263; umieszczone w katalogu z szablonami aplikacji. Nie ma
                           jednak przeciwskaza&#324; do umieszczenia ich w podkatalogach. Mo&#380;esz np. utworzy&#263;, w
                           katalogu <tt class="filename">template</tt>, foler <tt class="filename">css</tt> i tam
                           przechowywa&#263; swoje arkusze. Nie zapomnij jednak ustawi&#263; prawid&#322;owych &#347;cie&#380;ek w
                           konfiguracji. Mo&#380;na to zrobi&#263; w dwojaki spos&oacute;b.
                           Pierwszy:
                        </p><pre class="programlisting">$config['*'] = array(
	'layout'			=&gt; 'layout',
	'stylesheet'		=&gt; 'css/main,css/print'
);</pre><p>Drugi spos&oacute;b pozwala na przypisanie dodatkowych artybut&oacute;w dla znacznika
                           &lt;link&gt;. Poniewa&#380; ustawienie pola konfiguracyjnego stylesheet owocuje w
                           rzeczywisto&#347;ci przekazaniem parametr&oacute;w do metody
                           <tt class="methodname">setStylesheet()</tt>, mo&#380;emy wykorzysta&#263; jej pe&#322;ne
                           mo&#380;liwo&#347;ci. A nag&#322;owek tej metody jest
                           nast&#281;puj&#261;cy:
                        </p><pre class="programlisting">public function setStylesheet($filename, $directiry = '', $options = array())</pre><p>Drugim parametrem metody jest katalog, w kt&oacute;rym b&#281;d&#261; znajdowa&#263; si&#281; arkusze
                           CSS. Ostatnim, opcjonalnym parametrem s&#261; dodatkowe atrybuty dla znacznika XHTML.
                           Tak wi&#281;c taki zapis
                           konfiguracji:
                        </p><pre class="programlisting">$config['*'] = array(
	'layout'			=&gt; 'layout',
	'stylesheet'		=&gt; array('main,print', 'css', array('media' =&gt; 'print'))
);</pre><p>Spowoduje umieszczeniem w layoucie takich odwo&#322;a&#324; do
                           arkuszy:
                        </p><pre class="programlisting">&lt;link rel="stylesheet" type="text/css" href="http://127.0.0.1/demo/template/css/main.css"  media="print"/&gt;
&lt;link rel="stylesheet" type="text/css" href="http://127.0.0.1/demo/template/css/print.css"  media="print"/&gt;</pre></div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4000"></a>Przypisanie skrypt&oacute;w JavaScript
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Skrypty JavaScript cz&#281;sto umo&#380;liwiaj&#261; wzbogacenie strony o elementy dynamiczne
                        niewymagaj&#261;ce u&#380;ycia j&#281;zyka server-side. Przypisanie pliku JavaScript do szablonu
                        jest r&oacute;wnie proste, co przypisanie arkusza
                        styl&oacute;w:
                     </p><pre class="programlisting">$config['*'] = array(
	'layout'			=&gt; 'layout',
	'stylesheet'		=&gt; array(
										array('main'),
										array('print', 'css', array('media' =&gt; 'print'))
						),
	'javascript'		=&gt; 'main'
);</pre><p>Taki zapis konfiguracji oznacza przypisanie do ka&#380;dego szablonu pliku
                        main.js:
                     </p><pre class="programlisting">&lt;script src="http://127.0.0.1/demo/template/js/main.js" type="text/javascript"&gt;&lt;/script&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Coyote
                        automatycznie zak&#322;ada, &#380;e skrypty JavaScript s&#261; umieszczone w podkatalogu js
                        folderu z szablonami. Mo&#380;esz zmieni&#263; lokalizacj&#281; skrypt&oacute;w JavaScript ustawiaj&#261;c
                        pole konfiguracji: core.javascript. 
                     </div>
                     <div class="section" lang="pl">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d0e4013"></a>Kilka skrypt&oacute;w JavaScript na jednej stronie
                                 </h4>
                              </div>
                           </div>
                        </div>
                        <p> Podobnie jak to si&#281; ma w arkuszach styl&oacute;w, istnieje mo&#380;liwo&#347;&#263; do&#322;&#261;czania
                           wielu skrypt&oacute;w JavaScript na jednej stronie. W takim przypadku, mo&#380;na rozdzieil&#263;
                           nazwy znaiem przecinka lub u&#380;y&#263; opcji konfiguracji:
                           <span class="emphasis"><em>javascript</em></span>:
                        </p><pre class="programlisting">'javascript'		=&gt; 'main,foo'</pre><p>lub:</p><pre class="programlisting">'javascript'		=&gt; array('main', 'foo')</pre></div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4027"></a>Ustawianie znacznik&oacute;w META
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Znaczniki &lt;meta&gt; umieszczane s&#261; w nag&#322;&oacute;wku strony i s&#322;u&#380;&#261; do opisu strony -
                        np.: s&#322;&oacute;w kluczowych, opisu czy kodowania znak&oacute;w. Do ustawienia znacznik&oacute;w &lt;meta&gt;
                        na stronie, mo&#380;na u&#380;y&#263; metody <tt class="methodname">setMeta()</tt> lub
                        <tt class="methodname">setHttpMeta()</tt> klasy <tt class="classname">Output</tt>.
                        R&oacute;wnie dobrze mo&#380;emy ustawi&#263; odpowiedni&#261;
                        konfiguracj&#281;:
                     </p><pre class="programlisting">$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna',
	'meta'				=&gt; array(
				'keywords'			=&gt; 'strona, g&#322;&oacute;wna',
				'description'		=&gt; 'To jest strona g&#322;&oacute;wna'
	),
	'httpmeta'		=&gt; array(
				'Content-type'		=&gt; 'text/html; charset=utf-8'
	)
);</pre><p>Dzi&#281;ki takiej konfiguracji, strona b&#281;dzie posiada&#322;a znaczniki description,
                        keywords oraz - ustawione kodowanie na utf-8. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4045"></a>Ustawianie atrybut&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Klasa Output posiada r&oacute;wnie&#380; przydatn&#261; metod&#281;
                        <tt class="methodname">setAttribute()</tt> dzi&#281;ki kt&oacute;rej mo&#380;emy ustawi&#263; (przekaza&#263;)
                        dowolny atrybut do szablonu, kt&oacute;ry nast&#281;pnie mo&#380;emy by&#263; dowolnie interpetowany w
                        szablonie. Atrybuty mog&#261; by&#263; r&oacute;wnie&#380; ustawiane w konfiguracji, w formie tablicy
                        asocjacyjnej:
                     </p><pre class="programlisting">$config['index'] = array(
	'title'				=&gt; 'Strona g&#322;&oacute;wna',
	'meta'				=&gt; array(
				'keywords'			=&gt; 'strona, g&#322;&oacute;wna',
				'description'		=&gt; 'To jest strona g&#322;&oacute;wna'
	),
	'httpmeta'		=&gt; array(
				'Content-type'		=&gt; 'text/html; charset=utf-8'
	),
	'attribute'		=&gt; array(
				'advertisement'		=&gt; true
	)
);</pre><p>W powy&#380;szym przyk&#322;adzie, przekazany zosta&#322; atrybut
                        <span class="emphasis"><em>advertisement</em></span>. W szablonie mo&#380;esz oprogramowa&#263; warunek
                        wykrywaj&#261;cy obecno&#347;&#263; tego atrybutu i - odpowiednio zareagowa&#263;. W tym przyk&#322;adzie
                        ustalamy, &#380;e kod HTML odpowiadaj&#261;cy za reklamy ma si&#281; wy&#347;wietla&#263; jedynie w
                        po&#322;&#261;czeniu z szablonem <tt class="filename">index.php</tt>. Mo&#380;emy doda&#263; odpowiedni
                        warunek w
                        layoucie:
                     </p><pre class="programlisting">&lt;body&gt;
&lt;h1&gt;Moja pierwsza strona WWW&lt;/h1&gt;
&lt;?php if ($output-&gt;getAttribute('advertisement')) : ?&gt;
&lt;p class="advertisement"&gt;REKLAMA&lt;/p&gt;
&lt;?php endif; ?&gt;

&lt;?= $this-&gt;content; ?&gt;

&lt;/body&gt;
&lt;/html&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Wi&#281;cej
                        informacji o mo&#380;liwo&#347;ci ustawienia parametr&oacute;w dla strony, znajdziesz w opisie
                        klasy Output.
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4067"></a>U&#380;ywanie warto&#347;ci konfiguracyjnych klasy Config
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Ka&#380;da strona internetowa ma jaki&#347; tytu&#322;. Mo&#380;esz go zadeklarowa&#263; w pliku
                        konfiguracyjnym swojej
                        aplikacji:
                     </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;config&gt;
	&lt;core&gt;
		&lt;templateConfig&gt;config.php&lt;/templateConfig&gt;
	&lt;/core&gt;

	&lt;site&gt;
		&lt;title&gt;Coyote Demo&lt;/title&gt;
		&lt;description&gt;To jest przyk&#322;adowa strona&lt;/description&gt;
	&lt;/site&gt;
&lt;/config&gt;</pre><p>Najlepszym rozwi&#261;zaniem by&#322;oby, gdyby &oacute;w tytu&#322; umieszczany by&#322; w znaczniku
                        &lt;title&gt; naszej strony. W warto&#347;ciach konfiguracji istnieje mo&#380;liwo&#347;&#263; u&#380;ywania
                        wzorc&oacute;w, kt&oacute;re zostan&#261; zast&#261;pione warto&#347;ciami z konfiguracji aplikacji. Oto przyk&#322;ad
                        takiej konfiguracji
                        szablonu:
                     </p><pre class="programlisting">$config['index'] = array(
	'title'				=&gt; '%site.title% - Strona g&#322;&oacute;wna',
	'meta'				=&gt; array(
				'keywords'			=&gt; 'strona, g&#322;&oacute;wna',
				'description'		=&gt; '%site.description%'
	),
	'httpmeta'		=&gt; array(
				'Content-type'		=&gt; 'text/html; charset=utf-8'
	),
	'attribute'		=&gt; array(
				'advertisement'		=&gt; true
	)
);</pre><p>Warto&#347;ci zaczynaj&#261;ce si&#281; od znaku % oraz ko&#324;cz&#261;ce si&#281; tym znakiem, zostan&#261;
                        zast&#261;pione przed warto&#347;ci z konfiguracji projektu. Oznacza to, &#380;e w miejsce
                        <span class="emphasis"><em>%site.title%</em></span> zostanie wstawiony tytu&#322; strony z pliku
                        <tt class="filename">config.xml </tt>- czyli w tym przypadku - <span class="emphasis"><em>Coyote
                              Demo</em></span>. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4089"></a>Formaty konfiguracji
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Jak wspomniano na pocz&#261;tku tego rozdzia&#322;u, Coyote obs&#322;uguje r&oacute;&#380;ne formaty
                        konfiguracji widk&oacute;w. Domy&#347;lnym formatem jest XML, lecz zalecane jest u&#380;ywanie
                        formatu PHP, ze wzgl&#281;du na wi&#281;ksze mo&#380;liwo&#347;ci oraz brak konieczno&#347;ci parsowania
                        danych. Nic nie stoi jednak na przeszkodzie, aby u&#380;y&#263; inne formatu - np.
                        INI:
                     </p><pre class="programlisting">[all]

layout = layout
stylesheet = main
javascript = main,foo

[index]

title = %site.title% - Strona g&#322;&oacute;wna
meta.keywords = strona, g&#322;&oacute;wna
meta.description = %site.description%
httpmeta.Content-type = text/html; charset=utf-8
attribute.advertisement = true</pre></div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e4096"></a>Rozdzia&#322; 15. Mechanizm routingu
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e4137">Zmienne</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4189">Wyra&#380;enia regularne</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e4207">Operator *</a></span></dt>
                     <dt><span class="section"><a href="#d0e4239">Subdomeny</a></span></dt>
                     <dt><span class="section"><a href="#d0e4258">Generowanie URL</a></span></dt>
                     <dt><span class="section"><a href="#d0e4289">Przechwytywanie wszystkich adres&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e4294">Sortowanie regu&#322;</a></span></dt>
                     <dt><span class="section"><a href="#d0e4310">Grupowanie kontroler&oacute;w w podkatalogach</a></span></dt>
                  </dl>
               </div>
               <p>O mechanizmie URL obs&#322;ugiwanym przez system, by&#322;a ju&#380; mowa we wcze&#347;niejszych fragmentach
                  podr&#281;cznika. Mechanizm routingu zapewnia bardziej zaawansowane metody analizy URL i
                  rozdzielania zada&#324; do odpowiednich kontroler&oacute;w. Standardowy URL rozpoznawany przez system
                  wygl&#261;da tak:
               </p><pre class="programlisting">http://serwer.com/Kontroler/Akcja/Parametry</pre><p>Zak&#322;adaj&#261;c, &#380;e chcemy utworzy&#263; kontroler, kt&oacute;ry b&#281;dzie obs&#322;ugiwa&#322; panel u&#380;ytkownika, nasz
                  URL m&oacute;g&#322;by wygl&#261;da&#263; w ten
                  spos&oacute;b:
               </p><pre class="programlisting">http://serwer.com/User/Main/1</pre><p>Parametrem w tym przypadku jest ID u&#380;ytkownika. Taki URL wygl&#261;da elegancko, lecz m&oacute;g&#322;by
                  wygl&#261;da&#263; lepiej, gdyby&#347;my pomineli nazw&#281; akcji <tt class="methodname">Main</tt>. W tym celu
                  musimy utworzy&#263; now&#261; regu&#322;&#281; routera. Otw&oacute;rz plik konfiguracji projektu (w moim przypadku
                  jest to <tt class="filename">config.xml</tt>) i umie&#347;&#263; w nim nast&#281;puj&#261;ce
                  instrukcje:
               </p><pre class="programlisting">
&lt;route&gt;
    &lt;name&gt;user&lt;/name&gt;
    &lt;url&gt;/User/:id&lt;/url&gt;
    &lt;controller&gt;user&lt;/controller&gt;
    &lt;action&gt;main&lt;/action&gt;
&lt;/route&gt;</pre><p>Utworzyli&#347;my tym samym now&#261; regu&#322;&#281; o nazwie <span class="emphasis"><em>user</em></span>. Mechanizm routingu,
                  przy ka&#380;dorazowym &#380;&#261;daniu sprawdza&#263; b&#281;dzie, czy &#380;&#261;dany URL nie pasuje do kt&oacute;rej&#347; z regu&#322;
                  zapisanych w konfiguracji. Fraza <span class="emphasis"><em>:id</em></span> oznacza tutaj zmienn&#261;. Je&#380;eli nasz
                  URL b&#281;dzie wygl&#261;da&#322; tak: <span><b class="command">/User/1, /User/23423, /User/boduch</b></span>, w&oacute;wczas
                  utworzony zostanie kontroler <tt class="classname">user</tt>, a wykonana akcja
                  <tt class="methodname">main</tt>. Aby korzysta&#263; z mechanizmu routingu nie trzeba inicjalizowa&#263;
                  &#380;adnych dodatkowych klas. Adresy URL s&#261; analizowane przez klas&#281;
                  <tt class="classname">Router</tt>, kt&oacute;ra jest automatycznie inicjalizowana przez framework.
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4137"></a>Zmienne
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W regu&#322;ach routingu mo&#380;emy u&#380;ywa&#263; specjalnych symboli, zaczynaj&#261;cych si&#281; od znaku :
                     (dwukropek). Tak, jak w poprzednim przyk&#322;adzie - w miejsce <span class="emphasis"><em>:id</em></span>
                     spodziewamy si&#281; otrzyma&#263; ID usera, i system routingu powinien bra&#263; to pod uwag&#281;. Warto&#347;&#263;
                     takiej zmiennej zapisywana jest klasie <tt class="classname">Controller</tt>, z kt&oacute;rej
                     dziedzicz&#261; wszystkie kontrolery. St&#261;d, w naszym kontrolerze <tt class="classname">User</tt>,
                     mo&#380;emy w prosty spos&oacute;b odczyta&#263; ID
                     u&#380;ytkownika:
                  </p><pre class="programlisting">
class User extends Controller
{
    function __construct()
    {
        parent::__construct();
        
        if (!$this-&gt;router-&gt;id || $this-&gt;router-&gt;id &lt; 0)
        {
            $this-&gt;redirect('@homepage');
        }
    }

}
            </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Dost&#281;p do klasy Router jest mo&#380;liwy w ka&#380;dym kontrolerze. W klasie bazowej -
                     Controller - tworzona jest referencja do obiektu tej klasy. 
                  </div>
                  <p>System routingu
                     rozpoznaje dwie specjalne zmienne - <span class="emphasis"><em>:controller</em></span> oraz
                     <span class="emphasis"><em>:action</em></span>. P&oacute;jd&#378;my dalej i zmodyfikujmy nasz&#261; regu&#322;&#281; routingu w
                     ten
                     spos&oacute;b:
                  </p><pre class="programlisting">
&lt;route&gt;
    &lt;name&gt;user&lt;/name&gt;
    &lt;url&gt;/User/:id/:controller/:action&lt;/url&gt;
&lt;/route&gt;</pre><p>Tym samym pod postaci&#261; <span class="emphasis"><em>:controller</em></span>, system b&#281;dzie poszukiwa&#322;
                     nazwy kontrolera, a pod <span class="emphasis"><em>:action</em></span> - nazwy akcji. Tak wi&#281;c URL
                     <span><b class="command">/User/1/Portfolio/Submit</b></span> spowoduje pr&oacute;b&#281; wywo&#322;ania metody
                     <tt class="methodname">submit()</tt> z klasy (kontrolera)
                     <tt class="classname">portfolio</tt>. Je&#380;eli natomiast URL b&#281;dzie wygl&#261;da&#322; w ten spos&oacute;b:
                     <span><b class="command">/User/1</b></span> system mo&#380;e mie&#263; problemy ze zidentyfikowaniem nazwy
                     kontrolera oraz akcji. Dlatego w takich wypadkach, warto ustala&#263; warto&#347;ci
                     domy&#347;lne:
                  </p><pre class="programlisting">
 lt;route&gt;
    &lt;name&gt;user&lt;/name&gt;
    &lt;url&gt;/User/:id/:controller/:action&lt;/url&gt;
    &lt;default&gt;
    	&lt;controller&gt;user&lt;/controller&gt;
    	&lt;action&gt;main&lt;/action&gt;
    &lt;/default&gt;
&lt;/route&gt;</pre><p>Dzi&#281;ki temu, zawsze, w przypadku niemo&#380;no&#347;ci odnalezienia nazwy kontrolera oraz akcji
                     - system przybierze warto&#347;ci domy&#347;lne. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4189"></a>Wyra&#380;enia regularne
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Za&#322;&oacute;&#380;my, &#380;e ka&#380;dy u&#380;ytkownik w naszym serwisie identyfikowany jest za pomoc&#261; ID,
                        kt&oacute;re jest liczb&#261;. Natomiast pod nasz&#261; regu&#322;&#281; odpowiada zar&oacute;wno URL <span><b class="command">/User/1</b></span> jak i <span><b class="command">/User/boduch</b></span>. Aby to zmieni&#263; musimy
                        doda&#263; specjalne regu&#322;y wyra&#380;e&#324;
                        regularnych:
                     </p><pre class="programlisting">
&lt;route&gt;
    &lt;name&gt;user&lt;/name&gt;
    &lt;url&gt;/User/:id/:controller/:action&lt;/url&gt;
    &lt;default&gt;
    	&lt;controller&gt;user&lt;/controller&gt;
    	&lt;action&gt;main&lt;/action&gt;
    &lt;/default&gt;
    &lt;requirements&gt;
    	&lt;id&gt;(\d+)&lt;/id&gt;
    &lt;/requirements&gt;
&lt;/route&gt;</pre><p>Dzi&#281;ki temu parametr<span class="emphasis"><em> :id</em></span> zawsze b&#281;dzie dodatkowo sprawdzany.
                        Je&#380;eli nie jest on liczb&#261;, regu&#322;a zostanie odrzucona. 
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4207"></a>Operator *
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Nieraz w adresie chcemy przekaza&#263; dodatkowe parametry. Przyk&#322;adowo: <span><b class="command">/User/1/Portfolio/Submit/Parametr1</b></span> W&oacute;wczas nale&#380;y nieco zmodyfikowa&#263;
                     regu&#322;e routingu, m&oacute;wi&#261;c&#261;, i&#380; by&#263; mo&#380;e do adresu URL b&#281;d&#261; do&#322;&#261;czane dodatkowe parametry i
                     je r&oacute;wnie&#380; nale&#380;y bra&#263; pod
                     uwag&#281;:
                  </p><pre class="programlisting">
&lt;route&gt;
    &lt;name&gt;user&lt;/name&gt;
    &lt;url&gt;/User/:id/:controller/:action/*&lt;/url&gt;
    &lt;default&gt;
    	&lt;controller&gt;user&lt;/controller&gt;
    	&lt;action&gt;main&lt;/action&gt;
    &lt;/default&gt;
    &lt;requirements&gt;
    	&lt;id&gt;(\d+)&lt;/id&gt;
    &lt;/requirements&gt;
&lt;/route&gt;</pre><p>Drobna zmiana polega na dodaniu na ko&#324;cu regu&#322;y operatora *. Parametry przekazane w
                     URL mo&#380;emy odczyta&#263; w
                     kontrolerze:
                  </p><pre class="programlisting">&lt;?php

class User extends Controller
{
	function main($param1)
	{
		echo 'ID usera: ' . $this-&gt;router-&gt;id . '&lt;br /&gt;';
		echo 'Parametr: ' . $param1;
	}
}
?&gt;</pre><p>Dodatkowe parametry przekazywane s&#261; jako parametry akcji (metod). Mo&#380;na r&oacute;wnie&#380;
                     wykorzysta&#263; metod&#281; <tt class="methodname">getArgument()</tt> z klasy
                     <tt class="classname">Router</tt> lub - rozwi&#261;zanie skr&oacute;towe - metod&#281;
                     <tt class="methodname">getArgument()</tt> z klasy
                     <tt class="classname">Controller</tt>:
                  </p><pre class="programlisting">&lt;?php

class User extends Controller
{
	function main($param1)
	{
		echo 'ID usera: ' . $this-&gt;router-&gt;id . '&lt;br /&gt;';
		echo 'Parametr: ' . $param1 . '&lt;br /&gt;';
		echo 'Parametr: ' . $this-&gt;getArgument(0) . '&lt;br /&gt;';
		echo 'Parametr: ' . $this-&gt;getArgument(0) . '&lt;br /&gt;';
	}
}
?&gt;</pre><p>W parametrze metody nale&#380;y poda&#263; numer parametru, kt&oacute;rego warto&#347;&#263; chcemy odczyta&#263;.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4239"></a>Subdomeny
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Niekiedy koniecznym b&#281;dzie, aby nasz serwis obs&#322;ugiwa&#322; subdomeny. Na szcz&#281;&#347;ciej system
                     routingu potrafi opr&oacute;cz URL, zidentyfikowa&#263; r&oacute;wnie&#380; nazw&#281; domeny i - w razie
                     konieczno&#347;ci - wywo&#322;a&#263; odpowiedni kontroler. Powr&oacute;&#263;my do poprzedniego przyk&#322;adu. Chcemy,
                     aby URL w naszym serwisie kszta&#322;tow&#322; si&#281; nast&#281;puj&#261;co: <span><b class="command">http://user.serwer.com/User/1</b></span>. W regule nale&#380;y w&oacute;wczas doda&#263; kolejn&#261;
                     informacje na temat
                     hostu:
                  </p><pre class="programlisting">
&lt;route&gt;
	&lt;name&gt;user&lt;/name&gt;
	&lt;url&gt;/User/:id/:controller/:action/*&lt;/url&gt;
	&lt;default&gt;
		&lt;controller&gt;user&lt;/controller&gt;
		&lt;action&gt;main&lt;/action&gt;
	&lt;/default&gt;
	&lt;requirements&gt;
		&lt;id&gt;(\d+)&lt;/id&gt;
	&lt;/requirements&gt;
	&lt;host&gt;/^(www\.)?user\.(.+$)/&lt;/host&gt;
&lt;/route&gt;</pre><p>Mamy tu wi&#281;c do czynienia z kolejnym wyra&#380;eniem regularnym, kt&oacute;ry sprawdzi obecny host
                     pod k&#261;tem tego, z naszej regu&#322;y <span class="emphasis"><em>user</em></span>. Je&#380;eli chcemy, mo&#380;emy r&oacute;wnie
                     dobrze "na sztywno" wpisa&#263; jaka domena ma by&#263; brana pod uwag&#281; przy tej
                     regule:
                  </p><pre class="programlisting">&lt;host&gt;user.serwer.com&lt;/host&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Je&#380;eli
                     umieszczasz wyra&#380;enie regularne w znaczniku &lt;host&gt;, musi ono by&#263; rozpocz&#281;te i
                     zako&#324;czone znakiem /. 
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4258"></a>Generowanie URL
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Kolejnym tematem jest generowanie URL na podstawie informacji zawartych w regu&#322;ach
                     routingu. Oto prosta regu&#322;a routingu o nazwie
                     homepage:
                  </p><pre class="programlisting">
&lt;route&gt;
	&lt;name&gt;homepage&lt;/name&gt;
	&lt;url&gt;/&lt;/url&gt;
	&lt;controller&gt;index&lt;/controller&gt;
	&lt;action&gt;main&lt;/action&gt;
&lt;/route&gt;</pre><p>Jak widzisz regu&#322;a zostanie dopasowana je&#380;eli &#380;&#261;danie tyczy si&#281; g&#322;&oacute;wnej strony naszego
                     serwisu. Je&#380;eli chcesz wygnerowa&#263; pe&#322;ny URL do g&#322;&oacute;wnej strony, mo&#380;esz skorzysta&#263; z
                     funkcji <tt class="function">url()</tt> z helpera <tt class="filename">url.helper.php</tt>:
                  </p><pre class="programlisting">echo url('@homepage'); // efekt: http://serwer.com/</pre><p>W funkcji <tt class="function">url()</tt> jako parametr, mo&#380;emy poda&#263; nazw&#281; regu&#322;y na
                     podstawie kt&oacute;rej wygenerowany zostanie URL (przed nazw&#261; regu&#322;y nale&#380;y umie&#347;ci&#263; znak @).
                     Inny
                     przyk&#322;ad:
                  </p><pre class="programlisting">
echo url('@user?id=1'); // efekt: http://serwer.com/User/1
echo url('@user?id=1/Parametr1'); // efekt: http://serwer.com/User/1/Parametr1
echo url('@user?id=1&amp;controller=Portfolio'); // efekt: http://serwer.com/User/1/Portfolio
echo url('@user?id=1&amp;a=2'); // efekt: http://serwer.com/User/1?a=2</pre><p>Je&#380;eli wygenerowany URL ma prowadzi&#263; do subdomeny, w regule routingu nale&#380;y ustawi&#263;
                     parametr <span class="emphasis"><em>subdomain</em></span> (opr&oacute;cz paramtru
                     host):
                  </p><pre class="programlisting">
&lt;route&gt;
	&lt;name&gt;user&lt;/name&gt;
	&lt;url&gt;/User/:id/:controller/:action/*&lt;/url&gt;
	&lt;default&gt;
		&lt;controller&gt;user&lt;/controller&gt;
		&lt;action&gt;main&lt;/action&gt;
	&lt;/default&gt;
	&lt;requirements&gt;
		&lt;id&gt;(\d+)&lt;/id&gt;
	&lt;/requirements&gt;
	&lt;host&gt;/^(www\.)?user\.(.+$)/&lt;/host&gt;
&lt;subdomain&gt;user.serwer.com&lt;/subdomain&gt;
&lt;/route&gt;
echo url('@user?id=1'); // efekt: http://user.serwer.com/User/1</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4289"></a>Przechwytywanie wszystkich adres&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Konfiguruj&#261;c regu&#322;&#281; routingu zamiast adresu URL (parametr url); mo&#380;na wpisa&#263; znak *.
                     Oznacza to, &#380;e dana regu&#322;a b&#281;dzie odpowiada&#322;a ka&#380;demu adresowi. Innymi s&#322;owy -
                     ka&#380;dorazowe wywo&#322;anie, obojetnie jakiego adresu URL - spowoduje wykonanie danego
                     kontrolera. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4294"></a>Sortowanie regu&#322;
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa Router odczytuje regu&#322;y w kolejno&#347;ci w jakiej zosta&#322;y one zapisane w pliku
                     konfiguracji. Je&#380;eli dany URL pasuje wzorcowi danej regu&#322;y, system pominie dalsze
                     sprawdzanie i zwr&oacute;ci nazw&#281; kontrolera i akcji. Istnieje mo&#380;liwo&#347;&#263; posortowania regu&#322;,
                     niezale&#380;nie od tego w jakiej kolejno&#347;ci zosta&#322;y one zapisane w pliku konfiguracyjnym.
                     Mo&#380;na wyobrazi&#263; sobie nast&#281;puj&#261;c&#261; sytuacj&#281;: w g&#322;&oacute;wnym pliku konfiguracji aplikacji
                     zadeklarowane s&#261; dane regu&#322;y. Ostatnia regu&#322;a (*) s&#322;u&#380;y do przechwycenia adres&oacute;w, kt&oacute;re
                     nie zosta&#322;y dopasowane do &#380;adnej z regu&#322;. Chcemy np. przekaza&#263; sterowanie do kontrolera,
                     kt&oacute;ry wy&#347;wietli b&#322;&#261;d typu 404, ale dodatkowo - zapisze w bazie danych niedzia&#322;aj&#261;cy
                     adres. Chcemy, aby regu&#322;a * by&#322;a sprawdzana na samym ko&#324;cu. Proste - mo&#380;emy po prostu
                     zadeklarowa&#263; j&#261; na samym ko&#324;cu pliku konfiguracyjnego. Jednak wyobra&#378; sobie sytuacj&#281; w
                     kt&oacute;rej do aplikacji przy&#322;&#261;czane s&#261; dodatkowe modu&#322;y, kt&oacute;re r&oacute;wnie&#380; zawieraj&#261; regu&#322;y
                     routingu. W&oacute;wczas nasza regu&#322;a * nie b&#281;dzie ju&#380; ostatnia. Spowoduje to, i&#380; regu&#322;y
                     zadeklarowane w module nigdy nie b&#281;d&#261; brane pod uwag&#281; - system zako&#324;czy prac&#281; na regule
                     * i pominie dalsze sprawdzanie. 
                  </p>
                  <p>Aby Coyote sortowa&#322; regu&#322;y, musz&#261; one dodatkowo zawiera&#263; parametr order, kt&oacute;ry b&#281;dzie
                     oznacza&#322; ich kolejno&#347;&#263;.
                     Przyk&#322;adowo:
                  </p><pre class="programlisting">	
&lt;route&gt;
	&lt;name&gt;user&lt;/name&gt;
	&lt;url&gt;/User/:id/:controller/:action/*&lt;/url&gt;
	&lt;default&gt;
		&lt;controller&gt;user&lt;/controller&gt;
		&lt;action&gt;main&lt;/action&gt;
	&lt;/default&gt;
	&lt;requirements&gt;
		&lt;id&gt;(\d+)&lt;/id&gt;
	&lt;/requirements&gt;
	&lt;order&gt;1&lt;/order&gt;
&lt;/route&gt;
&lt;route&gt;
	&lt;name&gt;homepage&lt;/name&gt;
	&lt;url&gt;/&lt;/url&gt;
	&lt;controller&gt;index&lt;/controller&gt;
	&lt;action&gt;main&lt;/action&gt;
	&lt;order&gt;2&lt;/order&gt;
&lt;/route&gt;
&lt;route&gt;
	&lt;name&gt;all&lt;/name&gt;
	&lt;url&gt;*&lt;/url&gt;
	&lt;controller&gt;404&lt;/controller&gt;
	&lt;order&gt;5465464&lt;/order&gt;
&lt;/route&gt;</pre><p>Opr&oacute;cz tego, w konfiguracji nale&#380;y utworzy&#263; pole <span class="emphasis"><em>core.sortRoutes</em></span>,
                     aby system wiedzia&#322;, czy ma marnowa&#263; czas na sortowanie
                     regu&#322;:
                  </p><pre class="programlisting">	
&lt;core&gt;
	&lt;sortRoutes&gt;true&lt;/sortRoutes&gt;
&lt;/core&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4310"></a>Grupowanie kontroler&oacute;w w podkatalogach
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Coyote umo&#380;liwia grupowanie kontroler&oacute;w w podkatalogach. Ustalaj&#261;c regu&#322;y routingu
                     musimy zaznaczy&#263; nazw&#281; katalogu je&#380;eli kontroler jest umieszczony w podkatalogu. Okre&#347;la
                     to znacznik <span class="emphasis"><em>folder</em></span>, konfiguracji:
                     
                  </p><pre class="programlisting">&lt;route&gt;
		&lt;name&gt;homepage&lt;/name&gt;
		&lt;url&gt;/&lt;/url&gt;
		&lt;controller&gt;index&lt;/controller&gt;
		&lt;action&gt;main&lt;/action&gt;
		&lt;folder&gt;adm&lt;/folder&gt;
	&lt;/route&gt;</pre><p>W takim przypadku po u&#380;ytkowik - &#380;&#261;daj&#261;c dost&#281;pu do strony g&#322;&oacute;wnej naszego serwisu, w
                     rzeczywisto&#347;ci wczyta kontroler <tt class="filename">index.php</tt>, z katalogu <tt class="filename">/controller/adm</tt>.
                  </p>
                  <p>W regule, w parametrze url, mo&#380;na zawiera&#263; zmienn&#261; <span class="emphasis"><em>:folder</em></span>, tak
                     samo jak robimy to ze zmienn&#261; <span class="emphasis"><em>:controller</em></span>, czy
                     <span class="emphasis"><em>:action</em></span>:
                  </p><pre class="programlisting">&lt;route&gt;
		&lt;name&gt;Foo&lt;/name&gt;
		&lt;url&gt;/User/:folder&lt;/url&gt;
		&lt;controller&gt;404&lt;/controller&gt;
		&lt;default&gt;
			&lt;folder&gt;main&lt;/folder&gt;
		&lt;/default&gt;
	&lt;/route&gt;</pre><p>W tym przyk&#322;adzie, lokalizacja kontrolera zale&#380;y od warto&#347;ci parametru
                     <span class="emphasis"><em>folder</em></span>. Je&#380;eli warto&#347;&#263; tego nie zostanie znaleziona w adresie
                     URL, przyj&#281;ty zostanie domy&#347;lny folder - <tt class="filename">main</tt>. 
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e4349"></a>Rozdzia&#322; 16. Klasa Input
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e4394">Odbieranie formularza metod&#261; HTTP POST</a></span></dt>
                     <dt><span class="section"><a href="#d0e4422">Metoda getMethod()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4436">Metoda getHost()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4446">Metoda getPage()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4453">Metoda getScriptPath()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4467">Metoda getBaseUrl()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4474">Metoda getCurrentUrl()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4479">Metoda getPath()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4484">Metoda getIp()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4489">Metoda getUserAgent()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4497">Metoda getReferer()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4507">Metoda post()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4527">Metoda get()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4547">Metoda cookie()</a></span></dt>
                     <dt><span class="section"><a href="#d0e4572">Metoda server()</a></span></dt>
                  </dl>
               </div>
               <p>Obecne strony WWW bardzo cz&#281;sto zawieraj&#261; ca&#322;&#261; mas&#281; rozmaitych formularzy umo&#380;liwiaj&#261;cych
                  interakcje z u&#380;ytkownikiem oraz rozbudowywania tre&#347;ci strony (Web 2.0). Przyk&#322;adem mo&#380;e by&#263;
                  mo&#380;liwo&#347;&#263; dodawania komentarzy na stronie. Strony generowane s&#261; dynamicznie cz&#281;sto na
                  podstawie czynnik&oacute;w zewn&#281;trznych (danych odczytywanych przez u&#380;ytkownika). Przyk&#322;adem mo&#380;e
                  by&#263; sortowanie listy u&#380;ytkownik&oacute;w oraz stronnicowanie. W&oacute;wczas kolejno&#347;&#263; odczytanych danych
                  oraz ilo&#347;&#263; wy&#347;wietlanych rekord&oacute;w odczytywana jest najcz&#281;&#347;ciej dzi&#281;ki parametrom HTTP GET
                  przekazanym w adresie URL. 
               </p>
               <p>Klasa <tt class="classname">Input</tt> inicjowana jest automatycznie przez framework, w
                  metodzie <tt class="methodname">dispatch()</tt> klasy <tt class="classname">Core</tt>. Umo&#380;liwia
                  ona odczytanie informacji zewn&#281;trznych. W konstruktorze klasy &#322;adowana jest klasa
                  <tt class="classname">Filter</tt> oraz inicjalizowane klasy <tt class="classname">Post</tt>,
                  <tt class="classname">Get</tt>, <tt class="classname">Cookie</tt> oraz
                  <tt class="classname">Server</tt> daj&#261;ce dost&#281;p do tablic globalnych <tt class="varname">$_POST</tt>, <tt class="varname">$_GET</tt>, <tt class="varname">$_COOKIE</tt>,
                  <tt class="varname">$_SERVER</tt>. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Konstruktor klasy sprawdza r&oacute;wnie&#380; ustawienia magic_qutoes_runtime oraz
                  magic_quotes_gpc. Zalecane jest, aby te opcje by&#322;y wy&#322;&#261;czone. 
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4394"></a>Odbieranie formularza metod&#261; HTTP POST
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Utw&oacute;rzmy prosty kontroler, kt&oacute;rego celem b&#281;dzie wy&#347;wietlanie formularza. Po klikni&#281;ciu
                     przycisku <span class="emphasis"><em>Wy&#347;lij</em></span>, zawarto&#347;&#263; formularza b&#281;dzie przesy&#322;ana do odpowiedniej akcji
                     kontrolera. Klasa mo&#380;e wygl&#261;da&#263;
                     tak:
                  </p><pre class="programlisting">&lt;?php

class Index extends Controller
{
	function main()
	{
		$this-&gt;load-&gt;helper('form');
		$this-&gt;load-&gt;helper('url');

		echo Form::open('Index/Submit', array('method' =&gt; 'post'));
		echo Form::input('name') . '&lt;br /&gt;';
		echo Form::submit('', 'Wy&#347;lij');
		echo Form::close();
	}

	public function submit()
	{
	}
}
?&gt;</pre><p>Formularz zostanie przes&#322;any metod&#261; HTTP POST. Takie dane mo&#380;emy odczyta&#263; przy pomocy
                     tablicy globalnej <tt class="varname">$_POST</tt> lub - korzystaj&#261;c z metody <tt class="methodname">post()</tt>
                     klasy
                     <tt class="classname">Input</tt>:
                  </p><pre class="programlisting">
public function submit()
{
    if ($this-&gt;input-&gt;getMethod() == Input::POST)
    {
    	echo $this-&gt;input-&gt;post('name');
    }
}</pre><p>Pierwsza instrukcja sprawdza metod&#281; HTTP; sprawdzamy czy dane wys&#322;ane zosta&#322;y przy
                     pomocy metody HTTP POST. Je&#380;eli tak - odczytujemy zawarto&#347;&#263; pola
                     <span class="emphasis"><em>name</em></span>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4422"></a>Metoda getMethod()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda odczytuje parametr REQUEST_METHOD zwraca metod&#281; HTTP u&#380;yt&#261; w danym &#380;&#261;daniu.
                     Mo&#380;e to by&#263; POST, GET, DELETE, PUT, HEAD. Zwraca ona &#322;a&#324;cuch odpowiadaj&#261;cy nazwie
                     metody. Mo&#380;emy wi&#281;c sprawdzi&#263; metod&#281; &#380;&#261;dania w dwojaki
                     spos&oacute;b:
                  </p><pre class="programlisting">if ($this-&gt;input-&gt;getMethod() == 'POST') ...
// wykorzystanie sta&#322;ych z klasy Input:
if ($this-&gt;input-&gt;getMethod() == Input::POST) ...</pre><p>Do tego celu mo&#380;emy wykorzysta&#263; skr&oacute;cony zapis dzi&#281;ki metodzie
                     <tt class="methodname">isMethod()</tt>:
                  </p><pre class="programlisting">if ($this-&gt;input-&gt;isMethod('POST')) ... 
// lub:
if ($this-&gt;input-&gt;isMethod(Input::POST)) ...</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4436"></a>Metoda getHost()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda <tt class="methodname">getHost()</tt> zwraca aktualny host na jakim uruchomiony
                     jest skrypt:
                     
                  </p><pre class="programlisting">
echo $this-&gt;input-&gt;getHost();                
            </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4446"></a>Metoda getPage()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zwraca &#347;cie&#380;k&#281; do aktualnie przegl&#261;danej strony:
                     
                  </p><pre class="programlisting">
echo $this-&gt;input-&gt;getPage(); // np. /demo/index.php/Index/Submit            
        </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4453"></a>Metoda getScriptPath()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> Metoda zwraca katalog, w kt&oacute;rym umieszczona jest aplikacja wraz z ewentualn&#261; nazw&#261;
                     pliku front controllera (<tt class="filename">index.php</tt>).Przyk&#322;adowo, je&#380;eli umie&#347;ci&#322;e&#347;
                     swoj&#261; aplikacj&#281; w katalogu demo, swojego serwera HTTP, metoda zwr&oacute;ci warto&#347;&#263; <tt class="filename">/demo/</tt> lub <tt class="filename">/demo/index.php/</tt> w zale&#380;no&#347;ci od
                     ustawie&#324; aplikacji. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4467"></a>Metoda getBaseUrl()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> Metoda zwraca bazowy adres WWW dla Twojej strony. Na adres sk&#322;ada si&#281; nazwa hosta
                     (odczytywany automatycznie lub - je&#380;eli zadeklarowano - odczytywany z pola site.host
                     konfiguracji) oraz ewentialna nazwa katalogu, w kt&oacute;rym umieszczona zosta&#322;a aplikacja:
                     
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;getBaseUrl(); // http://127.0.0.1/demo/index.php/</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4474"></a>Metoda getCurrentUrl()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zwraca aktualny adres WWW strony.</p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4479"></a>Metoda getPath()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda odczytuje warto&#347;&#263; PATH_INFO z tablicy globalnej $_SERVER. Warto&#347;&#263; ta
                     automatycznie zostaje poddana procesowi walidacji pod wzgl&#281;dem ataku XSS lub SQL
                     Injection. Metoda automatycznie usunie niebezpieczne znaki (np. cudzys&#322;owia itp), kod
                     HTML. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4484"></a>Metoda getIp()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zwraca aktualny adres IP u&#380;ytkownika.</p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4489"></a>Metoda getUserAgent()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda odczytuje i zwraca warto&#347;&#263; HTTP_USER_AGENT z tablicy globalnej
                     <tt class="varname">$_SERVER</tt>. Warto&#347;&#263; ta jest automatycznie filtrowana pod wzgl&#281;dem
                     atak&oacute;w XSS oraz SQL Injection.
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4497"></a>Metoda getReferer()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda odczytuje warto&#347;&#263; HTTP_REFERER z tablicy <tt class="varname">$_SERVER</tt>.
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Pe&#322;en&#261; list&#281; metod klasy Input mo&#380;esz znale&#378;&#263; w dokumentacji API frameworka.
                     
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4507"></a>Metoda post()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zapewnia dost&#281;p do element&oacute;w tablicy <tt class="varname">$_POST</tt>. W
                     rzeczywisto&#347;ci metoda pobiera i zwraca te dane korzystaj&#261;c z klasy
                     <tt class="classname">Post</tt>. Zwracane dane s&#261; automatycznie filtrowane pod k&#261;tem atak&oacute;w
                     XSS. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji na temat tej klasy znajdziesz w dalszej cz&#281;&#347;ci po&#347;wi&#281;conej
                     klasie Gpc. 
                  </div>
                  <p> Drugim, opcjonalnym parametrem tej metody jest warto&#347;&#263; domy&#347;lna w przypadku, gdy nie
                     mo&#380;na odnale&#378;&#263; podanego klucza w tablicy <tt class="varname">$_POST</tt>.
                     
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;post('name', 'Adam Boduch');
// je&#380;eli brak b&#281;dzie klucza name w tablicy $_POST, zwr&oacute;cona zostanie warto&#347;&#263; Adam Boduch</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4527"></a>Metoda get()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zapewnia dost&#281;p do element&oacute;w tablicy <tt class="varname">$_GET</tt>. W rzeczywisto&#347;ci
                     metoda pobiera i zwraca te dane korzystaj&#261;c z klasy <tt class="classname">Get</tt>. Zwracane
                     dane s&#261; automatycznie filtrowane pod k&#261;tem atak&oacute;w XSS oraz niebezpiecznych
                     znak&oacute;w.
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji na temat tej klasy znajdziesz w dalszej cz&#281;&#347;ci
                     po&#347;wi&#281;conej klasie Gpc. 
                  </div>
                  <p> Drugim, opcjonalnym parametrem tej metody jest warto&#347;&#263; domy&#347;lna w przypadku, gdy nie
                     mo&#380;na odnale&#378;&#263; podanego klucza w tablicy <tt class="varname">$_GET</tt>.
                     
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;get('name', 'Adam Boduch');
// je&#380;eli brak b&#281;dzie klucza name w tablicy $_GET, zwr&oacute;cona zostanie warto&#347;&#263; Adam Boduch</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4547"></a>Metoda cookie()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zapewnia dost&#281;p do element&oacute;w tablicy <tt class="varname">$_COOKIE</tt>. W
                     rzeczywisto&#347;ci metoda pobiera i zwraca te dane korzystaj&#261;c z klasy
                     <tt class="classname">Cookie</tt>. Zwracane dane s&#261; automatycznie filtrowane pod k&#261;tem
                     atak&oacute;w XSS. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji na temat tej klasy znajdziesz w dalszej cz&#281;&#347;ci
                     po&#347;wi&#281;conej klasie Gpc. 
                  </div>
                  <p> Drugim, opcjonalnym parametrem tej metody jest warto&#347;&#263; domy&#347;lna w przypadku, gdy nie
                     mo&#380;na odnale&#378;&#263; podanego klucza w tablicy <tt class="varname">$_COOKIE</tt>.
                     
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;cookie('name', 'Adam Boduch');
// je&#380;eli brak b&#281;dzie klucza name w tablicy $_COOKIE, zwr&oacute;cona zostanie warto&#347;&#263; Adam Boduch</pre><p>Do nazwy ciastka automatycznie do&#322;&#261;czany jest prefiks. Je&#380;eli takowy zosta&#322;
                     zadeklarowany w pliku konfiguracji pod nazw&#261; <span class="emphasis"><em>cookie.prefix</em></span>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4572"></a>Metoda server()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda zapewnia dost&#281;p do element&oacute;w tablicy <tt class="varname">$_SERVER</tt>. W
                     rzeczywisto&#347;ci metoda pobiera i zwraca te dane korzystaj&#261;c z klasy
                     <tt class="classname">Server</tt>.  
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji na temat tej klasy znajdziesz w
                     dalszej cz&#281;&#347;ci po&#347;wi&#281;conej klasie Gpc. 
                  </div>
                  <p> Drugim, opcjonalnym parametrem tej metody jest warto&#347;&#263; domy&#347;lna w przypadku, gdy nie
                     mo&#380;na odnale&#378;&#263; podanego klucza w tablicy <tt class="varname">$_SERVER</tt>.
                     
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;server('HTTP_REFERER', $this-&gt;input-&gt;getBaseUrl());</pre></div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e4592"></a>Rozdzia&#322; 17. Klasa GPC
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e4615">Dost&#281;p do tablic globalnych</a></span></dt>
                     <dt><span class="section"><a href="#d0e4710">Referencja do tablicy</a></span></dt>
                     <dt><span class="section"><a href="#d0e4735">Filtrowanie danych</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4777">Metoda setFilters()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4790">Metoda addFilter()</a></span></dt>
                           <dt><span class="section"><a href="#d0e4804">Dezaktywacja filtr&oacute;w</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e4822">Odczyt oryginalnych danych</a></span></dt>
                     <dt><span class="section"><a href="#d0e4846">Implementacja interfejsu Countable</a></span></dt>
                     <dt><span class="section"><a href="#d0e4862">Implementacja interfejsu ArrayAccess</a></span></dt>
                  </dl>
               </div>
               <p>Abstrakcyjna klasa <tt class="classname">Gpc</tt> jest &#347;ci&#347;le powi&#261;zana z klas&#261;
                  <tt class="classname">Input</tt>. Stanowi ona klas&#281; bazow&#261; dla klas
                  <tt class="classname">Post</tt>, <tt class="classname">Get</tt>, <tt class="classname">Cookie</tt> oraz
                  <tt class="classname">Server</tt>. Zapewnia ona dost&#281;p do globalnych tablic PHP. Z t&#261;
                  r&oacute;&#380;nic&#261; i&#380; udost&#281;pnia ona dodatkowe mechanizmy bezpiecze&#324;stwa zapewniaj&#261;ce filtracj&#281; danych
                  dzi&#281;ki czemu mo&#380;emy zmniejszy&#263; podatno&#347;&#263; aplikacji na ataki typu XSS czy SQL Injection. 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4615"></a>Dost&#281;p do tablic globalnych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W konstruktorze klasy <tt class="classname">Input</tt> nast&#281;puje utworzenie instancji klas
                     <tt class="classname">Post</tt>, <tt class="classname">Get</tt>,
                     <tt class="classname">Cookie</tt> oraz <tt class="classname">Server</tt>, kt&oacute;re to dziedzicz&#261; po
                     klasie <tt class="classname">Gpc</tt>. Tak wi&#281;c dost&#281;p do tych klas mo&#380;liwy jest poprzez
                     pola <tt class="varname">$post</tt>, <tt class="varname">$get</tt>, <tt class="varname">$cookie</tt> oraz
                     <tt class="varname">$server</tt> klasy
                     <tt class="classname">Input</tt>:
                  </p><pre class="programlisting">echo $this-&gt;input-&gt;get('foo'); // skr&oacute;cona wersja
echo $this-&gt;input-&gt;get-&gt;foo; // inna wersja</pre><p>Jak widzisz, mo&#380;emy wykorzysta&#263; metod&#281; <tt class="methodname">get()</tt> z klasy
                     <tt class="classname">Input</tt> lub - bezpo&#347;rednio odwo&#322;a&#263; si&#281; do klasy
                     <tt class="classname">Get</tt> poprzez pole <tt class="varname">$get</tt>, klasy
                     <tt class="classname">Input</tt>. 
                  </p>
                  <p>Ponad to, w konstruktorze klasy <tt class="classname">Controller</tt> tworzone s&#261;
                     referencj&#281; do klas <tt class="classname">Post</tt>, <tt class="classname">Get</tt>,
                     <tt class="classname">Cookie</tt> oraz <tt class="classname">Server</tt> dzi&#281;ki czemu w
                     kontrolerach mo&#380;liwy jest prostszy dost&#281;p do tablic
                     globalnych:
                  </p><pre class="programlisting">
function __construct() 
{
	$this-&gt;router = &amp;Load::loadClass('router');	
	
	$this-&gt;get = &amp;$this-&gt;input-&gt;get;
	$this-&gt;post = &amp;$this-&gt;input-&gt;post;
	$this-&gt;cookie = &amp;$this-&gt;input-&gt;cookie;
	$this-&gt;server = &amp;$this-&gt;input-&gt;server;
}</pre><p>Czyli w konstruktorze, w prosty spos&oacute;b mo&#380;emy si&#281; odwo&#322;a&#263; do tablicy
                     <tt class="varname">$_GET</tt> w ten
                     spos&oacute;b:
                  </p><pre class="programlisting">echo $this-&gt;get-&gt;id; </pre><p>Powy&#380;szy przyk&#322;ad wy&#347;wietli zawarto&#347;&#263; parametru ID, przekazanego metod&#261; GET. Dzi&#281;ki
                     mechanizmowi przeci&#261;&#380;ania mo&#380;emy si&#281; odwo&#322;a&#263; do parametru ID r&oacute;wnie&#380; w ten spos&oacute;b:
                  </p><pre class="programlisting">echo $this-&gt;get-&gt;id();
echo $this-&gt;get-&gt;id('Foo'); </pre><p>W parametrze metody mo&#380;na poda&#263; warto&#347;&#263; domy&#347;ln&#261; w przypadku, gdy nie b&#281;dzie mo&#380;na
                     odnale&#378;&#263; klucza <span class="emphasis"><em>id</em></span> w tablicy <tt class="varname">$_GET</tt>. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4710"></a>Referencja do tablicy
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W konstruktorze klasy <tt class="classname">Gpc</tt>, kt&oacute;ra to jest klas&#261; macierzyst&#261; dla
                     klas <tt class="classname">Post</tt>, <tt class="classname">Get</tt>,
                     <tt class="classname">Cookie</tt>, <tt class="classname">Server</tt> - tworzona jest referencja
                     do tablicy globalnej. Klasa ta nie tworzy wi&#281;c kopii tablicy. Oznacza to, &#380;e modyfikacje
                     tablic globalnych b&#281;d&#261; mia&#322;y wp&#322;yw na zawarto&#347;&#263; danych
                     <tt class="classname">Gpc</tt>:
                  </p><pre class="programlisting">echo $this-&gt;get-&gt;id; 
$_GET['id'] = 'foo';
echo $this-&gt;get-&gt;id; // foo</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4735"></a>Filtrowanie danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W konstruktorze klasy <tt class="classname">Gpc</tt> tworzony jest obiekt klasy
                     <tt class="classname">Filter</tt>. Dzi&#281;ki temu dane pochodz&#261;ce z r&oacute;&#380;nych &#378;r&oacute;de&#322; mog&#261; by&#263;
                     filtrowane na r&oacute;&#380;ne sposoby. Np. domy&#347;lnym filtrem dla klasy <tt class="classname">Post</tt>
                     jest filter XSS. Usuwa on wszelkie potencjalnie, niebezpieczne znaczniki HTML z tekstu.
                     Dodatkowo usuwa on ewentualne niebezpieczne atrybuty znacznik&oacute;w HTML, mog&#261;ce mie&#263;
                     zwi&#261;zek z JavaScript. Filtr w klasie <tt class="classname">Get</tt> jest bardziej
                     rygorystyczny - usuwa on bowiem ka&#380;dy kod HTML, cudzys&#322;owia oraz inne nieportzebne,
                     potencjalnie niebezpieczne znaki. 
                  </p>
                  <p>Mo&#380;emy samodzielnie ustala&#263; filtr w danej klasie, w zale&#380;no&#347;ci od potrzeb.
                     Przyk&#322;adowo: w danym kontrolerze chcemy, aby filtr dla klasy <tt class="classname">Get</tt>,
                     by&#322; mniej rygorystyczny. Chcemy bowiem, aby zamienia&#322; jedynie wszelkie znaki &lt; oraz &gt;
                     na &amp;lt; i &amp;gt; Mo&#380;emy to &#322;atwo zmieni&#263;. Przede wszystkim, uzyskujemy dost&#281;p do
                     obiektu filtra dzi&#281;ki metodzie
                     <tt class="methodname">getFilter()</tt>:
                  </p><pre class="programlisting">&lt;?php

class Index extends Controller
{
	function main()
	{
		// resetowanie ustawien filtra
		$this-&gt;get-&gt;getFilter()-&gt;reset();
		$this-&gt;get-&gt;getFilter()-&gt;addFilter('htmlspecialchars');

		echo $this-&gt;get-&gt;id;
	}
}
?&gt;</pre><p>W metodzie <tt class="methodname">main()</tt> pierwsz&#261; czynno&#347;c&#261; jest czyszczenie
                     obecnych ustawie&#324; filtra dla tej klasy. Nast&#281;pnie dodajemy filtr
                     <span class="emphasis"><em>htmlspecialchars</em></span>, kt&oacute;ry w momencie &#380;&#261;dania odczytu zawarto&#347;ci
                     pola <span class="emphasis"><em>id</em></span> - wywo&#322;a odpowiedni filtr. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wi&#281;cej informacji na temat
                     filtrowania danych znajdziesz w rozdziale po&#347;wi&#281;conym klasie
                     Filter.
                  </div>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Zalecane jest korzystanie z klas Get, Post, Cookie oraz Server
                     do odczytywania zawarto&#347;ci tablic globalnych. Minimalizuje to ryzyko ataku typu SQL
                     Injection lub XSS. 
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4777"></a>Metoda setFilters()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda umo&#380;liwia skr&oacute;towe ustawienie filtr&oacute;w dla danych. Metoda wywo&#322;uje w
                        rzeczywisto&#347;ci metod&#281; <tt class="methodname">setFilters()</tt> z klasy
                        <tt class="classname">Filter</tt>, czyli usuwa z kolejki ju&#380; ustawione filtry i
                        dodaje nowe:
                        
                     </p><pre class="programlisting">$this-&gt;get-&gt;setFilters('htmlspecialchars'); // dodanie jednego filtru - htmlspecialchars</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4790"></a>Metoda addFilter()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda umo&#380;liwia skr&oacute;towe dodanie nowego filtra bez konieczno&#347;ci odwo&#322;ania si&#281; do
                        obiektu klasy <tt class="classname">Filter</tt>. Innymi s&#322;owy wywo&#322;uje metod&#281;
                        <tt class="methodname">addFilter()</tt> z klasy <tt class="classname">Filter</tt>,
                        powoduj&#261;cym tym samym dodanie nowego filrta na koniec kolejki. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4804"></a>Dezaktywacja filtr&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Je&#380;eli nie chcemy, aby dane by&#322;y filtrowane w danym &#380;&#261;daniu, mo&#380;emy dezaktywowa&#263;
                        wszystkie filtry, korzystaj&#261;c z metody <tt class="methodname">disableFilter()</tt>,
                        klasy
                        <tt class="classname">Gpc</tt>:
                     </p><pre class="programlisting">$this-&gt;get-&gt;disableFilter();</pre><p>Aby przywr&oacute;ci&#263; filtrowanie danych, nale&#380;y wywo&#322;a&#263; metod&#281;
                        <tt class="methodname">enableFilter()</tt>.
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4822"></a>Odczyt oryginalnych danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Gpc</tt> posiada metod&#281; <tt class="methodname">value()</tt>
                     dzi&#281;ki kt&oacute;rej mo&#380;esz odczyta&#263; oryginaln&#261; warto&#347;&#263; przekazan&#261; w tablicy globalnej (dane
                     nie s&#261; w jakikolwiek modyfikowane przez Coyote).
                     Przyk&#322;ad:
                  </p><pre class="programlisting">&lt;?php
// np. http://127.0.0.1/demo/index.php/Index/Main?id=&lt;b&gt;adam&lt;/b&gt;
class Index extends Controller
{
	function main()
	{
		echo $this-&gt;get-&gt;value('id');
	}
}
?&gt;</pre><p>Taki skrypt wy&#347;wietli oryginaln&#261; warto&#347;&#263; przekazan&#261; w parametrze id. </p>
                  <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Ostrze&#380;enie</h3>Jako &#380;e
                     klasy dziedzicz&#261;ce po Gpc zawieraj&#261; referencj&#281; do tablic globalnych, filtrowanie
                     danych zmienia r&oacute;wnie&#380; warto&#347;&#263; tablic globalnych.
                  </div>
                  <p>Filtrowanie danych zmienia warto&#347;&#263; tablic globalnych, wi&#281;c kolejne u&#380;ycie metody
                     <tt class="methodname">value()</tt> w danym &#380;&#261;daniu wy&#347;wietli przefiltrowan&#261;
                     warto&#347;&#263;:
                  </p><pre class="programlisting">// np. http://127.0.0.1/demo/index.php/Index/Main?id=&lt;b&gt;adam&lt;/b&gt;
class Index extends Controller
{
	function main()
	{
echo $this-&gt;get-&gt;id; // wy&#347;wietli: adam
		echo $this-&gt;get-&gt;value('id'); // wy&#347;wietli: ada
	}
}
?&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4846"></a>Implementacja interfejsu Countable
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Gpc</tt> implementuje interfejs
                     <tt class="interfacename">Countable</tt>. Oznacza to, &#380;e w prosty spos&oacute;b mo&#380;liwe jest
                     odczytanie ilo&#347;ci element&oacute;w z tablicy globalnej (przy pomocy funkcji <tt class="function">count()</tt>):
                  </p><pre class="programlisting">&lt;?php

class Index extends Controller
{
	function main()
	{
		echo count($this-&gt;get);
	}
}
?&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4862"></a>Implementacja interfejsu ArrayAccess
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Poniewa&#380; klasa <tt class="classname">Gpc</tt> implementuje interfejs
                     <tt class="interfacename">ArrayAccess</tt>, w klasach dziedzicz&#261;cych po
                     <tt class="classname">Gpc</tt>, mo&#380;liwy jest dostep do element&oacute;w jak do zwyk&#322;ych
                     tablic:
                  </p><pre class="programlisting">echo $_GET['id'];
echo $this-&gt;get['id'];
$this-&gt;get['id'] = 2;
echo $this-&gt;get['id'];
echo $_GET['id'];</pre><p>Takie zastosowanie jest praktyczne je&#380;eli parametr $_GET jest tablica i chcemy w prosty spos&oacute;b uzyska&#263; dost&#281;p do jej elementu:
                     
                  </p><pre class="programlisting">
 // np. http://127.0.0.1/demo/index.php/Index/Main?id[]=2&amp;id[]=3
 echo $this-&gt;get['id'][1]; 
 
 Core::debug($this-&gt;get-&gt;id);
            </pre><p>
                     
                  </p>
                  <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Ostrze&#380;enie</h3>Je&#380;eli parametrem jest tablica (jak parametr id w poprzednim przyk&#322;adzie), klasa Gpc przefiltruje r&oacute;wnie&#380; elementy tej tablicy.
                  </div>
                  <p>
                     
                     
                  </p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e4886"></a>Rozdzia&#322; 18. Klasa Model
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e4913">Pobieranie danych z tabeli</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4946">&#321;&#261;czenie tabel</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e4975">Metoda locate()</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e4999">Okre&#347;lanie prefiksu</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e5035">Okre&#347;lanie klucza g&#322;&oacute;wnego</a></span></dt>
                     <dt><span class="section"><a href="#d0e5052">Skr&oacute;cone operacje na bazie</a></span></dt>
                  </dl>
               </div>
               <p>Powiedzieli&#347;my wcze&#347;niej, i&#380; model mo&#380;e operowa&#263; na danych pochodz&#261;cych z r&oacute;&#380;nych &#378;r&oacute;de&#322;.
                  Bardzo cz&#281;sto s&#261; to jednak dane pochodz&#261;ce z bazy i dlatego klasa
                  <tt class="classname">Model</tt> (kt&oacute;ra jest klas&#261; bazow&#261; dla wszystkich modeli) posiada metody
                  u&#380;yteczne w manipulowaniu danymi. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Klasa Model dziedziczy po klasie Context i jest
                  klas&#261; abstrakcyjn&#261;. Oznacza to, &#380;e z poziomu modeli mo&#380;liwy jest &#322;atwy dost&#281;p do
                  element&oacute;w sk&#322;adowych j&#261;dra. 
               </div>
               <p>Zacznijmy od utworzenia modela. W katalogu <tt class="filename">model</tt> swojego projektu,
                  utw&oacute;rz plik <tt class="filename">user.model.php</tt>. B&#281;dzie to prosta klasa o takiej
                  postaci:
               </p><pre class="programlisting">
&lt;?php

class User_Model extends Model
{
    protected $name = 'coyote_user';
}

?&gt;</pre><p>Jak widzisz, dodali&#347;my w klasie chronione pole <tt class="varname">$name</tt> okre&#347;laj&#261;ce nazw&#281;
                  tabeli, do kt&oacute;rej odwo&#322;ywa&#322; si&#281; b&#281;dzie model. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Klasa Modelu musi posiada&#263; sufiks
                  _Model. 
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4913"></a>Pobieranie danych z tabeli
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Model</tt> udost&#281;pnia przydatn&#261; metod&#281;
                     <tt class="methodname">fetch()</tt>, kt&oacute;ra umo&#380;liwia pobranie rekord&oacute;w danej tabeli. Je&#380;eli
                     posiadamy ju&#380; model (w naszym przyk&#322;adzie nazywa si&#281; <tt class="classname">User_Model</tt>)
                     mo&#380;emy za&#322;adowa&#263; go w kontrolerze, a nast&#281;pnie pobra&#263; i wy&#347;wietil&#263;
                     dane:
                  </p><pre class="programlisting">		$user = &amp;$this-&gt;load-&gt;model('user');
// pobierz wszystkie rekordy
$q = $user-&gt;fetch();
// wyswietl rekordy w formie tablicy
$this-&gt;debug($q-&gt;fetch());</pre><p>Tym sposobem pobrali&#347;my wszystkie rekordy z tabeli <span class="emphasis"><em>coyote_user</em></span>.
                     Metoda <tt class="methodname">fetch()</tt> posiada parametry, dzi&#281;ki kt&oacute;rym mo&#380;emy okre&#347;li&#263;
                     warunki pobrania rekord&oacute;w z tabeli SQL. Pierwszy parametr okre&#347;la warunek
                     WHERE:
                  </p><pre class="programlisting">$q = $user-&gt;fetch('user_id &lt; 100');</pre><p>Tym sposobem pobrane zostan&#261; rekordy, kt&oacute;rych kolumna <span class="emphasis"><em>user_id</em></span>
                     jest mniejsza ni&#380; 100. Kolejne, opcjonalne parametry oznaczaj&#261;: kolejno&#347;&#263; sortowania
                     danych oraz numer pierwszego pobieranego rekordu oraz ich limit:
                     
                  </p><pre class="programlisting">// SELECT * FROM coyote_user WHERE user_id &lt; 100 ORDER BY user_id DESC LIMIT 10, 10
$q = $user-&gt;fetch('user_id &lt; 100', 'user_id DESC', 10, 10);</pre><div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4946"></a>&#321;&#261;czenie tabel
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W procesie normalizacji unikamy powt&oacute;rze&#324; pewnych danych przenosz&#261;c je do innych
                        tabel. Przyk&#322;adowo w tabeli u&#380;ytkownik&oacute;w znajduje si&#281; kolumna
                        <span class="emphasis"><em>user_location</em></span>, kt&oacute;ra jest kluczm obcym do tabeli
                        <span class="emphasis"><em>coyote_location</em></span>. Ta natomiast zawiera spis miejscowo&#347;ci.
                        Pobieraj&#261;c dane u&#380;ytkownik&oacute;w chcieliby&#347;my mie&#263; od razu nazw&#281; miejscowo&#347;ci, nie w
                        postaci ID, ale &#322;a&#324;cucha znak&oacute;w. W klasie modelu musimy okre&#347;li&#263; referencj&#281; do
                        tabel, w spos&oacute;b nast&#281;puj&#261;cy:
                        
                     </p><pre class="programlisting">	protected $reference = array(
                    
                    'location'		=&gt; array(
                    'table'			=&gt; 'coyote_location',
                    'col'			=&gt; 'user_location',
                    'refCol'		=&gt; 'location_id'
                    )
);</pre><p>Utworzyli&#347;my w ten spos&oacute;b relacj&#281; w jeden do jednego w naszej tabeli. Nowe
                        odwo&#322;anie odnosi si&#281; do tabeli <span class="emphasis"><em>coyote_location</em></span>. Informujemy
                        system, &#380;e z&#322;&#261;czenie odbywa si&#281; na kolumnach <span class="emphasis"><em>user_location</em></span> i
                        <span class="emphasis"><em>location_id</em></span>. W ten spos&oacute;b, wywo&#322;uj&#261;c metod&#281;
                        <tt class="methodname">fetch()</tt> pobieramy dane z dw&oacute;ch
                        tabel:
                     </p><pre class="programlisting">$q = $user-&gt;fetch(null, null, 10);
$this-&gt;debug($q-&gt;fetch());</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e4975"></a>Metoda locate()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda <tt class="methodname">locate()</tt> pozwala na lokalizacj&#281; rekord&oacute;w spe&#322;niaj&#261;cych
                     okre&#347;lone warunki. Pierwszym parametrem metody musi by&#263; nazwa kolumny po kt&oacute;rej odb&#281;dzie
                     si&#281; szukanie. Drugi parametr musi by&#263; tablic&#261; zawieraj&#261;c&#261; argumenty do
                     znalezenia:
                  </p><pre class="programlisting">$q = $user-&gt;locate('user_name', array('Admin', 'Adam'));
$this-&gt;debug($q-&gt;fetch());</pre><p>Takie instrukcje spowoduj&#261; przeszukanie tabeli <span class="emphasis"><em>coyoter_user</em></span> pod
                     k&#261;tem wyst&#281;powania w kolunie <span class="emphasis"><em>user_name</em></span> warto&#347;ci
                     <span class="emphasis"><em>Admin</em></span> lub <span class="emphasis"><em>Adam</em></span>. Znalezione rezultaty zostan&#261;
                     zwr&oacute;cone w formie tablicy asocjacyjnej. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e4999"></a>Okre&#347;lanie prefiksu
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Projektuj&#261;c struktur&#281; tabel w bazie danych u&#380;ywam specyficznego zapisu nazw
                        kolumn. Przewa&#380;nie kolumny danej tabeli posiadaj&#261; prefiks, w zale&#380;no&#347;ci od nazwy
                        tabeli. Przyk&#322;adowo, je&#380;eli nazwa tabeli to <span class="emphasis"><em>coyote_user</em></span>, kolumy
                        &oacute;w tabeli b&#281;d&#261; posiada&#322;y przedrostek <span class="emphasis"><em>user_</em></span> - np.
                        <span class="emphasis"><em>user_id</em></span>, <span class="emphasis"><em>user_name</em></span>,
                        <span class="emphasis"><em>user_email</em></span> itd. Prefiks mo&#380;emy ustali&#263; w klasie
                        modelu:
                     </p><pre class="programlisting">class User_Model extends Model
{
     protected $name = 'coyote_user';
     protected $prefix = 'user_';
}</pre><p>Dzi&#281;ki temu mo&#380;emy u&#380;ywa&#263; skr&oacute;conego zapisu, zamiast stosowa&#263; metode
                        <tt class="methodname">locate()</tt>.
                        Przyk&#322;adowo:
                     </p><pre class="programlisting">$q = $user-&gt;getByName('Adam');
$this-&gt;debug($q-&gt;fetch());</pre><p>System "domy&#347;li si&#281;", i&#380; chcemy przeszuka&#263; tabel&#281; pod k&#261;tem pola
                        <span class="emphasis"><em>user_name</em></span>. W parametrze takiej metody mo&#380;emy poda&#263; kilka
                        warto&#347;ci:
                     </p><pre class="programlisting">$q = $user-&gt;getByName('Marcin', 'Adam');</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5035"></a>Okre&#347;lanie klucza g&#322;&oacute;wnego
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>W klasie modelu mo&#380;emy dodatkowo okre&#347;li&#263; nazw&#281; klucza g&#322;&oacute;wnego. Dzi&#281;ki temu b&#281;dziemy
                     mogli u&#380;y&#263; metody <tt class="methodname">find()</tt> kt&oacute;ra przeszukuje rekordy pod k&#261;tem
                     klucza g&#322;&oacute;wnego. W tym celu w klasie modelu musimy dokona&#263; kolejnej
                     zmiany:
                  </p><pre class="programlisting">class User_Model extends Model
{
      protected $name = 'coyote_user';
      protected $prefix = 'user_';
      protected $primary = 'user_id';
}</pre><p>Teraz, w kontrolerze, nast&#281;puj&#261;ce u&#380;ycie zwr&oacute;ci rekordy, kt&oacute;rych
                     <span class="emphasis"><em>user_id</em></span> = 1 i
                     2:
                  </p><pre class="programlisting">		$q = $user-&gt;find(1, 2);
$this-&gt;debug($q-&gt;fetch());</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5052"></a>Skr&oacute;cone operacje na bazie
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Model</tt> udost&#281;pnia (podobnie jak <tt class="classname">Db</tt>)
                     metody <tt class="methodname">select()</tt>, <tt class="methodname">insert()</tt>,
                     <tt class="methodname">update()</tt>, <tt class="methodname">delete()</tt> itp. Jest to
                     skr&oacute;cony zapis poniewa&#380; nie musimy w takim przypadku podawa&#263; nazwy
                     tabeli:
                  </p><pre class="programlisting">		$user = &amp;$this-&gt;load-&gt;model('user');
                
$user-&gt;insert(array('user_name' =&gt; 'Foo'));
$id = $user-&gt;nextId();
                
$user-&gt;update(array('user_name' =&gt; 'Bar'), 'user_id = ' . $id);
$user-&gt;delete('user_id = ' . $id);</pre></div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e5077"></a>Rozdzia&#322; 19. Triggery
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e5093">W&#322;&#261;czanie trigger&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e5102">Pisanie zdarze&#324;</a></span></dt>
                     <dt><span class="section"><a href="#d0e5165">Przypisywanie zdarze&#324; w pliku konfiguracyjnym</a></span></dt>
                     <dt><span class="section"><a href="#d0e5179">Triggery dost&#281;pne w systemie</a></span></dt>
                     <dt><span class="section"><a href="#d0e5253">Przekazywanie parametr&oacute;w do zdarzenia</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5278">Przekazywanie parametr&oacute;w przez referencj&#281;</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p>Triggery, czyli wyzwalacze umo&#380;liwiaj&#261; wykonanie dodatkowych instrukcji w zale&#380;no&#347;ci od
                  zaistnia&#322;ych sytuacji. Przyk&#322;adowo, chcemy wykona&#263; jakie&#347; instrukcje w momencie, gdy system
                  jest gotowy - jeszcze przed inicjalizacj&#261; kontrolera. Przyk&#322;ady mo&#380;na mno&#380;y&#263;: mo&#380;emy wykona&#263;
                  jakie&#347; dodatkowe instrukcje gdy do przegl&#261;darki zostanie wys&#322;any widok (np. wy&#347;wietlaj&#261;c
                  czas generowania strony - w sumie). 
               </p>
               <p>Kolejny przyk&#322;ad: masz w swojej aplikacji system komentarzy. Istnieje mo&#380;liwo&#347;&#263;
                  komentowania artyku&#322;&oacute;w, news&oacute;w, czy galerii. Za ka&#380;dym razem, przed dodaniem komentarzy,
                  chcemy przefiltrowa&#263; tre&#347;&#263; komentarza pod k&#261;tem kodu HTML (w celu jego usuni&#281;cia). Mo&#380;emy
                  oczywi&#347;cie za ka&#380;dym razem przed dodaniem komentarza, filtrowa&#263; jego
                  tre&#347;&#263;:
               </p><pre class="programlisting">$comment = htmlspecialchars($comment);
// dodaj komentarz</pre><p>Za&#322;&oacute;&#380;my
                  teraz, &#380;e chcemy, aby w panelu administracyjnym naszej strony by&#322;a mo&#380;liwo&#347;&#263;, w jakich
                  dzia&#322;ach (modu&#322;ach) dozwolone b&#281;dzie u&#380;ywanie kodu HTML, a w jakich nie. Mo&#380;emy oczywi&#347;cie w
                  ka&#380;dym module doda&#263; instrukcj&#281;
                  warunkow&#261;:
               </p><pre class="programlisting">if ($filter_html)
{
    $comment = htmlspecialchars($comment);
}
// dodaj komentarz</pre><p>Lepszym
                  rozwi&#261;zaniem w takim wypadku b&#281;dzie trigger. Przed dodaniem komentarza mo&#380;emy wywo&#322;a&#263;
                  trigger:
               </p><pre class="programlisting">Trigger::call('comment.onBeforeSubmit', array(&amp;$comment)); 
// dodanie komentarza</pre><p>W&oacute;wczas
                  system sprawdzi, czy do triggera comment.onBeforeSubmit s&#261; przypisane jakie&#347; zdarzenia (czy
                  to funkcje, czy metody) i je&#380;eli tak - wywo&#322;a je. 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5093"></a>W&#322;&#261;czanie trigger&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Funkcja trigger&oacute;w musi zosta&#263; aktywowana. W pliku konfiguracyjnym projektu, dodaj
                     nast&#281;puj&#261;c&#261; opcj&#281;
                     konfiguracji:
                  </p><pre class="programlisting">$config['core']['trigger'] = true;</pre><p>Od tego momentu b&#281;dziesz m&oacute;g&#322; korzysta&#263; z trigger&oacute;w w swojej aplikacji. </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5102"></a>Pisanie zdarze&#324;
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Utw&oacute;rz nowy kontroler w swoim projekcie. Dla przyk&#322;adu, dodamy zdarzenie dla triggera
                     <span class="emphasis"><em>system.onShutdown</em></span>. Jest to trigger, kt&oacute;ry wywo&#322;ywany jest w
                     momencie, gdy kod kontroler&oacute;w zostanie wywo&#322;any. Jest to zako&#324;czenie dzia&#322;ania
                     aplikacji, w tym momencie najcz&#281;&#347;ciej kod HTML zosta&#322; wys&#322;any do przegl&#261;darki. Mo&#380;emy
                     oprogramowa&#263; dodatkowe zdarzenie, bez modyfikacji kodu kontroler&oacute;w. 
                  </p>
                  <p>Niech nasz przyk&#322;adowy kontroler przybie&#380;e tak&#261;
                     posta&#263;:
                  </p><pre class="programlisting">
&lt;?php

class Foo extends Controller
{
    public function Bar()
    {
        echo 'System zako&#324;czy&#322; dzia&#322;anie&lt;br /&gt;';
        echo 'Czas generowania strony: ' . Benchmark::elapsed();
    }
    
    function main()
    {
        Trigger::add('system.onShutdown', array('class' =&gt; 'Foo', 'function' =&gt; 'Bar'));
    }
}
?&gt;</pre><p>W tym momencie po zako&#324;czeniu generowania wszystkich instrukcji, zostanie wykonany kod
                     z metody <tt class="methodname">Bar()</tt>. W tym momencie (w metodzie
                     <tt class="methodname">main()</tt>) dodali&#347;my nowe zdarzenie dla triggera
                     <span class="emphasis"><em>system.onShutdown</em></span>. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Wywo&#322;anie tego triggera znajduje si&#281; w
                     pliku core.class.php frameworka. 
                  </div>
                  <p>Pierwszym parametrem musi by&#263; nazwa triggea, a drugim - tablica zawieraj&#261;ca informacje
                     o lokalizacji kodu, kt&oacute;ry zamierzamy wykona&#263;. Tablica mo&#380;e mie&#263; nast&#281;puj&#261;ce klucze:
                  </p>
                  <div class="table"><a name="d0e5129"></a><p class="title"><b>Tabela 19.1. Opcje konfiguracji dla zdarzenia</b></p>
                     <table summary="Opcje konfiguracji dla zdarzenia" border="1">
                        <colgroup>
                           <col>
                           <col>
                        </colgroup>
                        <thead>
                           <tr>
                              <th>Klucz</th>
                              <th>Opis</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>function</td>
                              <td>Nazwa funkcji, kt&oacute;ra zostanie wykonana. Mo&#380;e to by&#263; r&oacute;wnie&#380; nazwa
                                                             metody.
                              </td>
                           </tr>
                           <tr>
                              <td>class</td>
                              <td>Nazwa klasy. Mo&#380;e zawiera&#263; &#322;a&#324;cuch okre&#347;laj&#261;cy nazw&#281; klasy lub
                                                             referencj&#281; do obiektu.
                              </td>
                           </tr>
                           <tr>
                              <td>path</td>
                              <td>Nasz kod mo&#380;e by&#263; zawarty w zewn&#281;trznym pliku. W&oacute;wczas klasa Trigger
                                                             za&#322;aduje ten plik przy pomocy instrukcji include_once()
                              </td>
                           </tr>
                           <tr>
                              <td>params</td>
                              <td>Dodatkowe parametry jakie zostan&#261; przekazane do zdarzenia.</td>
                           </tr>
                           <tr>
                              <td>eval</td>
                              <td>Dodatkowy kod PHP, kt&oacute;ry zostanie wykonany (parametr funkcji
                                                         eval())
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5165"></a>Przypisywanie zdarze&#324; w pliku konfiguracyjnym
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> W pliku konfiguracyjnym mo&#380;emy okre&#347;li&#263; zdarzenia dla danego triggera. W&oacute;wczas zb&#281;dne
                     staje si&#281; r&#281;czne przypisywanie przy pomocy metody <tt class="methodname">add()</tt>.
                     Przyk&#322;adowo, mo&#380;emy przypisa&#263; zdarzenia dla triggera system.shutdown w pliku config.php:
                     
                  </p><pre class="programlisting">
// obsluga hookow (triggerow)
$config['core']['trigger'] = true;

$config['trigger']['system.onShutdown'][] = array(
    'class'			=&gt; 'debug',
    'function'		=&gt; 'explain',
    'params'		=&gt; array()
);

$config['trigger']['system.onShutdown'][] = array(
    'class'			=&gt; 'foo',
    'function'		=&gt; 'bar'
);            
            </pre><p>
                     Jak widzisz, w rezultacie takiej konfiguracji do triggera
                     <span class="emphasis"><em>system.onShutdown</em></span>, zosta&#322;y przypisane dwa zdarzenia. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5179"></a>Triggery dost&#281;pne w systemie
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>We frameworku istnieje kilka trigger&oacute;w, kt&oacute;re zosta&#322;y przedstawione w tabeli poni&#380;ej.
                     Dzi&#281;ki nim mo&#380;emy w naszej aplikacji odpowiednio zareagowa&#263; w momencie ich wywo&#322;ania
                     (np. wykona&#263; dodatkowy kod przed faktyczn&#261; inicjalizacj&#261; i wykonaniem akcji). 
                  </p>
                  <div class="table"><a name="d0e5184"></a><p class="title"><b>Tabela 19.2. Triggery dost&#281;pne w systemie</b></p>
                     <table summary="Triggery dost&#281;pne w systemie" border="1">
                        <colgroup>
                           <col>
                           <col>
                           <col>
                        </colgroup>
                        <thead>
                           <tr>
                              <th>Trigger</th>
                              <th>Lokalizacja</th>
                              <th>Opis</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>system.onReady</td>
                              <td>core.class.php</td>
                              <td>System jest gotowy. Front controller zosta&#322; zainicjalizowany, do
                                 systemu zosta&#322; za&#322;adowany loader oraz klasa Benchmark.
                              </td>
                           </tr>
                           <tr>
                              <td>system.onBeforeSystem</td>
                              <td>core.class.php</td>
                              <td>Zosta&#322;y za&#322;adowane modu&#322;y oraz konfiguracja. Klasa Router oraz
                                 Dispatcher nie zosta&#322;y zainicjalizowane.
                              </td>
                           </tr>
                           <tr>
                              <td>system.onBeforeController</td>
                              <td>dispatcher.class.php</td>
                              <td>Przed wykonaniem (inicjalizacj&#261;) kontrolera.</td>
                           </tr>
                           <tr>
                              <td>system.onBeforeAction</td>
                              <td>disptcher.class.php</td>
                              <td>Uruchomiony zosta&#322; konstruktor kontrolera, zasoby zosta&#322;y
                                 za&#322;adowane. Przed wykonaniem kodu z akcji.
                              </td>
                           </tr>
                           <tr>
                              <td>system.onBeforeStart</td>
                              <td>disptcher.class.php</td>
                              <td>Przed wykonaniem metody __start() w klasy kontrolera (je&#380;eli
                                 takowa istnieje w klasie).
                              </td>
                           </tr>
                           <tr>
                              <td>system.onAfterStart</td>
                              <td>disptcher.class.php</td>
                              <td>Po wykonaniu metody __start() w klasy kontrolera (je&#380;eli takowa
                                 istnieje w klasie).
                              </td>
                           </tr>
                           <tr>
                              <td>system.onDisplay</td>
                              <td>view.class.php</td>
                              <td>Tu&#380; przed wys&#322;aniem zawarto&#347;ci widoku to przegl&#261;darki. Do
                                 zdarzenia przes&#322;ana zostanie zawarto&#347;c widoku.
                              </td>
                           </tr>
                           <tr>
                              <td>system.onShutdown</td>
                              <td>core.class.php</td>
                              <td>Tu&#380; przed zako&#324;czniem dzia&#322;ania aplikacji. </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5253"></a>Przekazywanie parametr&oacute;w do zdarzenia
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p> Sp&oacute;jrz na poni&#380;szy
                     przyk&#322;ad:
                  </p><pre class="programlisting">
&lt;?php

class Foo extends Controller
{
    public function Bar($comment)
    {
        echo 'System wykry&#322; akcje dodawania komentarza: ' . $comment;
    }
    
    function main()
    {
        Trigger::add('system.onBeforeSubmit', array('class' =&gt; 'Foo', 'function' =&gt; 'bar'));
        
        $comment = 'Przyk&#322;adowy komentarz';
        // pobieranie, analiza tresci itp
        Trigger::call('system.onBeforeSubmit', $comment);
        
        // dodanie komentarza		
    }
}
?&gt;</pre><p>W
                     metodzie <tt class="methodname">main()</tt> dodali&#347;my nowe zdarzenie dla triggera <span><b class="command">system.onBeforeSubmit</b></span>. Wywo&#322;anie zdarze&#324; przypisanych dla danego triggera
                     nast&#281;puje za pomoc&#261; metody <tt class="methodname">call()</tt> z klasy
                     <tt class="classname">Trigger</tt>. 
                  </p>
                  <p>Zwr&oacute;&#263; uwage, &#380;e w metodzie <tt class="methodname">Bar()</tt> zadeklarowa&#322;em parametr. W
                     momencie wywo&#322;ania triggera, zawarto&#347;&#263; komentarza zostanie przes&#322;ana do zdarzenia. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5278"></a>Przekazywanie parametr&oacute;w przez referencj&#281;
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Kolejny przyk&#322;ad: oprogramowanie triggera <span class="emphasis"><em>system.onDisplay</em></span>.
                        Utw&oacute;rz nowy widok <tt class="filename">foo.php</tt>:
                     </p><pre class="programlisting">Witam! To jest &lt;b&gt;przyklad&lt;/b&gt; oprogramowania triggera &lt;b&gt;system.onDisplay&lt;/b&gt;!</pre><p>Nasz trywialny przyk&#322;ad b&#281;dzie polega&#322; na zamianie znacznika &lt;b&gt; na &lt;i&gt; w
                        widoku. Oto nasz
                        kontroler:
                     </p><pre class="programlisting">
&lt;?php

class Foo extends Controller
{
    public function Bar(&amp;$content)
    { 
        $content[0] = str_replace(array('&lt;b&gt;', '&lt;/b&gt;'), array('&lt;i&gt;', '&lt;/i&gt;'), $content[0]);
    }
    
    function main()
    {
        Trigger::add('system.display', array('class' =&gt; 'Foo', 'function' =&gt; 'bar'));
        
        echo $this-&gt;load-&gt;view('foo');		
    }
}
?&gt;</pre><p>W metodzie <tt class="methodname">main()</tt> dodajemy zdarzenie dla triggera
                        <span><b class="command">system.onDisplay</b></span>. W metodzie <tt class="methodname">Bar</tt>
                        wykonujemy prost&#261; operacj&#281; - zamian&#281; znacznika &lt;b&gt; na &lt;i&gt;. W klasie <tt class="filename">view.class.php</tt> nast&#281;puje wywo&#322;anie zdarze&#324;
                        triggera:
                     </p><pre class="programlisting">Trigger::call('system.onDisplay', array(&amp;$this-&gt;content));</pre><p>Zwr&oacute;&#263; uwag&#281; na spos&oacute;b przekazania do zdarzenia, warto&#347;ci pola
                        <tt class="varname">$content</tt>. Je&#380;eli chcemy przekaza&#263; do zdarzenia parametry w formie
                        referencji, nale&#380;y przekaza&#263; je w formie tablicy. W ten spos&oacute;b zdarzenia mog&#261;
                        modyfikowa&#263; parametr, a w naszym przypadku - tre&#347;&#263; strony, kt&oacute;ra jest przesy&#322;ana do
                        przegl&#261;darki. 
                     </p>
                  </div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e5316"></a>Rozdzia&#322; 20. Cache
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e5324">Inicjalizacja klasy</a></span></dt>
                     <dt><span class="section"><a href="#d0e5383">Metody put() oraz get()</a></span></dt>
                     <dt><span class="section"><a href="#d0e5446">Niszczenie danych</a></span></dt>
                     <dt><span class="section"><a href="#d0e5456">Adaptery cache</a></span></dt>
                  </dl>
               </div>
               <p>Cache, czyli mechanizm sk&#322;adowania danych w celu przyspieszenia operacji. Jest stosowany w
                  wielu rozwi&#261;zaniach informatycznych, m.in. w przegl&#261;darkach WWW. Cache s&#322;u&#380;y przyspieszeniu
                  dzia&#322;ania aplikacji, co r&oacute;wnie&#380; mo&#380;e nast&#261;pi&#263; w przypadku frameworka Coyote. Przyk&#322;adowo:
                  nasza aplikacja wymaga dost&#281;pno&#347;ci pewnych danych zapisannych w bazie danych. Dane s&#261;
                  podzielone na kilka tabel, lecz same warto&#347;ci nieczesto si&#281; zmieniaj&#261;. W takim przypadku
                  mo&#380;emy odci&#261;&#380;y&#263; baz&#281; danych i przenie&#347;&#263; ci&#281;&#380;ar odczytu tych danych na klas&#281;
                  <tt class="classname">Cache</tt>. 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5324"></a>Inicjalizacja klasy
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Bibliotek&#281; (klas&#281;) <tt class="classname">Cache</tt> &#322;adujemy do projektu tak jak ka&#380;d&#261;
                     inn&#261; klas&#281;. Wa&#380;nym jest, aby utworzy&#263; w katalogu z projektem folder <tt class="filename">/cache</tt> i ustawi&#263; mu prawa zapisu (jedynie na systemach Unix). 
                  </p>
                  <p>Zaprezentujmy prosty przyk&#322;ad wykorzystania klasy
                     <tt class="classname">Cache</tt>:
                  </p><pre class="programlisting">
&lt;?php
                
class Bar extends Controller
{
    function main()
    {
        $cache = $this-&gt;load-&gt;library('cache');
        
        if (!$cache-&gt;start('foo'))
        {
            Benchmark::start('foo');
        
            for ($i = 0; $i &lt; 500000; $i++)
            {
                $result[] = $i * log($i);
            }
            sort($result);
            Benchmark::stop('foo');
            
            echo "Dokonano $i iteracji p&#281;tli w czasie... " . Benchmark::elapsed('foo') . ' sek.';
            $cache-&gt;end('foo');
        }
        else
        {
            echo '&lt;hr /&gt;';
            echo 'Te dane zosta&#322;y odcztyane z cache';
        }    
    }
}
?&gt;</pre><p>Mamy tutaj prosty kontroler. W kodzie dokonujemy 500 tys. iteracji p&#281;til, dokonujemy
                     bezsensownych operacji, tak, aby wyd&#322;u&#380;y&#263; czas dzia&#322;ania skryptu. Instrukcje te zostan&#261;
                     wykonane tylko raz, nast&#281;pnie zostan&#261; zapisane w <tt class="classname">Cache</tt>. Przy
                     kolejnym od&#347;wie&#380;eniu strony instrukcje nie zostan&#261; wykonane po raz kolejny - dane
                     zostan&#261; odczytane z cache. 
                  </p>
                  <p>W naszym przyk&#322;adzie, cachowanie danych zaczyna si&#281; po wywo&#322;aniu metody
                     <tt class="methodname">start()</tt> z klasy <tt class="classname">Cache</tt>. Metoda ta
                     zwraca warto&#347;&#263; true i wy&#347;wietlane na ekranie cachowane dane je&#380;eli te istniej&#261; w cache.
                     W przeciwnym wypadku (je&#380;eli dane nie s&#261; w cache), zwraca warto&#347;&#263; false, co owocuje
                     wykonaniem naszej bezsensownej p&#281;til. Cachowanie ko&#324;czy si&#281; w momencie wykonania metody
                     <tt class="methodname">end()</tt>. Innymi s&#322;owy do cache w&#281;druje wszystko, co
                     wy&#347;wietlone zostanie w oknie przegl&#261;darki pomi&#281;dzy metod&#261;
                     <tt class="methodname">start()</tt> a <tt class="methodname">end()</tt>. 
                  </p>
                  <p>Podstawowym warunkiem prawid&#322;owego dzia&#322;ania takiej aplikacji jest nazwa klucza (w tym
                     przypadku <span class="emphasis"><em>foo</em></span>), kt&oacute;ry musimy poda&#263; jako parametr w metodzie
                     <tt class="methodname">start()</tt> oraz <tt class="methodname">end()</tt>. Nazwa klucza
                     oznacza nazw&#281; pod jak&#261; b&#281;d&#261; figurowa&#263; nasze cachowane dane. Dane s&#261; skladowane w pliku
                     <tt class="filename">cache_data.php</tt> w katalogu <tt class="filename">/cache</tt>.
                     
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Metoda end() mo&#380;e posiada&#263; drugi, opcjonalny parametr okre&#347;laj&#261;cy liczb&#281;
                     sekund, jakie cachowane dane b&#281;d&#261; wa&#380;ne (domy&#347;lnie jest to 0, czyli dane nie zostan&#261;
                     przeterminowane). Np. warto&#347;&#263; 120 oznacza iz po up&#322;ywie 2 minut od czasu sk&#322;adowania
                     danych w cache, te przestan&#261; by&#263; aktualne.
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5383"></a>Metody put() oraz get()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Innym rozwi&#261;zaniem jakie oferuje klasa <tt class="classname">Cache</tt>, jest
                     wykorzystanie metod <tt class="classname">put()</tt> oraz <tt class="classname">get()</tt>.
                     Metoda <tt class="classname">put()</tt> s&#322;u&#380;y do umieszczania w bazie danych r&oacute;&#380;nego rodzaju
                     danych - np. tablicy, obiekt&oacute;w. Zacznijmy jednak od czego&#347; prostszego -
                     &#322;a&#324;cucha:
                  </p><pre class="programlisting">
$cache = $this-&gt;load-&gt;library('cache');

if (!$cache-&gt;get('string'))
{
    echo $s = 'Losowa liczba: ' . rand(1, 1000);
    $cache-&gt;put('string', $s);
}
else
{
    echo $cache-&gt;get('string');
}		
            </pre><p>Pierwszy warunek sprawdza, czy klucz <span class="emphasis"><em>string</em></span> znajduje si&#281; w cache.
                     Je&#380;eli nie - generujemy nowy &#322;a&#324;cuch i umieszczamy go w cache. W przeciwnym przypadku -
                     wy&#347;wietlamy zawarto&#347;&#263; klucza <span class="emphasis"><em>string</em></span> z cache.
                  </p>
                  <p>Podobnie ma si&#281; sprawa z zapisywaniem tablic, czy ca&#322;ych obiekt&oacute;w:</p><pre class="programlisting">
if (!$cache-&gt;get('class'))
{ 
    $foo = new FooBar();
    $foo-&gt;a = rand(1, 1000);
    $foo-&gt;b = 'foo';
    
    $cache-&gt;put('class', serialize($foo));
}
else
{
    $foo = new FooBar();
    $foo = unserialize($cache-&gt;get('class'));
}		

debug($foo);          
        </pre><p>Nast&#281;puje tutaj proces serializacji obiektu i zapisu do cache. Po ponownym od&#347;wie&#380;eniu
                     strony, zawarto&#347;&#263; obiektu (tzn. p&oacute;l obiektu) b&#281;dzie taka sama. 
                  </p>
                  <p>Powiedzieli&#347;my ju&#380;, &#380;e dane zapisywane s&#261; w pliku <tt class="filename">cache_data.php</tt>
                     w katalogu <tt class="filename">/cache</tt>. Metoda <tt class="methodname">put()</tt> ma t&#281;
                     przewag&#281;, iz umozliwia zapisanie danej warto&#347;ci w innym pliku. Dlaczego to takie
                     istostne? Poniewa&#380; zawarto&#347;&#263; pliku <tt class="filename">cache_data.php</tt> jest odczytywana
                     w momencie &#322;adowania biblioteki. Czyli je&#380;eli dodamy klas&#281; <tt class="classname">Cache</tt>
                     do listy w pliku autoload (automatycznie &#322;adowane zasoby), ta, za ka&#380;dym od&#347;wie&#380;eniem
                     strony, wczyta do pami&#281;ci zwarto&#347;&#263; pliku <tt class="filename">cache_data.php</tt>. Niby
                     dobrze, ale je&#380;eli ten plik ma za&#322;&oacute;&#380;my - 60 kB, a danych nie potrzebujemy przy ka&#380;dym
                     od&#347;wie&#380;eniu strony (tzn. w ka&#380;dym konstrolerze)? Mo&#380;emy te dane zapisa&#263; w innym pliku i
                     odczytywa&#263; je&#380;eli s&#261; potrzebne. W takim przypadku, nazwa klucza, musi posiada&#263;
                     podkre&#347;lenie na pocz&#261;tku, czyli np.: _foo, _bar, _data. Czyli modyfikuj&#261;c poprzedni
                     przyk&#322;ad, mo&#380;emy zrobi&#263;
                     tak:
                  </p><pre class="programlisting">
if (!$cache-&gt;get('_class'))
{ 
    $foo = new FooBar();
    $foo-&gt;a = rand(1, 1000);
    $foo-&gt;b = 'foo';
    
    $cache-&gt;put('_class', serialize($foo), 60);
}
else
{
    $foo = new FooBar();
    $foo = unserialize($cache-&gt;get('_class'));
}		

debug($foo);</pre><p>Teraz, dane zostan&#261; zapisane w pliku <tt class="filename">data_class.php</tt> i zostan&#261;
                     odczytane jedynie wtedy, gdy ich potrzebujemy. Zwr&oacute;&#263; uwag&#281;, &#380;e tutaj u&#380;y&#322;em trzeciego
                     parametru w metodzie <tt class="methodname">put()</tt>. Trzeci, opcjonalny parametr oznacza
                     wa&#380;no&#347;&#263; danych. Oznacza to, &#380;e wa&#380;no&#347;&#263; danych wyga&#347;nie po jednej minucie i wtedy nast&#261;pi
                     od&#347;wie&#380;enie cache. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5446"></a>Niszczenie danych
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Kasowanie danych w cache mo&#380;liwe jest dzi&#281;ki metodzie
                     <tt class="methodname">destroy()</tt>. W jej parametrze nale&#380;y poda&#263; - jak &#322;atwo si&#281;
                     domy&#347;le&#263; - nazw&#281; klucza. Np.:
                  </p><pre class="programlisting">
$cache-&gt;destroy('_class');         
        </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5456"></a>Adaptery cache
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Biblioteka <tt class="classname">Cache</tt> funkcjonuje w oparciu o wzorzec adaptera.
                     Domy&#347;lnym adapterem jest <tt class="filename">Cache_File</tt>, kt&oacute;ry znajduje si&#281; w pliku
                     <tt class="filename">file.class.php</tt>, w katalogu <tt class="filename">/lib/cache</tt>
                     frameworka. Opr&oacute;cz tego, we frameworku dost&#281;pny jest adapter obs&#322;ugj&#261;cy eAccelerator. 
                  </p>
                  <p>Adapter to klasa odpowiadaj&#261;ca za sk&#322;adowanie danych. Przyk&#322;adowo, adapter <tt class="filename">Cache_File</tt> sk&#322;aduje dane na dysku twardym komputera. Adapter
                     eAccelerator sk&#322;aduje dane w pami&#281;ci RAM i wykorzystuje bibliotek&#281; eaccelerator. Mo&#380;emy
                     napisa&#263; w&#322;asny adapter, kt&oacute;ry b&#281;dzie sk&#322;adowa&#322; dane - np. w bazie danych, czy innym
                     &#378;r&oacute;dle. 
                  </p>
                  <p>Adaptery cache musz&#261; znajdowa&#263; si&#281; w katalogu <tt class="filename">/lib/cache/</tt>. Klasa
                     adaptera musi nosi&#263; przedrostek <span class="emphasis"><em>Cache_</em></span> i implementowa&#263; interfejs
                     <tt class="classname">IConfig</tt>, kt&oacute;ry jest
                     nast&#281;pujacy:
                  </p><pre class="programlisting">interface ICache
{
	public function get($var_name);
	public function put($var_name, $data, $ttl = 0);
	public function start($cache_id);
	public function end($cache_id, $ttl = 0);
	public function destroy($var_name = '');
	public function load();
	public function save();
	public function exists($var_name);
}</pre><p>Nazw&#281; adaptera nale&#380;y poda&#263; w konstruktorze klasy <tt class="classname">Cache</tt>, czyli
                     np.:
                  </p><pre class="programlisting">$cache = &amp;$this-&gt;load-&gt;library('cache', 'db');
// lub:
$cache = new Cache('db');</pre><p>W takim przypadku szukany b&#281;dzie adapter o nazwie <span class="emphasis"><em>db</em></span>, kt&oacute;ry od
                     tej pory obs&#322;ugiwa&#263; b&#281;dzie mechanizm cachowania. W tym przypadku klasa adaptera musi
                     nosi&#263; nazw&#281; <tt class="classname">Cache_Db</tt> i by&#263; umieszczona w pliku <tt class="filename">db.class.php</tt>, w katalogu <tt class="filename">/lib/cache</tt>.
                  </p>
                  <p>W konstruktorze klasy <tt class="classname">Cache</tt> mo&#380;emy r&oacute;wnie&#380; przekaza&#263; instancj&#281;
                     klasy adaptera:
                  </p><pre class="programlisting">$cache = new Cache(new Cache_Db);</pre><p>Klasa <tt class="classname">Cache</tt> posiada r&oacute;wnie&#380; metod&#281;
                     <tt class="methodname">setAdapter()</tt>, dzi&#281;ki kt&oacute;rej mo&#380;emy zmieni&#263; adapter w trakcie
                     dzia&#322;ania
                     aplikacji:
                  </p><pre class="programlisting">$cache-&gt;setAdapter(new Cache_Db);</pre></div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e5529"></a>Rozdzia&#322; 21. ACL
                        </h2>
                     </div>
                  </div>
               </div>
               <p>ACL to akronim od s&#322;&oacute;w <span class="emphasis"><em>Access Control List</em></span>, czyli <span class="emphasis"><em>lista
                        kontroli dost&#281;pu</em></span>. Popularna w systemach Unixowych pozwala na dok&#322;adn&#261;
                  kontrol&#281; w dost&#281;pie do plik&oacute;w danym u&#380;ytkownikom. Coyote posiada prost&#261; klas&#281;
                  <tt class="classname">acl</tt> umo&#380;liwiaj&#261;c&#261; tworzenie prostych system&oacute;w z wykorzystaniem ACL.
                  Biblioteka nie jest rozbudowana tote&#380; wykorzystanie jej opcji nie powinno stanowi&#263; problemu.
               </p>
               <p>Dzi&#281;ki klasie ACL mo&#380;emy tworzy&#263; u&#380;ytkownik&oacute;w i przydziela&#263; im prawa do danych opcji
                  (<span class="emphasis"><em>allow</em></span>, <span class="emphasis"><em>deny</em></span>). Klasa acl umo&#380;liwia tworzenia
                  hierarchii u&#380;ytkownik&oacute;w. Oznacza to, i&#380; mo&#380;emy utworzy&#263; grup&#281; - np.
                  <span class="emphasis"><em>Admin</em></span>, a nast&#281;pnie przypisa&#263; u&#380;ytkownik&oacute;w do tej grupy. Odpowiada za to
                  metoda
                  <tt class="methodname">create()</tt>:
               </p><pre class="programlisting">		$acl-&gt;create('Admin');
$acl-&gt;create('Adam', 'Admin');
$acl-&gt;create('Marta', 'Admin');</pre><p>W tym przyk&#322;adzie utworzyli&#347;my grup&#281; <span class="emphasis"><em>Admin</em></span> i przypisali&#347;my do niej
                  dw&oacute;ch u&#380;ytkownik&oacute;w (<span class="emphasis"><em>Adam</em></span>, <span class="emphasis"><em>Marta</em></span>). Mo&#380;emy ustala&#263;
                  prawa zar&oacute;wno dla ca&#322;ej grupy jak i pojedy&#324;czych u&#380;ytkownik&oacute;w, co prezentuje poni&#380;szy
                  przyk&#322;ad:
               </p><pre class="programlisting">
&lt;?php
            
class Bar extends Controller
{
    function main()
    {
        $acl = &amp;$this-&gt;load-&gt;library('acl');
        
        $acl-&gt;create('Admin');
        $acl-&gt;create('Adam', 'Admin');
        $acl-&gt;create('Marta', 'Admin');
        
        $acl-&gt;allow('Admin', 'Delete');
        // zabraniamy uzytkownikowi Marta
        $acl-&gt;deny('Marta', 'Delete');
        
        var_dump($acl-&gt;get('Admin', 'Delete')); // true
        var_dump($acl-&gt;get('Adam', 'Delete')); // true
        var_dump($acl-&gt;get('Marta', 'Delete')); // false
        
        $acl-&gt;create('Anonymous'); // uzytkownik anonimowy
        $acl-&gt;deny('Anonymous', 'Delete'); 
        
        var_dump($acl-&gt;get('Anonymous', 'Delete')); // false    
    }
}
?&gt;</pre><p>Metoda <tt class="methodname">allow()</tt> zezwala danej grupie/u&#380;ytkownikowi na wykonanie
                  okre&#347;lonej akcji. W tym przypadku nadali&#347;my ca&#322;ej grupie <span class="emphasis"><em>Admin</em></span> prawa do
                  wykonania operacji <span class="emphasis"><em>Delete</em></span>. Nast&#281;pnie zabronili&#347;my u&#380;ytkownikowi z tej
                  grupy (<span class="emphasis"><em>Marta</em></span>) na wykonanie tej operacji (metoda
                  <tt class="methodname">deny()</tt>). Metod&#261; <tt class="methodname">get()</tt> mo&#380;emy sprawdzi&#263;,
                  czy dany u&#380;ytkownik posiada prawa (true lub false) do wykonania danej akcji.
               </p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e5592"></a>Rozdzia&#322; 22. Walidacja danych
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e5600">Inicjalizacja klasy</a></span></dt>
                     <dt><span class="section"><a href="#d0e5621">Odczyt b&#322;&#281;d&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e5631">Walidatory</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5658">Walidatory wykonywane samodzielnie</a></span></dt>
                           <dt><span class="section"><a href="#d0e5667">Klasa Validate_String</a></span></dt>
                           <dt><span class="section"><a href="#d0e5685">Klasa Validate_Int</a></span></dt>
                           <dt><span class="section"><a href="#d0e5693">Klasa Validate_Email</a></span></dt>
                           <dt><span class="section"><a href="#d0e5702">Klasa Validate_Url</a></span></dt>
                           <dt><span class="section"><a href="#d0e5713">Klasa Validate_Match</a></span></dt>
                           <dt><span class="section"><a href="#d0e5725">Klasa Validate_Equal</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e5740">Ustawienie komunikat&oacute;w b&#322;&#281;d&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e5759">Metoda setOptions()</a></span></dt>
                     <dt><span class="section"><a href="#d0e5789">Metoda setValidators()</a></span></dt>
                     <dt><span class="section"><a href="#d0e5832">Metoda reset()</a></span></dt>
                     <dt><span class="section"><a href="#d0e5839">Statyczna metoda call()</a></span></dt>
                  </dl>
               </div>
               <p>Walidacja jest procesem sprawdzania poprawno&#347;ci danych. Zapewne b&#281;dzie wykorzystywana
                  dosy&#263; cz&#281;sto w Twoich aplikacjach, np. - przy sprawdzaniu poprawno&#347;ci danych wprowadzaonych
                  w formularzu. Coyote udost&#281;pnia klas&#281; <tt class="classname">Validate</tt>, kt&oacute;ra mo&#380;e by&#263;
                  wykorzystana przez Ciebie do sprawdzania poprawno&#347;ci danych.
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5600"></a>Inicjalizacja klasy
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klas&#281; mo&#380;na zainicjalizowa&#263; tak jak ka&#380;d&#261; inn&#261; bibliotek&#281; frameworka. Oto prosty
                     przyk&#322;ad u&#380;ycia mechanizmu walidacji
                     danych:
                  </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = 'foobarfoobarfoobar';

		$validate = &amp;$this-&gt;getLibrary('validate');
		$validate-&gt;addValidator(new Validate_String(false, 1, 5));

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;</pre><p>Klasa <tt class="classname">Validate</tt> sama w sobie jest bezu&#380;yteczna bez walidator&oacute;w,
                     kt&oacute;re s&#261; dodawane przy pomocy metody <tt class="methodname">addValidator()</tt>. W tym
                     przyk&#322;adzie sprawdzamy poprawo&#347;&#263; &#322;a&#324;cucha danych. Musi on mie&#263; d&#322;ugo&#347;&#263; od jednego do
                     pi&#281;ciu znak&oacute;w. Nast&#281;pnie metoda <tt class="methodname">isValid()</tt> wywo&#322;uje w kolejce
                     kolejne walidatory i je&#380;eli kt&oacute;rykolwiek zwr&oacute;ci&#322; false - metoda
                     <tt class="methodname">isValid()</tt> - r&oacute;wnie&#380; zwr&oacute;ci warto&#347;&#263; false. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5621"></a>Odczyt b&#322;&#281;d&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Ka&#380;dy walidator zwr&oacute;ci komunikat b&#322;&#281;du w przypadku niespe&#322;nienia danych kryteri&oacute;w.
                     Komunikaty b&#322;&#281;d&oacute;w mog&#261; by&#263; odczytane przy pomocy metody
                     <tt class="methodname">getMessages()</tt> kt&oacute;ra zwraca tablic&#281;
                     b&#322;&#281;d&oacute;w:
                  </p><pre class="programlisting">Core::debug($validate-&gt;getMessages());</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5631"></a>Walidatory
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Walidatory mog&#261; by&#263; dodawane do kolejki przy pomocy metody
                     <tt class="methodname">addValidator()</tt>. Zawarto&#347;&#263; danego pola czy zmiennej mo&#380;e by&#263;
                     bowiem analizowana przy pomocy wielu walidator&oacute;w. Ka&#380;dy walidator Coyote musi by&#263; klas&#261;
                     implementuj&#261;c&#261; interfejs <tt class="interfacename">IValidate</tt> oraz dziedzicz&#261;c&#261; po
                     klasie <tt class="classname">Validate_Abstract</tt>. W Coyote klasy walidator&oacute;w znajduj&#261; si&#281;
                     w katalogu <tt class="filename">lib/validate</tt>. Zalecane jest, aby nazwa klasy nosi&#322;a
                     prefiks <span class="emphasis"><em>Validate_</em></span>, co pozwoli na lokalizowanie tego pliku przez
                     loader frameworka. 
                  </p>
                  <p>Ka&#380;dy walidator posiada konstruktor, kt&oacute;rzy w parametrach mo&#380;e przyjmowa&#263; r&oacute;&#380;ne opcje
                     walidacji. We wcze&#347;niejszym przyk&#322;adzie, w konstruktorze klasy
                     <tt class="classname">Validate_String</tt> przekazali&#347;my informacje o minimalnej oraz
                     maksymalnej d&#322;ugo&#347;ci &#322;a&#324;cucha, ale r&oacute;wnie&#380; informacj&#281; o tym, czy warto&#347;&#263; jest
                     opcjonalna, czy te&#380; nie. 
                  </p>
                  <p>Ka&#380;dy walidator mo&#380;e posiada&#263; charakterystyczne dla siebie opcje oraz w&#322;a&#347;ciwo&#347;ci. </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5658"></a>Walidatory wykonywane samodzielnie
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Mo&#380;emy wykorzysta&#263; walidatory bez korzystania z klasy Validate. Klasa &oacute;w dostarcza
                        par&#281; metod, dzi&#281;ki kt&oacute;rym mo&#380;emy zadeklarowa&#263; kolejk&#281; walidator&oacute;w, lecz je&#380;eli
                        chcemy skorzysta&#263; tylko z jednego walidatora - mo&#380;emy u&#380;y&#263; go bezpo&#347;rednio -
                        np.:
                     </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = 'foobarfoobarfoobar';

		// deklaracja interfejsu IValidate w pliku validate.class.php
		Load::loadClass('validate', false);
		$validate = new Validate_String(false, 1, 5);

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';

			Core::debug($validate-&gt;getMessages());
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Zwr&oacute;c
                        uwag&#281;, i&#380; mimo, i&#380; niepotrzebna nam klasa Validate, za&#322;adowa&#322;em j&#261; do projektu
                        (bez inicjalizacji). Dlatego, i&#380; plik validate.class.php zawiera deklaracj&#281;
                        interfejsu IValidate.
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5667"></a>Klasa Validate_String
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Jak &#322;atwo si&#281; domy&#347;le&#263; - klasa <tt class="classname">Validate_String</tt> jest
                        walidatorem &#322;a&#324;cuch&oacute;w. Umo&#380;liwia sprawdzenie jego d&#322;ugo&#347;ci. Pierwszym parametrem
                        konstruktora jest parametr <i class="parameter"><tt>$optional</tt></i>, kt&oacute;ry okre&#347;la czy
                        &#322;a&#324;cuch jest opcjonalny (true), czy nie (false). Je&#380;eli jest opcjonalny, to pomimo
                        i&#380; jest pusty - walidator nie zwr&oacute;ci warto&#347;ci false. 
                     </p>
                     <p>Warto wspomnie&#263;, i&#380; parametry konstruktora s&#261; parametrami opcjonalnymi, mo&#380;na
                        skorzysta&#263; z metod, kt&oacute;re oferuje klasa
                        <tt class="classname">Validate_String</tt>:
                     </p><pre class="programlisting">
$validate = new Validate_String;
$validate-&gt;setOptional(false);
$validate-&gt;setMin(1);
$validate-&gt;setMax(5);</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5685"></a>Klasa Validate_Int
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Walidator s&#322;u&#380;y do walidacji warto&#347;ci liczbowych. Posiada takie same metody, co
                        klasa <tt class="classname">Validate_String</tt>, jej dzia&#322;anie jest takie same (poza
                        oczywistym faktem i&#380; sprawdza wielko&#347;ci liczbowe, a nie d&#322;ugo&#347;ci &#322;a&#324;cuch&oacute;w). 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5693"></a>Klasa Validate_Email
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Walidator s&#322;u&#380;y do sprawdzenia poprawno&#347;ci adresu e-mail. Opcjonalnym parametrem
                        konstruktora jest parametr $optional, kt&oacute;ry okre&#347;la, czy warto&#347;&#263; (adres e-mail) jest
                        opcjonalny (je&#380;eli jest opcjonalny, w przypadku pustego &#322;a&#324;cucha - klasa nie zwr&oacute;ci
                        warto&#347;ci false).
                        Przyk&#322;ad:
                     </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = 'foobarfoobarfoobar';

		$validate = &amp;$this-&gt;getLibrary('validate');
		$validate-&gt;addValidator(new Validate_String(false, 1, 5));
		$validate-&gt;addValidator(new Validate_Email(false));

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';

			Core::debug($validate-&gt;getMessages());
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;</pre><p>Zwr&oacute;&#263; uwag&#281;, i&#380; w tym przypadku u&#380;ywamy dw&oacute;ch walidator&oacute;w, zar&oacute;wno do sprawdzenia
                        d&#322;ugo&#347;ci &#322;a&#324;cucha jak i poprawno&#347;ci pod k&#261;tem adresu e-mail. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5702"></a>Klasa Validate_Url
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Jak &#322;atwo si&#281; domy&#347;le&#263; - s&#322;u&#380;y do sprawdzenia poprawno&#347;ci adresu URL. Dzia&#322;a
                        podobnie jak klasa <tt class="classname">Validate_Email</tt>. Jej jedynym parametrem
                        konstruktora jest parametr <i class="parameter"><tt>$optional</tt></i>. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5713"></a>Klasa Validate_Match
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Walidator umo&#380;liwia sprawdzenie danej warto&#347;ci pod k&#261;tem wyra&#380;enia
                        regularnego:
                     </p><pre class="programlisting">
$validate = &amp;$this-&gt;getLibrary('validate');
$validate-&gt;addValidator(new Validate_String(false, 1, 5));

$matchValidator = new Validate_Match;
$matchValidator-&gt;setPattern('/[a-zA-Z]+/');

$validate-&gt;addValidator($matchValidator);</pre><p>Walidator posiada metod&#281; <tt class="methodname">setPattern()</tt>, kt&oacute;ra umo&#380;liwia
                        ustawienie wzorca wyra&#380;enia regularnego. R&oacute;wnie dobrze, mo&#380;na &oacute;w wzorzec ustawi&#263; w
                        konstruktorze klasy. 
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5725"></a>Klasa Validate_Equal
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Walidator umo&#380;liwia por&oacute;wnanie warto&#347;ci dw&oacute;ch parametr&oacute;w. Sprawdza, czy poadne warto&#347;ci s&#261; sobie r&oacute;wne.</p><pre class="programlisting">
$validate = &amp;$this-&gt;getLibrary('validate');
$validate-&gt;addValidator(new Validate_Equal('foo'));

if ($validate-&gt;isValid('bar'))
{
    echo 'Warto&#347;ci nie s&#261; sobie r&oacute;wne';
}
            </pre><p>
                        W powy&#380;szym kodzie, metoda <tt class="methodname">isValid()</tt> zwr&oacute;ci FALSE poniewa&#380; &#322;a&#324;cuchy foo oraz bar nie s&#261; sobie r&oacute;wne.
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                        Walidator rzutuje dwie podane warto&#347;ci na typ string.
                        
                     </div>
                     <p>
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5740"></a>Ustawienie komunikat&oacute;w b&#322;&#281;d&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Ka&#380;dy walidator ma okre&#347;lony, zadeklarowany zestaw komunikat&oacute;w b&#322;&#281;d&oacute;w. S&#261; one zwracane
                     przez metod&#281; getMessages() klasy Validate lub klasy walidatora. Mo&#380;emy zmodyfikowa&#263;
                     tre&#347;&#263; tych komunikat&oacute;w dzi&#281;ki metodzie setTemplate(), kt&oacute;ra dost&#281;pna jest dla ka&#380;dego
                     walidatora:
                     
                  </p><pre class="programlisting">
$matchValidator = new Validate_Match;
$matchValidator-&gt;setPattern('/[a-zA-Z]+/');
$matchValidator-&gt;setTemplate(Validate_Match::NOT_MATCH, 'Uuu... warto&#347;&#263; %value% jest nieprawid&#322;owa');</pre><p>Ka&#380;dy walidator ma zestaw sta&#322;ych okre&#347;laj&#261;cych dane komunikaty. Aby dowiedzie&#263; si&#281;
                     wi&#281;cej o tych sta&#322;ych, zach&#281;camy do przegl&#261;dni&#281;cia kod&oacute;w &#378;r&oacute;d&#322;owych klas walidator&oacute;w. W
                     powy&#380;szym przyk&#322;adzie ustawili&#347;my nowy komunikat dla sta&#322;ej NOT_MATCH. Zwr&oacute;&#263; uwag&#281; na
                     u&#380;ycie frazy <span class="emphasis"><em>%value%</em></span> w komunikacie b&#322;&#281;du. W to miejsce zostanie
                     wstawiona walidowana wart&oacute;&#347;&#263;. 
                  </p>
                  <p>Warto&#347;&#263; <span class="emphasis"><em>%value%</em></span> jest dost&#281;pna w ka&#380;dym walidatorze. Ponad to
                     ka&#380;dy walidator posiada sw&oacute;j zestaw "zmiennych", kt&oacute;re zostan&#261; zast&#261;pione okre&#347;lonymi
                     pozycjami.
                     Przyk&#322;ad:
                  </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '12354567567';

		$validate = &amp;$this-&gt;getLibrary('validate');

		$stringValidator = new Validate_String(false, 1, 5);
		$stringValidator-&gt;setTemplate(Validate_String::TOO_SHORT, 'Oj nie... %value% nie mo&#380;e by&#263; kr&oacute;tsze ni&#380; %min% znak&oacute;w!');
		$stringValidator-&gt;setTemplate(Validate_String::TOO_LONG, 'Khem... %value% jest zbyt d&#322;ugie. Maksymalna d&#322;ugo&#347;&#263; znak&oacute;w to %max%');
		$validate-&gt;addValidator($stringValidator);

		$matchValidator = new Validate_Match;
		$matchValidator-&gt;setPattern('/[a-zA-Z]+/');
		$matchValidator-&gt;setTemplate(Validate_Match::NOT_MATCH, 'Uuu... warto&#347;&#263; %value% jest nieprawid&#322;owa');

		$validate-&gt;addValidator($matchValidator);

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';

			Core::debug($validate-&gt;getMessages());
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5759"></a>Metoda setOptions()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Ka&#380;dy walidator posiada metod&#281; <tt class="methodname">setOptions()</tt>. Umo&#380;liwia ona
                     przekazanie opcji walidatora w formie tablicy. Dochodzimy do tego, &#380;e s&#261; trzy sposoby
                     przekazywania opcji walidatora:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>W konstruktorze klasy</li>
                        <li>Przy pomocy metod walidatora</li>
                        <li>Przy pomocy metody setOptions()</li>
                     </ul>
                  </div>
                  <p>Sp&oacute;jrz na poni&#380;szy
                     przyk&#322;ad:
                  </p><pre class="programlisting">
$stringValidator = new Validate_String;
$stringValidator-&gt;setTemplate(Validate_String::TOO_SHORT, 'Oj nie... %value% nie mo&#380;e by&#263; kr&oacute;tsze ni&#380; %min% znak&oacute;w!');
$stringValidator-&gt;setTemplate(Validate_String::TOO_LONG, 'Khem... %value% jest zbyt d&#322;ugie. Maksymalna d&#322;ugo&#347;&#263; znak&oacute;w to %max%');

$stringValidator-&gt;setOptions(array(
		'optional'		=&gt; false,
		'min'			=&gt; 1,
		'max'			=&gt; 5
	)
);
$validate-&gt;addValidator($stringValidator);</pre><p>Dzia&#322;anie metody <tt class="methodname">setOptions()</tt> jest bardzo proste. Odczytuje
                     ona klucze w tablicy i poszukuje w klasie walidatora metod o nazwie
                     <span class="emphasis"><em>setXXX</em></span>, gdzie <span class="emphasis"><em>XXX</em></span> to nazwa klucza. 
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5789"></a>Metoda setValidators()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Validate</tt> posiada metod&#281;
                     <tt class="methodname">setValidators()</tt>, kt&oacute;ra stanowi alternatyw&#281; dla metody
                     <tt class="methodname">addValidator()</tt>. Umo&#380;liwia ona przekazanie konfiguracji
                     walidator&oacute;w bez konieczno&#347;ci samodzielnego inicjalizowania klas.
                     
                  </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '12354567567';

		$validate = &amp;$this-&gt;getLibrary('validate');
		$validate-&gt;setValidators(array(

				'string'		=&gt; array(


						'optional'			=&gt; false,
						'min'				=&gt; 1,
						'max'				=&gt; 5,
						'templates'			=&gt; array(

							'TOO_SHORT'	=&gt; 'Oj nie... %value% nie mo&#380;e by&#263; kr&oacute;tsze ni&#380; %min% znak&oacute;w!',
							'TOO_LONG'	=&gt; 'Khem... %value% jest zbyt d&#322;ugie. Maksymalna d&#322;ugo&#347;&#263; znak&oacute;w to %max%'
						)
				),
				'match'			=&gt; array(

						'pattern'			=&gt; '/[a-zA-Z]+/',
						'templates'			=&gt; array(

							'NOT_MATCH'	=&gt; 'Uuu... warto&#347;&#263; %value% jest nieprawid&#322;owa'
						)
				)
			)
		);

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';

			Core::debug($validate-&gt;getMessages());
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;</pre><p>Parametrem metody <tt class="methodname">setValidators()</tt> musi by&#263; tablica. Kluczami
                     tablicy s&#261; nazwy walidator&oacute;w, kt&oacute;re to z kolei zawieraj&#261; kolejne tablice okre&#347;laj&#261;ce
                     opcje walidator&oacute;w. Klucz <span class="emphasis"><em>templates</em></span> zawiera informacje o szablonach
                     komunikat&oacute;w b&#322;&#281;d&oacute;w. Zwr&oacute;&#263; uwag&#281;, i&#380; sta&#322;e s&#261; tutaj &#322;a&#324;cuchami - uj&#281;te w apostrofy.
                     Nale&#380;y o tym pami&#281;ta&#263;. 
                  </p>
                  <p>Takie rozwi&#261;zanie umo&#380;liwia przetrzymywanie konfiguracji walidator&oacute;w w plikach
                     konfiguracyjnych i &#322;adowania ich w razie potrzeby do projektu. 
                  </p>
                  <p>Mo&#380;liwe s&#261; r&oacute;&#380;ne konfiguracj&#281; tablicy asocjacyjnej przekazywanej do metody <tt class="methodname">setValidators()</tt>.
                     W powy&#380;szym przyk&#322;adzie klucze tablicy okre&#347;la&#322;y nazw&#281; walidatora, a warto&#347;ci&#261; by&#322;a tablica przekazywana do 
                     konstruktora klasy. Mo&#380;liwe jest przekazanie obiektu klasy walidatora lub - nazwy walidatora - bez parametr&oacute;w
                     konfiguracji:
                     
                  </p><pre class="programlisting">
&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '12354567567';

		$validate = &amp;$this-&gt;getLibrary('validate');
		$validate-&gt;setValidators(array(

				'string',
				new Validate_Match('/[a-zA-Z]+/')
			)
		);

		if (!$validate-&gt;isValid($value))
		{
			echo '&#321;a&#324;cuch jest nieprawid&#322;owy';

			Core::debug($validate-&gt;getMessages());
		}
		else
		{
			echo '&#321;a&#324;cuch jest poprawny';
		}
	}
}
?&gt;            
        </pre><p>
                     Mo&#380;liwe jest wi&#281;c przekazywanie samych nazw walidator&oacute;w - bez zawierania argument&oacute;w, kt&oacute;re maj&#261; by&#263; przekazane
                     do konstruktora klasy. Innym sposobem jest przekazanie parametr&oacute;w walidatora w formie tablicy:
                     
                  </p><pre class="programlisting">
$validate-&gt;setValidators(array(

		array('string', false, 1, 5),
		array('match', '/[a-zA-Z]+/')
	)
);                
            </pre><p>
                     Pierwszym elementem tablicy musi by&#263; nazwa walidatora (tzn. <span class="emphasis"><em>string</em></span> oraz <span class="emphasis"><em>match</em></span>), gdy&#380;
                     kolejne elementy b&#281;d&#261; przekazywane do konstruktora klasy w formie parametr&oacute;w.          
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5832"></a>Metoda reset()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda umo&#380;liwia wyzerowanie kolejki walidator&oacute;w w klasie
                     <tt class="classname">Validate</tt></p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5839"></a>Statyczna metoda call()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Statyczna metoda <tt class="methodname">call()</tt> klasy <tt class="classname">Validate</tt>
                     umo&#380;liwia wywo&#322;anie jednego walidatora danych bez konieczno&#347;ci inicjalizacji klasy
                     <tt class="classname">Validate</tt>:
                  </p><pre class="programlisting">if (!Validate::call('123456', new Validate_String(false, 1, 5))) { ... </pre></div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e5855"></a>Rozdzia&#322; 23. Filtrowanie danych
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e5868">Filtry</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e5922">Pisanie w&#322;asnego filtra</a></span></dt>
                           <dt><span class="section"><a href="#d0e5954">Filtr XSS</a></span></dt>
                           <dt><span class="section"><a href="#d0e5968">Filtr stripNewLines()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5976">Filtr int()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5984">Filtr string()</a></span></dt>
                           <dt><span class="section"><a href="#d0e5992">Filtr float()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e6000">Metoda setFilters()</a></span></dt>
                     <dt><span class="section"><a href="#d0e6019">Statyczna metoda call()</a></span></dt>
                     <dt><span class="section"><a href="#d0e6029">Klasa Filter_Input</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6100">Metoda setRules()</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p>Filtrowanie danych umo&#380;liwia usuni&#281;cie, konwersj&#281; i innego rodzaju przekszta&#322;cenia danych.
                  Klasa <tt class="classname">Validate</tt> omawiana wcze&#347;niej umo&#380;liwia jedynie sprawdzenie
                  poprawno&#347;ci danych - nie zapewnia ich przekszta&#322;ce&#324;. Jeste&#347;my wi&#281;c w&oacute;wczas zmuszeni u&#380;y&#263;
                  mechanizmu filtrowania. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Budowa i dzia&#322;anie klasy <font color="red">&lt;clasname&gt;Filter&lt;/clasname&gt;</font> jest
                  bardzo podobne do klasy Validate. Zach&#281;camy do zapoznania si&#281; z kodami &#378;r&oacute;d&#322;owymi tej
                  klasy. 
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e5868"></a>Filtry
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Filtry danych mog&#261; by&#263; metodami, klasami lub funkcjami. Dodanie filtra do kolejki
                     umo&#380;liwia metoda <tt class="methodname">addFilter()</tt>, a samo filtrowanie odbywa si&#281; w
                     metodzie
                     <tt class="methodname">filterData()</tt>:
                  </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '&lt;b&gt;Coyote&lt;/b&gt;';

		$filter = &amp;$this-&gt;getLibrary('filter');
		$filter-&gt;addFilter('htmlspecialchars');

		echo $filter-&gt;filterData($value);
	}
}
?&gt;</pre><p>W tym prostszym przyk&#322;adzie do kolejki dodali&#347;my filtr
                     <span class="emphasis"><em>htmlspecialchars</em></span>. Jak &#322;atwo si&#281; domy&#347;le&#263; klasa
                     <tt class="classname">Filter</tt> wywo&#322;a funkcj&#281; <tt class="function">htmlspecialchars()</tt> na
                     warto&#347;ci <tt class="varname">$value</tt>. Jak wspomnia&#322;em - parametrem metody
                     <tt class="methodname">addFilter()</tt> mo&#380;e by&#263; instancja klasy. Musi ona jednak
                     implementowa&#263; interfejs
                     <tt class="interfacename">IFilter</tt>:
                  </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '     &lt;b&gt;Coyote&lt;/b&gt;       ';

		$filter = &amp;$this-&gt;getLibrary('filter');
		$filter-&gt;addFilter('trim');
		$filter-&gt;addFilter('htmlspecialchars');
		$filter-&gt;addFilter(new Filter_Replace('#', '&amp;', '|'));

		echo $filter-&gt;filterData($value);
	}
}
?&gt;</pre><p>W powy&#380;szym przyk&#322;adzie wykorzystano klas&#281; filtra -
                     <tt class="classname">Filter_Replace</tt>. Usuwa ona z &#322;a&#324;cucha znaki podane w konstruktorze
                     klasy. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Parametrem konstruktora mo&#380;e by&#263; r&oacute;wnie&#380; tablica znak&oacute;w. 
                  </div>
                  <p>Parametrem metody <tt class="methodname">addFilter()</tt> mo&#380;e by&#263; r&oacute;wnie&#380; tablica
                     okre&#347;laj&#261;ca nazw&#281; klasy filtra oraz parametry, kt&oacute;re zostan&#261; przekazane do konstruktora
                     klasy:
                  </p><pre class="programlisting">
$filter-&gt;addFilter('trim');
$filter-&gt;addFilter('htmlspecialchars');
$filter-&gt;addFilter(array('replace', '#', '&lt;', '|'));
        </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Pami&#281;taj, i&#380; pierwszym elementem tablicy przekazywanej do metody addFilter() musi by&#263;
                                 nazwa filtra (bez przedrostka <span class="emphasis"><em>Filter</em></span>)
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5922"></a>Pisanie w&#322;asnego filtra
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Oczywi&#347;cie nic nie stoi na przeszkodzie, aby napisa&#263; w&#322;asny filtr danych. Klasy
                        filtr&oacute;w musz&#261; implementowa&#263; interfejs
                        <tt class="interfacename">IFilter</tt>:
                     </p><pre class="programlisting">interface IFilter 
{
	public function filter($value);
}</pre><p>Musi wi&#281;c posiada&#263; metod&#281; <tt class="methodname">filter()</tt>, kt&oacute;ra b&#281;dzie
                        wywo&#322;ywana w kolejce przez klas&#281; <tt class="classname">Filter</tt>. Swoj&#261; klas&#281; filtra
                        umie&#347;&#263; w katalogu <tt class="filename">lib/filter</tt>. Plik klasy filtra musi mie&#263;
                        budow&#281; tak&#261; jak ka&#380;da inna biblioteka frameworka - czyli <span class="emphasis"><em>&lt;nazwa
                              klasy&gt;.class.php</em></span>. 
                     </p>
                     <p>Dla przyk&#322;adu - mo&#380;emy utworzy&#263; klas&#281;, kt&oacute;ra b&#281;dzie zamienia&#322;a sk&#322;adni&#281; wikipedii
                        na kod
                        HTML:
                     </p><pre class="programlisting">&lt;?php

class Filter_Wiki implements IFilter
{
	public function filter($value)
	{
		$value = preg_replace('#\'\'\'(.+?)\'\'\'#', '&lt;b&gt;$1&lt;/b&gt;', $value);
		$value = preg_replace('#\'\'(.+?)\'\'#', '&lt;i&gt;$1&lt;/i&gt;', $value);
		$value = preg_replace('#`(.+?)`#', '&lt;tt&gt;$1&lt;/tt&gt;', $value);

		return $value;
	}
}
?&gt;</pre><p>Naturalnie to tylko przyk&#322;ad - budowa klasy jest bardzo prosty. Podobnie jak
                        wykorzystanie tej
                        klasy:
                     </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = "''pochylony tekst'', '''pogrubiony tekst'''";

		$filter = &amp;$this-&gt;getLibrary('filter');
		$filter-&gt;addFilter(new Filter_Wiki);

		echo $filter-&gt;filterData($value);
	}
}
?&gt;</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5954"></a>Filtr XSS
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Klasa Filter_Xss umo&#380;liwia usuni&#281;cie potencjalnie niebezpiecznego kodu
                        umo&#380;liwiaj&#261;cego ataki typu XSS. Klasa usuwa z &#322;a&#324;cucha atrbuty znacznik&oacute;w HTML
                        zwi&#261;zane ze zdarzeniami JavaScript oraz - niebezpieczne znaczniki HTML.
                        Przyk&#322;adowo:
                     </p><pre class="programlisting">
$value = '&lt;a onclick="alert(document.cookie);"&gt;click me&lt;/a&gt;';

$filter = &amp;$this-&gt;getLibrary('filter');
$filter-&gt;addFilter(new Filter_Xss);

echo $filter-&gt;filterData($value);</pre><p>&#321;a&#324;cuch <tt class="varname">$value</tt> zostanie przekszta&#322;cony
                        na:
                     </p><pre class="programlisting">&amp;lt;a onclick="alert();"&amp;gt;click me&lt;/a&gt;</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5968"></a>Filtr stripNewLines()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Jest to metoda klasy <tt class="classname">Filter</tt>. Umo&#380;liwia usuni&#281;cie znak&oacute;w
                        nowej linii z &#322;a&#324;cucha.
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5976"></a>Filtr int()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda klasy <tt class="classname">Filter</tt>: rzutowanie warto&#347;ci na typ
                        integer.
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5984"></a>Filtr string()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda klasy <tt class="classname">Filter</tt>: rzutowanie na typ string.
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e5992"></a>Filtr float()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda klasy <tt class="classname">Filter</tt>: rzutowanie na typ float.
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6000"></a>Metoda setFilters()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda setFilters() umo&#380;liwia ustawienie kolejki filtr&oacute;w bez inicjalizacji
                     ewentualnych klas. Metoda szczeg&oacute;lnie przydatna w przypadku, gdy konfiguracja filtr&oacute;w
                     jest zapisana - np. w plikach XML. W&oacute;wczas mo&#380;na wywo&#322;a&#263; metod&#281; setFilters() z
                     konfiguracj&#261; odczytan&#261; z zewn&#281;trznego pliku.
                     Przyk&#322;ad:
                  </p><pre class="programlisting">&lt;?php

class Bar extends Controller
{
	function main()
	{
		$value = '&lt;a onclick="alert(document.cookie);"&gt;(click)_me&lt;/a&gt;';

		$filter = &amp;$this-&gt;getLibrary('filter');
		$filter-&gt;setFilters(array(

				'string',
				'xss'				=&gt; array(),
				'replace'			=&gt; array('_', '(', ')')
			)
		);				

		echo $filter-&gt;filterData($value);
	}
}
?&gt;</pre><p>Je&#380;eli klucz tablicy jest &#322;a&#324;cuchem, a warto&#347;ci&#261; - tablica, oznacza to, &#380;e filtr jest
                     klas&#261;. Coyote utworzy now&#261; instancj&#281; klasy i przeka&#380;e do jej konstruktora warto&#347;ci
                     podane w tablicy. W przeciwnym przypadku - system uzna, &#380;e filtr jest funkcj&#261;. 
                  </p>
                  <p>Elementem tablicy asocjacyjnej przekazywanej do <tt class="methodname">setFilters()</tt>
                     mo&#380;e by&#263; tablica zawieraj&#261;ca informacje o filtrze oraz o jego parametrach. W takim
                     przypadku, pierwszym elementem filtra musi by&#263; jego nazwa (bez przefrostka
                     <span class="emphasis"><em>Filter</em></span>), gdy&#380; kolejne elementy zostan&#261; przekazane do
                     konstruktora filtra:
                  </p><pre class="programlisting">
$filter-&gt;setFilters(array(

        'string',
        array('xss'),
        array('replace', '_', '(', ')')
    )
);
        </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6019"></a>Statyczna metoda call()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Statyczna metoda <tt class="methodname">call()</tt> umo&#380;liwia wywo&#322;anie filtra bez
                     konieczno&#347;ci inicjalizacji klasy:
                     
                  </p><pre class="programlisting">
$value = '&lt;a onclick="alert(document.cookie);"&gt;(click)_me&lt;/a&gt;';

Load::loadClass('filter', false);
echo Filter::call($value, new Filter_Xss);</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6029"></a>Klasa Filter_Input
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Filter_Input</tt> znajduje si&#281; w pliku
                     <tt class="filename">input.class.php</tt>, w katalogu <tt class="filename">filter</tt>.
                     Umo&#380;liwia ona walidacj&#281; oraz filtrowanie wi&#281;kszej ilo&#347;ci danych (np. tablicy)
                     jednocze&#347;nie. Mo&#380;na j&#261; wykorzysta&#263; do sprawdzenia poprawno&#347;ci - np. formularza. Klasa
                     <tt class="classname">Filter_Input</tt> posiada metody
                     <tt class="methodname">addValidator()</tt>, <tt class="methodname">setValidators()</tt>,
                     <tt class="methodname">addFilter()</tt>, <tt class="methodname">setFilters()</tt>,
                     podobnie jak klasy <tt class="classname">Filter</tt>, czy <tt class="classname">Validate</tt>.
                     Jedyna r&oacute;&#380;nica jest taka, i&#380; podczas deklarowania regu&#322; walidator&oacute;w, czy filtr&oacute;w -
                     musimy sprecyzowa&#263; jakich p&oacute;l tablicy (czy np. formularza) one dotycz&#261;. Oto przyk&#322;adowy
                     skrypt, kt&oacute;ry sprawdza poprawno&#347;&#263; tablicy <tt class="varname">$foo</tt>:
                  </p><pre class="programlisting">
&lt;?php

class Test extends Controller
{
	function main()
	{
		$foo = array(
			'name'		=&gt; '&lt;a onclick="alert(\'Hello\');"&gt;User name&lt;/a&gt;',
			'email'		=&gt; 'invalid(at)email.com'
		);

		$filter = new Filter_Input;

		$filter-&gt;setFilters(array(

			'name'		=&gt; array(
					'string',
					array('xss')
			),
			'email'		=&gt; array(
					'string',
					'htmlspecialchars'
			)
		));
		$filter-&gt;setValidators(array(

			'name'		=&gt; array(
					'string'
			),
			'email'		=&gt; array(
					array('string', false, 1, 30),
					'email'
			)
		));

		if ($filter-&gt;isValid($foo))
		{
			echo 'OK&lt;br /&gt;';
			Core::debug($filter-&gt;getValues());
		}
		else
		{
			echo 'Bledy:&lt;/br &gt;';
			Core::debug($filter-&gt;getMessages());
		}
	}
}
?&gt;        
    </pre><p>Dzi&#281;ki metodom <tt class="methodname">setFilters()</tt> oraz
                     <tt class="methodname">setValidators()</tt> przekazali&#347;my regu&#322;y walidator&oacute;w i filtr&oacute;w.
                     Zasada dzia&#322;ania tych metod jest taka sama jak w klasach <tt class="classname">Validate</tt>
                     oraz <tt class="classname">Filter</tt>.
                  </p>
                  <p>Metoda <tt class="methodname">isValid()</tt> zwraca TRUE w przypadku, gdy proces
                     walidacji przebieg&#322; poprawnie, a FALSE - je&#380;eli zako&#324;czy&#322;o si&#281; to pora&#380;k&#261;. 
                  </p>
                  <p>Metoda <tt class="methodname">getMessages()</tt> zwraca b&#322;&#281;dy w formie tablicy, gdzie
                     kluczem jest nazwa walidowanego pola - np.:
                  </p><pre class="programlisting">
Array
(
    [email] =&gt; Array
    (
        [0] =&gt; Adres "invalid(at)email.com" nie jest prawid&#322;owym adresem e-mail
    )

)        
    </pre><p>Metoda <tt class="methodname">getValues()</tt> zwraca warto&#347;ci p&oacute;l walidowanej tablicy po
                     procesie filtrowania oraz walidacji. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6100"></a>Metoda setRules()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>W poprzednim przyk&#322;adzie rozdziela&#322;em regu&#322;y na regu&#322;y walidatora oraz filtra. U&#380;y&#322;em do tego
                        dw&oacute;ch metod - <tt class="methodname">setValidators()</tt> oraz <tt class="methodname">setFilters()</tt>.
                        Mo&#380;liwe jest po&#322;&#261;czenie dw&oacute;ch tablic - regu&#322; filtr&oacute;w oraz walidator&oacute;w, a nast&#281;pnie przekazanie tych regu&#322; w metodzie
                        <tt class="methodname">setRules()</tt>:
                        
                     </p><pre class="programlisting">
$filter = new Filter_Input;

$data['filter'] = array(

	'name'		=&gt; array(
			'string',
			array('xss')
	),
	'email'		=&gt; array(
			'string',
			'htmlspecialchars'
	)
);
$data['validator'] = array(

	'name'		=&gt; array(
			'string'
	),
	'email'		=&gt; array(
			array('string', false, 1, 30),
			'email'
	)
);
$filter-&gt;setRules($data);                
            </pre><p>
                        Regu&#322;y walidator&oacute;w oraz filtr&oacute;w mo&#380;na przekaza&#263; r&oacute;wnie&#380; w konstruktorze klasy:
                        
                     </p><pre class="programlisting">
$filter = new Filter_Input($data);                  
              </pre><p>
                        
                     </p>
                  </div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6120"></a>Rozdzia&#322; 24. Wysy&#322;anie plik&oacute;w na serwer
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e6127">Tworzenie formularza HTML</a></span></dt>
                     <dt><span class="section"><a href="#d0e6144">Odczytywanie informacji o odebranym pliku</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6165">Metoda setOverwrite()</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e6175">Walidacja plik&oacute;w</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6202">Metoda setOptional()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6212">Metoda setSuffix()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6219">Metoda setMime()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6232">Metoda setFileSize()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6239">Metoda setWidth()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6246">Metoda setHeight()</a></span></dt>
                           <dt><span class="section"><a href="#d0e6251">U&#380;ycie metody setOptions()</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p>Umieszczenie odpowiedniego formularza HTML umo&#380;liwia przes&#322;anie wskazanego przez
                  u&#380;ytkownika, pliku na serwer, kt&oacute;ry zajmie si&#281; jego odebraniem i - ewentualnie -
                  umieszczenie w konkretnym miejscu.
               </p>
               <p>Element &lt;input type="file" /&gt; umieszczony w kodzie HTML spowoduje wy&#347;wietlenie
                  odpowiedniej kontrolki przez przegl&#261;dark&#281; internetow&#261;. Dzi&#281;ki temu u&#380;ytkownik korzystaj&#261;cy z
                  witryny, mo&#380;e umie&#347;ci&#263; na serwerze wybrany plik. Oczywi&#347;cie pod warunkiem, i&#380; serwer
                  zaakceptuje dany plik. 
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6127"></a>Tworzenie formularza HTML
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Do utworzenia formularza HTML, mo&#380;na u&#380;y&#263; helper&oacute;w dostarczonych przez framework.
                     Konkretnie, klas&#281; <tt class="filename">form.helper.php</tt>. Oto kod przyk&#322;adowej
                     akcji:
                  </p><pre class="programlisting">&lt;?php

class Test extends Controller
{
	function main()
	{
		echo Form::openMultipart('Test/Submit');
		echo Form::file('File');
		echo Form::submit('', 'Wy&#347;lij');
		echo Form::close();
	}

	public function submit()
	{

	}
}
?&gt;</pre><p>Metoda <tt class="methodname">main()</tt>wygeneruje, a nast&#281;pnie prze&#347;le do u&#380;ytkownika
                     taki kod
                     HTML:
                  </p><pre class="programlisting">&lt;form method="POST" enctype="multipart/form-data" action="http://127.0.0.1/coyote-1-0/index.php/Test/Submit" &gt;
&lt;input type="file" value="" name="File" /&gt;
&lt;input type="submit" value="Wy&#347;lij" /&gt;
&lt;/form&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6144"></a>Odczytywanie informacji o odebranym pliku
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>J&#281;zyk PHP udost&#281;pnia odpowiedni mechanizm umo&#380;liwiaj&#261;cy odczyt informacji o pliku.
                     Informacje o plikach wys&#322;anych przez u&#380;ytkownika, dost&#281;pne s&#261; poprzez tablic&#281;
                     <tt class="varname">$_FILES</tt>, gdzie kluczem tablicy jest nazwa kontrolki &lt;input&gt;.
                     Coyote udost&#281;pnia klas&#281; Upload, kt&oacute;ra w prosty spos&oacute;b umo&#380;liwia odebranie pliku
                     wys&#322;anego przez u&#380;ytkownika. Oto metoda submit()
                     kontrolera:
                  </p><pre class="programlisting">
public function submit()
{
	$upload = &amp;$this-&gt;getLibrary('upload');
	$upload-&gt;setDestination('tmp');

	if ($upload-&gt;recive('File'))
	{
		echo 'Nazwa pliku: ' . $upload-&gt;getFileName() . '&lt;br /&gt;';
		echo 'Rozmiar pliku: ' . $upload-&gt;getFileSize() . ' bajt&oacute;w&lt;br /&gt;';
		echo '&#346;cie&#380;ka do pliku: ' . $upload-&gt;getFilePath() . '&lt;br /&gt;';
		echo 'Rozszerzenie pliku: ' . $upload-&gt;getSuffix() . '&lt;br /&gt;';
		echo 'Typ MIME: ' . $upload-&gt;getFileMime();

		Core::debug($upload-&gt;getFileInfo());
	}
}</pre><p>Metoda <tt class="methodname">setDestination()</tt> ustawia katalog, w kt&oacute;rym zostanie
                     umieszczony plik wys&#322;any przez u&#380;ytkownika. Metoda <tt class="methodname">recive()</tt>
                     odbiera &oacute;w plik i umieszcza w podanym katalogu, dostarczaj&#261;c przy tym informacje o tym
                     pliku. Powy&#380;szy przyk&#322;ad prezentuje mo&#380;liwo&#347;ci tej klasy w zakresie prezentowania
                     informacji o odebranym pliku. W wyniku takiego kodu, dany plik zostanie umieszczony w
                     folderze <tt class="filename">tmp</tt>, w g&#322;&oacute;wnym katalogu projektu. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6165"></a>Metoda setOverwrite()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Domy&#347;lnie, je&#380;eli w danym katalogu, znajduje si&#281; ju&#380; plik o podanej nazwie, system
                        wy&#347;wietli b&#322;&#261;d informuj&#261;cy o pr&oacute;bie zast&#261;pienia &oacute;w pliku. Je&#380;eli chcesz, aby system
                        domy&#347;lnie zast&#281;powa&#322; plik je&#380;eli taki ju&#380; istnieje, nale&#380;y wywo&#322;a&#263; metod&#281;
                        <tt class="methodname">setOverwrite()</tt>:
                     </p><pre class="programlisting">$upload-&gt;setOverwrite(true); // zast&#281;puj plik je&#380;eli taki ju&#380; istnieje</pre></div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6175"></a>Walidacja plik&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Bardzo istostn&#261; spraw&#261; jest walidacja odbieranych danych. Nie mo&#380;emy sobie pozwoli&#263; na
                     to, aby u&#380;ytkownik wysy&#322;a&#322; na serwer pliki wykonywalne <span class="emphasis"><em>.exe</em></span>, czy
                     np. <span class="emphasis"><em>.php</em></span>. W tym celu mo&#380;emy wykorzysta&#263; walidator
                     <tt class="classname">Validate_Upload</tt>. Oto zmodyfikowana metoda
                     <tt class="methodname">submit()</tt>:
                  </p><pre class="programlisting">
public function submit()
{
	// deklaracja interfejsu IValidate
	Load::loadFile('lib/validate.class.php');
	$validate = new Validate_Upload;

	$validate-&gt;setSuffix('jpg,gif');
	$validate-&gt;setFileSize('1MB');

	if (!$validate-&gt;isValid('File'))
	{
		Core::debug($validate-&gt;getMessages());

		exit;
	}

	$upload = &amp;$this-&gt;getLibrary('upload');
	$upload-&gt;setDestination('tmp');

	if ($upload-&gt;recive('File'))
	{
		echo 'Nazwa pliku: ' . $upload-&gt;getFileName() . '&lt;br /&gt;';
		echo 'Rozmiar pliku: ' . $upload-&gt;getFileSize() . ' bajt&oacute;w&lt;br /&gt;';
		echo '&#346;cie&#380;ka do pliku: ' . $upload-&gt;getFilePath() . '&lt;br /&gt;';
		echo 'Rozszerzenie pliku: ' . $upload-&gt;getSuffix() . '&lt;br /&gt;';
		echo 'Typ MIME: ' . $upload-&gt;getFileMime();

		Core::debug($upload-&gt;getFileInfo());
	}
}</pre><p>Metoda <tt class="methodname">setSuffix()</tt> ustala mo&#380;liwe, akceptowalne rozszerzenia,
                     natomiast <tt class="methodname">setFileSize()</tt> maksymalny rozmiar pliku. W tym
                     przyk&#322;adzie system akceptuje jedynie pliki JPG oraz GIF o maksymalnym rozmiarze 1 MB. 
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6202"></a>Metoda setOptional()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda umo&#380;liwia okre&#347;lenie, czy wysy&#322;aj&#261;c formularz, u&#380;ytkownik MUSI okre&#347;li&#263;
                        plik do wys&#322;ania, czy te&#380; nie. Domy&#347;lnie element jest opcjonalny tak wi&#281;c w
                        przypadku, gdy u&#380;ytkownik nie okre&#347;li pliku do wys&#322;ania, metoda
                        <tt class="methodname">isValid()</tt> i tak zwr&oacute;ci true. Aby to zmieni&#263;, mo&#380;esz
                        zastosowa&#263; taki
                        kod:
                     </p><pre class="programlisting">$validate-&gt;setOptional(false);</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6212"></a>Metoda setSuffix()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Umo&#380;liwia okre&#347;lenie dopuszczalnych rozszerze&#324; plik&oacute;w. Parametrem metody mo&#380;e by&#263;
                        &#322;a&#324;cuch zawieraj&#261;cy rozszerzenia (oddzielone przecinkiem) lub tablica
                        rozszerze&#324;:
                     </p><pre class="programlisting">$validate-&gt;setSuffix('jpg,gif');
// lub:
$validate-&gt;setSuffix(array('jpg', 'gif')); </pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6219"></a>Metoda setMime()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Umo&#380;liwia ustalenie dopuszczalnych typ&oacute;w plik&oacute;w. Podobnie jak w przypadku metody
                        <tt class="methodname">setSuffix()</tt>, parametrem mo&#380;e by&#263; &#322;a&#324;cuch lub tablica
                        typ&oacute;w:
                     </p><pre class="programlisting">$validate-&gt;setMime('image/jpeg'); // akceptujemy tylko obrazy </pre><p>
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>Klasa Upload, niezale&#380;nie od ustawie&#324; zabezpiecza przed wysy&#322;aniem plik&oacute;w o
                        typie application/octet-stream oraz text/x-delimtext. 
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6232"></a>Metoda setFileSize()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Metoda umo&#380;liwia ustalenie maksymalnego rozmiaru dla pliku. Parametrem metody mo&#380;e
                        by&#263; liczba okre&#347;laj&#261;ca maksymalny rozmiar pliku (w bajtach) lub &#322;a&#324;cuch typu string.
                        Oto
                        przyk&#322;ady:
                     </p><pre class="programlisting">$validate-&gt;setFileSize(10); // 10 bajt&oacute;w
$validate-&gt;setFileSize('100KB'); // 100 kilobajt&oacute;w
$validate-&gt;setFileSize('100MB'); // 100 megabajt&oacute;w
$validate-&gt;setFileSize('100GB'); // 100 gigabajt&oacute;w</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6239"></a>Metoda setWidth()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Je&#380;eli spodziewamy si&#281;, i&#380; wysy&#322;anym przez u&#380;ytkownika plikiem b&#281;dzie obraz,
                        mo&#380;emy okre&#347;li&#263; maksymaln&#261; szeroko&#347;&#263; oraz wysoko&#347;&#263; obrazu (w pikselach). Oto
                        przyk&#322;ad:
                     </p><pre class="programlisting">$validate-&gt;setWidth(20);
		$validate-&gt;setHeight(20);</pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6246"></a>Metoda setHeight()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Ustawia maksymalny, mo&#380;liwy rozmiar odbieranego obrazu. </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6251"></a>U&#380;ycie metody setOptions()
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>Oczywi&#347;cie, podobnie jak w przypadku innych walidator&oacute;w, mo&#380;liwe jest u&#380;ycie
                        metody <tt class="methodname">setOptions()</tt> w celu ustawienia konfiguracji
                        walidatora:
                        
                     </p><pre class="programlisting">
$validate-&gt;setOptions(array(
		'suffix'		=&gt; 'jpg,gif',
		'filesize'		=&gt; '1MB',
		'mime'			=&gt; 'image/jpeg'
	)
);</pre><p>Parametry walidatora mo&#380;emy okre&#347;li&#263; r&oacute;wnie&#380; w konstruktorze klasy, kt&oacute;rego
                        nag&#322;&oacute;wek wygl&#261;da
                        tak:
                     </p><pre class="programlisting">function __construct($optional = true, $filesize = 0, $suffix = null, $mime = null, $width = null, $height = null)
</pre></div>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6265"></a>Rozdzia&#322; 25. Klasa Output
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e6275">Metoda setTitle()</a></span></dt>
                     <dt><span class="section"><a href="#d0e6282">Metoda setMeta()</a></span></dt>
                     <dt><span class="section"><a href="#d0e6299">Ustalanie szablon&oacute;w CSS</a></span></dt>
                  </dl>
               </div>
               <p>Klasa <tt class="classname">Output</tt> zwi&#261;zana jest odpowiedzi&#261; serwera na &#380;&#261;danie
                  u&#380;ytkownika. Umo&#380;liwia wys&#322;anie nag&#322;&oacute;wk&oacute;w HTTP, ciastek (cookies) czy dodatkowych znacznik&oacute;w
                  strony WWW. 
               </p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Notatka</h3>Wi&#281;cej informacji o klasie Output, znajdziesz w dokumentacji API
                  frameworka. 
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6275"></a>Metoda setTitle()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Metoda umo&#380;liwia ustawienie tytu&#322;u dla strony. Jednak&#380;e w szablonie strony, nale&#380;y
                     okre&#347;li&#263;, w kt&oacute;rym miejscu ma zosta&#263; umieszczony tytu&#322; (w postaci znacznika &lt;title&gt;)
                     -
                     np.:
                  </p><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;?= $output-&gt;getTitle(); ?&gt;
&lt;/head&gt;
&lt;body&gt;
...
&lt;/body&gt;
&lt;/html&gt;</pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6282"></a>Metoda setMeta()
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>S&#322;u&#380;y do przekazania dodatkowych parametr&oacute;w w postaci znacznika &lt;meta&gt;.
                     Np.:
                  </p><pre class="programlisting">$this-&gt;output-&gt;setMeta('Description', 'Oto opis strony');
// nast&#281;pnie w widoku:
&lt;head&gt;
&lt;?= $output-&gt;getMeta(); ?&gt;
&lt;/head&gt;</pre><p>Metoda <tt class="methodname">getMeta()</tt> zwr&oacute;ci przekazane nag&#322;&oacute;wki w postaci
                     znacznik&oacute;w &lt;meta&gt;. Nag&#322;&oacute;wki przekazane do klasy Output, mo&#380;na usun&#261;c przy pomocy
                     metody <tt class="methodname">removeMeta()</tt>. 
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Notatka</h3>Analogicznie dzia&#322;aj&#261; metody
                     setHttpMeta(), getHttpMeta() oraz removeHttpMeta(), z tym, &#380;e generuj&#261; znaczniki
                     &lt;meta http-equiv name=" ... 
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6299"></a>Ustalanie szablon&oacute;w CSS
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>Klasa <tt class="classname">Output</tt> zapewnia kilka metod umo&#380;liwiaj&#261;cych przekazanie
                     nazw szablon&oacute;w CSS. Przede wszystkim metoda <tt class="methodname">addStylesheet()
                        </tt>umo&#380;liwia dodanie do listy, kolejnego szablonu
                     CSS:
                  </p><pre class="programlisting">$this-&gt;output-&gt;addStylesheet('main'); // dodanie szablonu main.css</pre><p>Pierwszym parametrem metody jest nazwa szablonu (bez rozszerzenia
                     <span class="emphasis"><em>.css</em></span>!). Parametr mo&#380;e zawiera&#263; wiele nazw szablon&oacute;w, kt&oacute;re musz&#261;
                     by&#263; oddzielone znakiem
                     przecinka:
                  </p><pre class="programlisting">$this-&gt;output-&gt;addStylesheet('main,foo'); // dodanie szablonu main.css oraz foo.css</pre><p>Metoda addStylesheet() posiada dodatkowy, opcjonalny parametr okre&#347;laj&#261;ce atrybuty dla znacznika
                     &lt;link&gt;:
                  </p><pre class="programlisting">$this-&gt;addStylesheet('main,foo',  array('media' =&gt; 'print')); </pre><p>Teraz, w szablonie nale&#380;y umie&#347;ci&#263; odwo&#322;anie do metody
                     <tt class="methodname">getStylesheet()</tt>, kt&oacute;ra zwraca kod HTML w postaci znacznik&oacute;w
                     &lt;link&gt; zawieraj&#261;cych odwo&#322;ania do szablon&oacute;w
                     CSS:
                  </p><pre class="programlisting">&lt;head&gt;
&lt;?= $output-&gt;getStylesheet(); ?&gt;
&lt;/head&gt;</pre><p>Taki kod spowoduje wygenerowanie
                     kodu:
                  </p><pre class="programlisting">&lt;head&gt;
&lt;link rel="stylesheet" type="text/css" href="http://127.0.0.1/template/main.css" media="print" /&gt;
&lt;link rel="stylesheet" type="text/css" href="http://127.0.0.1/template/foo.css" media="print" /&gt;
&lt;/head&gt;</pre><p>Aby usun&#261;&#263; przekazany ju&#380; szablon, nale&#380;y u&#380;y&#263; metody
                     <tt class="methodname">removeStylesheet()</tt>. 
                  </p>
                  <p>Klasa Output udost&#281;pnia r&oacute;wnie&#380; metod&#281; <tt class="methodname">setStylesheet()</tt> kt&oacute;ra
                     dzia&#322;a tak samo jak <tt class="methodname">addStylesheet()</tt>, z t&#261; r&oacute;&#380;nic&#261;, i&#380; ta druga
                     jako parametr mo&#380;e przyj&#261;&#263; zar&oacute;wno &#322;a&#324;cuch (okre&#347;laj&#261;cy nazw&#281; pliku) jak i tablic&#281; z nazwami szablon&oacute;w:
                  </p><pre class="programlisting">
$this-&gt;output-&gt;setStylesheet(array(
		array('main'),
		array('foo'), 'array('media' =&gt; 'print')
	)
);</pre><p>Tak wywo&#322;ana metoda spowoduje ustawienie kolejnych styli CSS.</p>
               </div>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6351"></a>Rozdzia&#322; 26. Klasa FTP
                        </h2>
                     </div>
                  </div>
               </div>
               <p>(TODO)</p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6356"></a>Rozdzia&#322; 27. Klasa Email
                        </h2>
                     </div>
                  </div>
               </div>
               <p>(TODO)</p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6361"></a>Rozdzia&#322; 28. Klasa Forms
                        </h2>
                     </div>
                  </div>
               </div>
               <p>(TODO)</p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6366"></a>Rozdzia&#322; 29. Klasa Image
                        </h2>
                     </div>
                  </div>
               </div>
               <p>(TODO)</p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6371"></a>Rozdzia&#322; 30. Klasa Pagination
                        </h2>
                     </div>
                  </div>
               </div>
               <p>(TODO)</p>
            </div>
            <div class="chapter" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6377"></a>Rozdzia&#322; 31. Budowa modu&#322;owa
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e6387">Lokalizacja modu&#322;&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e6397">&#321;adowanie modu&#322;&oacute;w do aplikacji</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6405">Jawne za&#322;adowanie modu&#322;u</a></span></dt>
                           <dt><span class="section"><a href="#d0e6428">Automatyczne &#322;adowanie modu&#322;u</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e6459">Konfiguracja modu&#322;&oacute;w</a></span></dt>
                     <dt><span class="section"><a href="#d0e6489">Zasoby modu&#322;&oacute;w</a></span></dt>
                  </dl>
               </div>
               <p>
                  Do aplikacji mog&#261; by&#263; do&#322;&#261;czane niezale&#380;ne podzespo&#322;y zwane <span class="emphasis"><em>modu&#322;ami</em></span>.
                  Budowa modu&#322;owa umo&#380;liwia rozbudowywanie aplikacji o dodatkowe elementy. 
                  
               </p>
               <p>
                  Przyk&#322;adowo: do Twojej aplikacji - bloga, mo&#380;emy do&#322;&#261;czy&#263; modu&#322; umo&#380;liwiaj&#261;cy komentowanie wpis&oacute;w.
                  Taki modu&#322; komentarzy mo&#380;e by&#263; przenoszony pomi&#281;dzy r&oacute;&#380;nymi aplikacjami korzystaj&#261;cymi z frameworka Coyote.
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6387"></a>Lokalizacja modu&#322;&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Modu&#322;y powinny znajdowa&#263; si&#281; w katalogu <tt class="filename">/module</tt> danej aplikacji.
                     Nazwa katalogu z modu&#322;em stanowi nazw&#281; modu&#322;u. 
                     
                     Struktura katalog&oacute;w modu&#322;u nie r&oacute;&#380;ni si&#281; praktycznie niczym od struktury aplikacji g&#322;&oacute;wnej.           
                     
                  </p><pre class="programlisting">
- config
- controller
- lib
- log
- model
- module
    - foo
        - config
        - controller
        - lib
        - model
        - template
    - bar
        - config
        - controller
            - foobar
        - model
        - template
- template
- trigger
        </pre></div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6397"></a>&#321;adowanie modu&#322;&oacute;w do aplikacji
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Modu&#322;y zgrupowane w podkatalogu <tt class="filename">/module</tt> nie s&#261; automatycznie &#322;adowane 
                     do projektu. Mo&#380;na to zrobi&#263; jawnie lub okre&#347;li&#263; w pliku konfiguracji, jakie modu&#322;y 
                     maj&#261; by&#263; do&#322;&#261;czane na starcie programu.
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6405"></a>Jawne za&#322;adowanie modu&#322;u
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Aby za&#322;adowa&#263; modu&#322; do projektu w trakcie dzia&#322;ania aplikacji, mo&#380;emy skorzysta&#263; 
                        ze statycznej metody <tt class="methodname">loadModule()</tt> klasy <tt class="classname">Load</tt>.                                
                        
                     </p><pre class="programlisting">
Load::loadModule('foo');                
            </pre><p>
                        Mo&#380;na te&#380; skorzysta&#263; z metody <tt class="methodname">module()</tt>, r&oacute;wnie&#380; z klasy <tt class="classname">Load</tt>:
                        
                     </p><pre class="programlisting">
$this-&gt;load-&gt;module('foo');                 
            </pre></div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6428"></a>Automatyczne &#322;adowanie modu&#322;u
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Aby za&#322;adowa&#263; modu&#322; w spos&oacute;b automatyczny, zaraz przy starcie aplikacji, nale&#380;y w pliku
                        konfiguracji okre&#347;li&#263; jego nazw&#281;. Mo&#380;emy to zrobi&#263; w dowolnym pliku konfiguracyjnym; mo&#380;emy
                        r&oacute;wnie&#380; utworzy&#263; nowy plik - np. <tt class="filename">module.xml</tt>, w kt&oacute;rym b&#281;d&#261; znajdowa&#263;
                        si&#281; nazwy modu&#322;&oacute;w, kt&oacute;re b&#281;d&#261; &#322;adowane automatycznie:
                        
                     </p><pre class="programlisting">

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
	&lt;module&gt;foo&lt;/module&gt;
	&lt;module&gt;bar&lt;/module&gt;
&lt;/config&gt;
                
            </pre><p>
                        Oczywi&#347;cie, to nie wystarczy je&#380;eli plik <tt class="filename">module.xml</tt> nie b&#281;dzie 
                        wczytywany do konfiguracji projektu. Otw&oacute;rz plik front controllera - <tt class="filename">index.php</tt>
                        i dopisz w nim instrukcj&#281;, kt&oacute;ra wczyta nasz plik <tt class="filename">module.xml</tt>:
                        
                     </p><pre class="programlisting">
Core::setConfigPath('config/module.xml');                
            </pre><p>
                        &#321;adowanie modu&#322;&oacute;w do aplikacji odbywa si&#281; podczas inicjalizacji programu, w metodzie
                        <tt class="filename">bootstrap()</tt> w klasie <tt class="classname">Core</tt>. Po wczytaniu 
                        konfiguracji programu, sprawdzane jest, czy w konfiguracji nie znajduj&#261; si&#281; nazwy
                        modu&#322;&oacute;w, kt&oacute;re powinny zosta&#263; za&#322;adowane. Po za&#322;adowaniu modu&#322;u, jest on traktowany
                        jako integralna cz&#281;&#347;&#263; aplikacji.
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6459"></a>Konfiguracja modu&#322;&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Nieroz&#322;&#261;cznym elementem aplikacji jest jej konfiguracja. Modu&#322;y r&oacute;wnie&#380; mog&#261; posiada&#263; 
                     pliki konfiguracyjne, kt&oacute;re b&#281;d&#261; w&#322;&#261;czane do aplikacji. Przy &#322;adowaniu modu&#322;u,
                     przy pomocy metody <tt class="methodname">loadModule()</tt> lub <tt class="methodname">module()</tt>,
                     system odszukuje plik&oacute;w konfiguracyjnych, kt&oacute;rych nazwy odpowiadaj&#261; plikom konfiguracyjnym
                     samej aplikacji. Poniewa&#380; &#322;atwiej wyt&#322;umaczy&#263; to na przyk&#322;adzie, sp&oacute;jrz na poni&#380;sz&#261;
                     struktur&#281; plik&oacute;w:
                     
                  </p><pre class="programlisting">
- config
    - config.xml
    - route.xml
- controller
- module
    - foo
        - config
            - config.xml
            - route.xml
        - controller
        - ...
- ...

        </pre><p>
                     Je&#380;eli pliki <tt class="filename">config.xml</tt> oraz <tt class="filename">route.xml</tt> s&#261; plikami
                     konfiguracyjnymi aplikacji, to przy &#322;adowaniu modu&#322;u <span class="emphasis"><em>foo</em></span>, system
                     odszukuje w tym module, r&oacute;wnie&#380; - plik&oacute;w <tt class="filename">config.xml</tt> oraz 
                     <tt class="filename">route.xml</tt>.
                     
                  </p>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6489"></a>Zasoby modu&#322;&oacute;w
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     Po za&#322;adowaniu modu&#322;u do aplikacji, &oacute;w modu&#322; staje si&#281; integraln&#261; cz&#281;&#347;ci&#261; aplikacji.
                     Tak wi&#281;c w momencie &#380;&#261;dania za&#322;adowania - np. biblioteki - Foo, system poszukuje tej biblioteki
                     zar&oacute;wno w katalogu g&#322;&oacute;wnym - <tt class="filename">/lib</tt>, jak i r&oacute;wnie&#380; w katalogach 
                     <tt class="filename">/lib</tt>, w modu&#322;ach aplikacji.
                     
                  </p>
                  <p>
                     Wszystko dzi&#281;ki temu, i&#380; wywo&#322;anie metody <tt class="methodname">loadModule()</tt> powoduje
                     tak&#380;e wywo&#322;anie metody <tt class="methodname">setIncludePath()</tt> z klasy <tt class="classname">Load</tt>. 
                     Metoda ta dopisuje do zmiennej <span class="emphasis"><em>include.path</em></span> &#347;cie&#380;k&#281; z modu&#322;em. 
                     Dzi&#281;ki temu, loader w poszukiwaniu &#380;&#261;danego pliku przeszukuje katalogi z aplikacj&#261; oraz z modu&#322;ami.
                     
                  </p>
                  <p>
                     Nale&#380;y zwr&oacute;ci&#263; uwag&#281;, &#380;e <span class="emphasis"><em>auto loader</em></span>, przeszukuje dany folder 
                     (np. <tt class="filename">/lib</tt>), najpierw w katalogu z frameworkiem, nast&#281;pnie w katalogu
                     z aplikacj&#261;, a w dalszej kolejno&#347;ci - podfoldery z modu&#322;ami. 
                     
                  </p>
                  <p>
                     Przyk&#322;adowy kod:
                     
                  </p><pre class="programlisting">
$email = new Email;            
        </pre><p>
                     Mamy tutaj proste utworzenie instancji klasy <tt class="classname">Email</tt>. Zak&#322;adaj&#261;c, &#380;e plik
                     zawieraj&#261;cy klas&#281; <tt class="classname">Email</tt> nie zosta&#322; wcze&#347;niej za&#322;adowany do projektu,
                     <span class="emphasis"><em>auto loader</em></span> postara si&#281; odszuka&#263; odpowiedniej biblioteki. W pierwszej
                     kolejno&#347;ci sprawdzi, czy istnieje plik <tt class="filename">email.class.php</tt>, w katalogu
                     <tt class="filename">/lib</tt>, w katalogu aplikacji. Je&#380;eli zostanie odnaleziony, nast&#281;puje wczytanie
                     go do programu. Je&#380;eli nie - system sprawdzi, czy taki plik nie znajduje si&#281; w katalogu
                     <tt class="filename">/lib</tt> frameworka. Je&#380;eli i to nie odniesie skutku, system
                     przeszuka katalogi <tt class="filename">/lib</tt> w modu&#322;ach aplikacji. 
                     
                  </p>
                  <p>
                     W takiej sytuacji mo&#380;e si&#281; zdarzy&#263;, i&#380; wczytany zostanie nie ten plik, kt&oacute;ry chcemy, w przypadku, 
                     gdy zar&oacute;wno framework jak i aplikacja, zawieraj&#261; plik <tt class="filename">email.class.php</tt>,
                     w katalogu <tt class="filename">/lib</tt>. W takim przypadku konieczne jest jawne za&#322;adowanie danego
                     pliku, podaj&#261;c pe&#322;n&#261; &#347;cie&#380;k&#281;:
                     
                  </p><pre class="programlisting">
Load::loadFile(Config::getBasePath() . 'lib/email.class.php'); // za&#322;adowanie pliku email.class.php z katalogu aplikacji
//Load::loadFile(Config::getRootPath() . 'lib/email.class.php'); // za&#322;adowanie pliku email.class.php z katalogu frameworka

$email = new Email;
        </pre></div>
            </div>
            <div class="appendix" lang="pl">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d0e6560"></a>Dodatek A. Standard kodowania
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Spis tre&#347;ci</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d0e6565">Formatowanie plik&oacute;w PHP</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6568">Znaczniki PHP</a></span></dt>
                           <dt><span class="section"><a href="#d0e6583">Wci&#281;cia</a></span></dt>
                           <dt><span class="section"><a href="#d0e6590">Maksymalna d&#322;ugo&#347;&#263; linii</a></span></dt>
                           <dt><span class="section"><a href="#d0e6595">Kodowanie plik&oacute;w PHP</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e6600">Konwencja nazewnictwa</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6611">Nazewnictwo plik&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e6651">Nazewnictwo klas</a></span></dt>
                           <dt><span class="section"><a href="#d0e6677">Nazewnictwo interfejs&oacute;w</a></span></dt>
                           <dt><span class="section"><a href="#d0e6688">Nazewnictwo metod</a></span></dt>
                           <dt><span class="section"><a href="#d0e6707">Nazewnictwo funkcji</a></span></dt>
                           <dt><span class="section"><a href="#d0e6718">Nazewnictwo zmiennych</a></span></dt>
                           <dt><span class="section"><a href="#d0e6723">Nazewnictwo sta&#322;ych</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d0e6728">Formatowanie kodu</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d0e6731">&#321;a&#324;cuchy</a></span></dt>
                           <dt><span class="section"><a href="#d0e6749">Klasy</a></span></dt>
                           <dt><span class="section"><a href="#d0e6759">Pola klasy</a></span></dt>
                           <dt><span class="section"><a href="#d0e6776">Metody klasy</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               <p>
                  Dokument przedstawia standard kodowania kodu PHP w projekcie Coyote Framework. 
                  Ka&#380;dy deweloper bior&#261;cy udzia&#322; w projekcie powinien dostosowa&#263; si&#281; do regu&#322; opisanych
                  w tym dokumencie. Stosowanie tych samych regu&#322; pisania kodu PHP ma na celu
                  zwi&#281;kszenie przejrzysto&#347;ci projektu, u&#322;atwienia w zarz&#261;dzaniu kodem oraz minimalizacji
                  b&#322;ed&oacute;w w projekcie.
                  
               </p>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6565"></a>Formatowanie plik&oacute;w PHP
                           </h2>
                        </div>
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6568"></a>Znaczniki PHP
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        W plikach zawieraj&#261;cych sam kod PHP, nie jest konieczne stosowanie znacznika
                        zamykaj&#261;cego "?&gt;". Aczkolwiek w projekcie, w ka&#380;dym pliku stosowane s&#261;
                        znaczniki zamykaj&#261;ce.
                        
                     </p>
                     <p>
                        W szablonach, w kodzie mieszanym (PHP i xHTML) stosuje si&#281; znaczniki skr&oacute;cone,
                        tzw. <span class="emphasis"><em>short tags</em></span>. Wielu programist&oacute;w odradza stosowanie 
                        znacznik&oacute;w skr&oacute;conych ze wzgl&#281;du na to, i&#380; mog&#261; one by&#263; wy&#322;&#261;czone w konfiguracji
                        PHP. Innym argumentem s&#261; problemy ze znacznikiem otwieraj&#261;cym XML - &lt;?xml.                 
                        
                     </p>
                     <p>
                        &#321;atwym sposobem na w&#322;&#261;czenie skr&oacute;conych znacznik&oacute;w jest umieszczenie funkcji
                        <tt class="methodname">ini_set()</tt> we front controllerze.
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6583"></a>Wci&#281;cia
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Zabronione jest u&#380;ywanie spacji jako formy wci&#281;&#263; w kodzie. Zamiast tego powinno
                        si&#281; u&#380;ywa&#263; znaku tabulacji.                
                        
                     </p>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Notatka</h3>
                                        Zaleca si&#281; ostro&#380;no&#347;&#263; w stosowaniu edytor&oacute;w z w&#322;&#261;czon&#261; funkcj&#261; auto formatowania.
                                        Nale&#380;y zwr&oacute;ci&#263; uwag&#281;, czy tw&oacute;j edytor nie zamienia tabulacji na spacje.
                                    
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6590"></a>Maksymalna d&#322;ugo&#347;&#263; linii
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        D&#322;ugo&#347;&#263; poszczeg&oacute;lnej linii kodu nie powinna przekracza&#263; 80 znak&oacute;w.
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6595"></a>Kodowanie plik&oacute;w PHP
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Pliki PHP powinny posiada&#263; kodowanie UTF-8.
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6600"></a>Konwencja nazewnictwa
                           </h2>
                        </div>
                     </div>
                  </div>
                  <p>
                     W Coyote stosujemy angielski zapis kodu. Tzn. nie nazywamy zmiennych <tt class="varname">$id_uzytkownika</tt>
                     tylko <tt class="varname">$user_id</tt>. Tyczy si&#281; to r&oacute;wnie&#380; nazw klas, metod czy funkcji
                     
                  </p>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6611"></a>Nazewnictwo plik&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Pliki powinny posiada&#263; rozszerzenia .php. Nazwy plik&oacute;w piszemy ma&#322;ymi znakami -
                        np. <tt class="filename">foo.php</tt>, <tt class="filename">bar.php</tt> zamiast
                        <tt class="filename">Foo.php</tt>. Dodatkowo biblioteki frameworka (gromadzone w katalogu
                        <tt class="filename">/lib</tt>) powinny posiada&#263; ko&#324;c&oacute;wk&#281; .class - np.
                        <tt class="filename">foo.class.php</tt>. 
                        
                     </p>
                     <p>
                        Analogicznie pliki helper&oacute;w - <tt class="filename">bar.helper.php</tt> (z katalogu
                        <tt class="filename">/helper</tt>) oraz pliki j&#281;zykowe (z katalogu<tt class="filename">
                           /i18n</tt>) - <tt class="filename">foo.lang.php</tt> oraz modele (z katalog
                        <tt class="filename">/model</tt>) - <tt class="filename">foo.model.php</tt>. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6651"></a>Nazewnictwo klas
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Dla wyr&oacute;&#380;nienia, pierwsza litera w nazwie klasy powinna by&#263; zapisana wielk&#261; liter&#261;
                        - np. <tt class="classname">Lang</tt>, <tt class="classname">Config</tt> itp. Jako separator w
                        nazwie, powinno by&#263; u&#380;yte podkre&#347;lenie - np. <tt class="classname">Front_Controller</tt>,
                        zamiast <tt class="classname">FrontController</tt>. Wyj&#261;tkami s&#261; nazwy klas wyj&#261;tk&oacute;w,
                        kt&oacute;re zapisujemy: <tt class="classname">SqlErrorException</tt>,
                        <tt class="classname">UserErrorException</tt> (z przyrostkiem
                        <span class="emphasis"><em>Exception</em></span>). 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6677"></a>Nazewnictwo interfejs&oacute;w
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Nazwy interfejs&oacute;w powinna poprzedza&#263; wielka litera I - np.
                        <tt class="interfacename">IConfig</tt>, <tt class="interfacename">IDb</tt>. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6688"></a>Nazewnictwo metod
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Pocz&#261;wszy od wersji 0.9.4-rc2 zmieniono spos&oacute;b zapisu nazw metod. Zamiast znaku
                        podkre&#347;lenia (_) stosuje si&#281; styl wielb&#322;&#261;dzi, jednak pierwszy znak w nazwie musi by&#263;
                        pisany ma&#322;a liter&#261; - np. <tt class="methodname">getByName()</tt>,
                        <tt class="methodname">findUser()</tt> zamiast <tt class="methodname">get_by_name()</tt>
                        oraz <tt class="methodname">find_user()</tt>. Stare nazewnictwo mo&#380;e jeszcze figurowa&#263; w
                        niekt&oacute;rych bibliotekach, lecz zostanie poprawione w kolejnych wersjach.
                        
                     </p>
                     <p>
                        Dopuszczalne jest poprzedzanie nazw metod znakami __ (np. w kontrolerach) dla
                        podkre&#347;lenia, i&#380; dana metoda mimo, i&#380; jest oznaczona jako public, jest metod&#261;
                        pomocnicz&#261; (wykorzystywan&#261; np. jako metoda zwrotna lub metoda wykorzystywana przez
                        &#380;&#261;dania AJAX). 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6707"></a>Nazewnictwo funkcji
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Ca&#322;y framework jest praktycznie obiektowy. Oparty o model MVC. Z funkcjami mamy do
                        czynienia bardzo rzadko - praktycznie jedynie w helperach. W&oacute;wczas dopuszczalne jest
                        u&#380;ycie znaku podkre&#347;lenia (_) zamiast stylu wielb&#322;&#261;dziego - np.
                        <tt class="methodname">html_img()</tt>,<tt class="methodname">information_box()</tt>.
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6718"></a>Nazewnictwo zmiennych
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Zaleca si&#281; u&#380;ywanie stylu wielb&#322;&#261;dziego w przypadku zmiennych oraz p&oacute;l klas,
                        podobnie jak w przypadku metod.                
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6723"></a>Nazewnictwo sta&#322;ych
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Nazwy sta&#322;ych powinny zawiera&#263; wy&#322;&#261;cznie wielkie litery. Dozwolone jest u&#380;ywanie znak&oacute;w
                        "_"
                        
                     </p>
                  </div>
               </div>
               <div class="section" lang="pl">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d0e6728"></a>Formatowanie kodu
                           </h2>
                        </div>
                     </div>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6731"></a>&#321;a&#324;cuchy
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Stosujemy apostrofy tam gdzie to jest mo&#380;liwe.
                        
                        
                     </p><pre class="programlisting">

$a = 'Hello World';
                   
                    
                </pre><p>
                        
                     </p>
                     <p>
                        W miare mo&#380;liwo&#347;ci u&#380;ywamy operatora "." pozostawiaj&#261;c jedn&#261; spacj&#281; pomi&#281;dzy
                        wyrazami:
                        
                        
                     </p><pre class="programlisting">

$a = 'Hello ' . 'World';
                    
                    
                </pre><p>
                        
                     </p>
                     <p>
                        Tam gdzie jest to konieczne (w celu zwi&#281;kszania czytelno&#347;ci) mo&#380;emy u&#380;ywa&#263;
                        apostrofu:
                        
                        
                     </p><pre class="programlisting">

$a = 'Mam na imi&#281; ' . $name . ', lat: ' . $age . ', mam ' . $height . ' cm wzrostu';
$a = "Mam na imi&#281; $name, lat: $age, mam $height cm wzrostu"; // czytelniej
                                 
                </pre><p>
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6749"></a>Klasy
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Klasy musz&#261; by&#263; deklarowane zgodnie z nazewnictwem opisanym w poprzedniej cz&#281;&#347;ci.
                        Dodatkowo klamra otwieraj&#261;ca musi znajdowa&#263; si&#281; w kolejnej
                        linii:
                        
                     </p><pre class="programlisting">

/** 
* Komentarz
*/
class Foo
{
// metody
}

class Foo {
// &#377;le }
           
                    
                </pre><p>
                        
                     </p>
                     <p>
                        Pomi&#281;dzy s&#322;owem kluczowym class, a nazw&#261; klasy musi si&#281; znale&#378;&#263; jedna spacja
                        przerwy. Dobrym zwyczajem jest umieszczanie komentarza opisuj&#261;cego dzia&#322;anie klasy,
                        zgodnie z konwencj&#261; akceptowan&#261; przez oprogramowanie PHPDoc. 
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6759"></a>Pola klasy
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        Pola klasy musz&#261; by&#263; oznaczone jako <span class="emphasis"><em>private</em></span>,
                        <span class="emphasis"><em>public</em></span> lub <span class="emphasis"><em>protected</em></span>:
                        
                        
                     </p><pre class="programlisting">

// Dobrze
class Foo
{
    private $bar;
    private $foo;
}

// &#377;le
class Foo
{
    private
    $bar;
    $foo;
}
                    
                    
                </pre><p>
                        
                     </p>
                  </div>
                  <div class="section" lang="pl">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d0e6776"></a>Metody klasy
                              </h3>
                           </div>
                        </div>
                     </div>
                     <p>
                        W nazewnictwie metod stosujemy styl wielb&#322;&#261;dzi. Nale&#380;y pami&#281;ta&#263; o wci&#281;ciach 
                        w kodzie w wielko&#347;ci jednej tabulacji.
                        
                        
                     </p><pre class="programlisting">

class Foo
{
    public function Bar() // Dobrze
    {
    // instrukcje
    }
    
    function FooBar() {  // &#377;le
    }
    
    public function foobar() // &#377;le
    {
    }
}
                    
                    
                </pre><p>
                        
                        Klamra otwieraj&#261;ca powinna znajdowa&#263; si&#281; w nowej linii.
                        
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html>